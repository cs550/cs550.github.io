%!PS-Adobe-2.0
%%Creator: dvipsk 5.58f Copyright 1986, 1994 Radical Eye Software
%%Title: paper.dvi
%%Pages: 14
%%PageOrder: Ascend
%%BoundingBox: 0 0 612 792
%%DocumentFonts: Times-Bold Times-Roman Courier Times-Italic
%%EndComments
%DVIPSCommandLine: dvips paper.dvi
%DVIPSParameters: dpi=600, compressed, comments removed
%DVIPSSource:  TeX output 1997.07.18:1759
%%BeginProcSet: texc.pro
/TeXDict 250 dict def TeXDict begin /N{def}def /B{bind def}N /S{exch}N
/X{S N}B /TR{translate}N /isls false N /vsize 11 72 mul N /hsize 8.5 72
mul N /landplus90{false}def /@rigin{isls{[0 landplus90{1 -1}{-1 1}
ifelse 0 0 0]concat}if 72 Resolution div 72 VResolution div neg scale
isls{landplus90{VResolution 72 div vsize mul 0 exch}{Resolution -72 div
hsize mul 0}ifelse TR}if Resolution VResolution vsize -72 div 1 add mul
TR[matrix currentmatrix{dup dup round sub abs 0.00001 lt{round}if}
forall round exch round exch]setmatrix}N /@landscape{/isls true N}B
/@manualfeed{statusdict /manualfeed true put}B /@copies{/#copies X}B
/FMat[1 0 0 -1 0 0]N /FBB[0 0 0 0]N /nn 0 N /IE 0 N /ctr 0 N /df-tail{
/nn 8 dict N nn begin /FontType 3 N /FontMatrix fntrx N /FontBBox FBB N
string /base X array /BitMaps X /BuildChar{CharBuilder}N /Encoding IE N
end dup{/foo setfont}2 array copy cvx N load 0 nn put /ctr 0 N[}B /df{
/sf 1 N /fntrx FMat N df-tail}B /dfs{div /sf X /fntrx[sf 0 0 sf neg 0 0]
N df-tail}B /E{pop nn dup definefont setfont}B /ch-width{ch-data dup
length 5 sub get}B /ch-height{ch-data dup length 4 sub get}B /ch-xoff{
128 ch-data dup length 3 sub get sub}B /ch-yoff{ch-data dup length 2 sub
get 127 sub}B /ch-dx{ch-data dup length 1 sub get}B /ch-image{ch-data
dup type /stringtype ne{ctr get /ctr ctr 1 add N}if}B /id 0 N /rw 0 N
/rc 0 N /gp 0 N /cp 0 N /G 0 N /sf 0 N /CharBuilder{save 3 1 roll S dup
/base get 2 index get S /BitMaps get S get /ch-data X pop /ctr 0 N ch-dx
0 ch-xoff ch-yoff ch-height sub ch-xoff ch-width add ch-yoff
setcachedevice ch-width ch-height true[1 0 0 -1 -.1 ch-xoff sub ch-yoff
.1 sub]/id ch-image N /rw ch-width 7 add 8 idiv string N /rc 0 N /gp 0 N
/cp 0 N{rc 0 ne{rc 1 sub /rc X rw}{G}ifelse}imagemask restore}B /G{{id
gp get /gp gp 1 add N dup 18 mod S 18 idiv pl S get exec}loop}B /adv{cp
add /cp X}B /chg{rw cp id gp 4 index getinterval putinterval dup gp add
/gp X adv}B /nd{/cp 0 N rw exit}B /lsh{rw cp 2 copy get dup 0 eq{pop 1}{
dup 255 eq{pop 254}{dup dup add 255 and S 1 and or}ifelse}ifelse put 1
adv}B /rsh{rw cp 2 copy get dup 0 eq{pop 128}{dup 255 eq{pop 127}{dup 2
idiv S 128 and or}ifelse}ifelse put 1 adv}B /clr{rw cp 2 index string
putinterval adv}B /set{rw cp fillstr 0 4 index getinterval putinterval
adv}B /fillstr 18 string 0 1 17{2 copy 255 put pop}for N /pl[{adv 1 chg}
{adv 1 chg nd}{1 add chg}{1 add chg nd}{adv lsh}{adv lsh nd}{adv rsh}{
adv rsh nd}{1 add adv}{/rc X nd}{1 add set}{1 add clr}{adv 2 chg}{adv 2
chg nd}{pop nd}]dup{bind pop}forall N /D{/cc X dup type /stringtype ne{]
}if nn /base get cc ctr put nn /BitMaps get S ctr S sf 1 ne{dup dup
length 1 sub dup 2 index S get sf div put}if put /ctr ctr 1 add N}B /I{
cc 1 add D}B /bop{userdict /bop-hook known{bop-hook}if /SI save N @rigin
0 0 moveto /V matrix currentmatrix dup 1 get dup mul exch 0 get dup mul
add .99 lt{/QV}{/RV}ifelse load def pop pop}N /eop{SI restore userdict
/eop-hook known{eop-hook}if showpage}N /@start{userdict /start-hook
known{start-hook}if pop /VResolution X /Resolution X 1000 div /DVImag X
/IE 256 array N 0 1 255{IE S 1 string dup 0 3 index put cvn put}for
65781.76 div /vsize X 65781.76 div /hsize X}N /p{show}N /RMat[1 0 0 -1 0
0]N /BDot 260 string N /rulex 0 N /ruley 0 N /v{/ruley X /rulex X V}B /V
{}B /RV statusdict begin /product where{pop product dup length 7 ge{0 7
getinterval dup(Display)eq exch 0 4 getinterval(NeXT)eq or}{pop false}
ifelse}{false}ifelse end{{gsave TR -.1 .1 TR 1 1 scale rulex ruley false
RMat{BDot}imagemask grestore}}{{gsave TR -.1 .1 TR rulex ruley scale 1 1
false RMat{BDot}imagemask grestore}}ifelse B /QV{gsave newpath transform
round exch round exch itransform moveto rulex 0 rlineto 0 ruley neg
rlineto rulex neg 0 rlineto fill grestore}B /a{moveto}B /delta 0 N /tail
{dup /delta X 0 rmoveto}B /M{S p delta add tail}B /b{S p tail}B /c{-4 M}
B /d{-3 M}B /e{-2 M}B /f{-1 M}B /g{0 M}B /h{1 M}B /i{2 M}B /j{3 M}B /k{
4 M}B /w{0 rmoveto}B /l{p -4 w}B /m{p -3 w}B /n{p -2 w}B /o{p -1 w}B /q{
p 1 w}B /r{p 2 w}B /s{p 3 w}B /t{p 4 w}B /x{0 S rmoveto}B /y{3 2 roll p
a}B /bos{/SS save N}B /eos{SS restore}B end
%%EndProcSet
%%BeginFont: Times-Bold
% @psencodingfile{
%   author = "S. Rahtz, P. MacKay, Alan Jeffrey, B. Horn, K. Berry",
%   version = "0.6",
%   date = "14 April 1995",
%   filename = "8r.enc",
%   email = "kb@cs.umb.edu",
%   address = "135 Center Hill Rd. // Plymouth, MA 02360",
%   codetable = "ISO/ASCII",
%   checksum = "xx",
%   docstring = "Encoding for TrueType or Type 1 fonts to be used with TeX."
% }
% 
% Idea is to have all the characters normally included in Type 1 fonts
% available for typesetting. This is effectively the characters in Adobe
% Standard Encoding + ISO Latin 1 + extra characters from Lucida.
% 
% Character code assignments were made as follows:
% 
% (1) the Windows ANSI characters are almost all in their Windows ANSI
% positions, because some Windows users cannot easily reencode the
% fonts, and it makes no difference on other systems. The only Windows
% ANSI characters not available are those that make no sense for
% typesetting -- rubout (127 decimal), nobreakspace (160), softhyphen
% (173). quotesingle and grave are moved just because it's such an
% irritation not having them in TeX positions.
% 
% (2) Remaining characters are assigned arbitrarily to the lower part
% of the range, avoiding 0, 10 and 13 in case we meet dumb software.
% 
% (3) Y&Y Lucida Bright includes some extra text characters; in the
% hopes that other PostScript fonts, perhaps created for public
% consumption, will include them, they are included starting at 0x12.
% 
% (4) Remaining positions left undefined are for use in (hopefully)
% upward-compatible revisions, if someday more characters are generally
% available.
% 
% (5) hyphen appears twice for compatibility with both ASCII and Windows.
% 
/TeXBase1Encoding [
% 0x00 (encoded characters from Adobe Standard not in Windows 3.1)
  /.notdef /dotaccent /fi /fl
  /fraction /hungarumlaut /Lslash /lslash
  /ogonek /ring /.notdef
  /breve /minus /.notdef 
% These are the only two remaining unencoded characters, so may as
% well include them.
  /Zcaron /zcaron 
% 0x10
 /caron /dotlessi 
% (unusual TeX characters available in, e.g., Lucida Bright)
 /dotlessj /ff /ffi /ffl 
 /.notdef /.notdef /.notdef /.notdef
 /.notdef /.notdef /.notdef /.notdef
 % very contentious; it's so painful not having quoteleft and quoteright
 % at 96 and 145 that we move the things normally found there down to here.
 /grave /quotesingle 
% 0x20 (ASCII begins)
 /space /exclam /quotedbl /numbersign
 /dollar /percent /ampersand /quoteright
 /parenleft /parenright /asterisk /plus /comma /hyphen /period /slash
% 0x30
 /zero /one /two /three /four /five /six /seven
 /eight /nine /colon /semicolon /less /equal /greater /question
% 0x40
 /at /A /B /C /D /E /F /G /H /I /J /K /L /M /N /O
% 0x50
 /P /Q /R /S /T /U /V /W
 /X /Y /Z /bracketleft /backslash /bracketright /asciicircum /underscore
% 0x60
 /quoteleft /a /b /c /d /e /f /g /h /i /j /k /l /m /n /o
% 0x70
 /p /q /r /s /t /u /v /w
 /x /y /z /braceleft /bar /braceright /asciitilde
 /.notdef % rubout; ASCII ends
% 0x80
 /.notdef /.notdef /quotesinglbase /florin
 /quotedblbase /ellipsis /dagger /daggerdbl
 /circumflex /perthousand /Scaron /guilsinglleft
 /OE /.notdef /.notdef /.notdef
% 0x90
 /.notdef /.notdef /.notdef /quotedblleft
 /quotedblright /bullet /endash /emdash
 /tilde /trademark /scaron /guilsinglright
 /oe /.notdef /.notdef /Ydieresis
% 0xA0
 /.notdef % nobreakspace
 /exclamdown /cent /sterling
 /currency /yen /brokenbar /section
 /dieresis /copyright /ordfeminine /guillemotleft
 /logicalnot
 /hyphen % Y&Y (also at 45); Windows' softhyphen
 /registered
 /macron
% 0xD0
 /degree /plusminus /twosuperior /threesuperior
 /acute /mu /paragraph /periodcentered
 /cedilla /onesuperior /ordmasculine /guillemotright
 /onequarter /onehalf /threequarters /questiondown
% 0xC0
 /Agrave /Aacute /Acircumflex /Atilde /Adieresis /Aring /AE /Ccedilla
 /Egrave /Eacute /Ecircumflex /Edieresis
 /Igrave /Iacute /Icircumflex /Idieresis
% 0xD0
 /Eth /Ntilde /Ograve /Oacute
 /Ocircumflex /Otilde /Odieresis /multiply
 /Oslash /Ugrave /Uacute /Ucircumflex
 /Udieresis /Yacute /Thorn /germandbls
% 0xE0
 /agrave /aacute /acircumflex /atilde
 /adieresis /aring /ae /ccedilla
 /egrave /eacute /ecircumflex /edieresis
 /igrave /iacute /icircumflex /idieresis
% 0xF0
 /eth /ntilde /ograve /oacute
 /ocircumflex /otilde /odieresis /divide
 /oslash /ugrave /uacute /ucircumflex
 /udieresis /yacute /thorn /ydieresis
] def
%%EndFont
%%BeginProcSet: texps.pro
TeXDict begin /rf{findfont dup length 1 add dict begin{1 index /FID ne 2
index /UniqueID ne and{def}{pop pop}ifelse}forall[1 index 0 6 -1 roll
exec 0 exch 5 -1 roll VResolution Resolution div mul neg 0 0]/Metrics
exch def dict begin Encoding{exch dup type /integertype ne{pop pop 1 sub
dup 0 le{pop}{[}ifelse}{FontMatrix 0 get div Metrics 0 get div def}
ifelse}forall Metrics /Metrics currentdict end def[2 index currentdict
end definefont 3 -1 roll makefont /setfont load]cvx def}def
/ObliqueSlant{dup sin S cos div neg}B /SlantFont{4 index mul add}def
/ExtendFont{3 -1 roll mul exch}def /ReEncodeFont{/Encoding exch def}def
end
%%EndProcSet
%%BeginProcSet: special.pro
TeXDict begin /SDict 200 dict N SDict begin /@SpecialDefaults{/hs 612 N
/vs 792 N /ho 0 N /vo 0 N /hsc 1 N /vsc 1 N /ang 0 N /CLIP 0 N /rwiSeen
false N /rhiSeen false N /letter{}N /note{}N /a4{}N /legal{}N}B
/@scaleunit 100 N /@hscale{@scaleunit div /hsc X}B /@vscale{@scaleunit
div /vsc X}B /@hsize{/hs X /CLIP 1 N}B /@vsize{/vs X /CLIP 1 N}B /@clip{
/CLIP 2 N}B /@hoffset{/ho X}B /@voffset{/vo X}B /@angle{/ang X}B /@rwi{
10 div /rwi X /rwiSeen true N}B /@rhi{10 div /rhi X /rhiSeen true N}B
/@llx{/llx X}B /@lly{/lly X}B /@urx{/urx X}B /@ury{/ury X}B /magscale
true def end /@MacSetUp{userdict /md known{userdict /md get type
/dicttype eq{userdict begin md length 10 add md maxlength ge{/md md dup
length 20 add dict copy def}if end md begin /letter{}N /note{}N /legal{}
N /od{txpose 1 0 mtx defaultmatrix dtransform S atan/pa X newpath
clippath mark{transform{itransform moveto}}{transform{itransform lineto}
}{6 -2 roll transform 6 -2 roll transform 6 -2 roll transform{
itransform 6 2 roll itransform 6 2 roll itransform 6 2 roll curveto}}{{
closepath}}pathforall newpath counttomark array astore /gc xdf pop ct 39
0 put 10 fz 0 fs 2 F/|______Courier fnt invertflag{PaintBlack}if}N
/txpose{pxs pys scale ppr aload pop por{noflips{pop S neg S TR pop 1 -1
scale}if xflip yflip and{pop S neg S TR 180 rotate 1 -1 scale ppr 3 get
ppr 1 get neg sub neg ppr 2 get ppr 0 get neg sub neg TR}if xflip yflip
not and{pop S neg S TR pop 180 rotate ppr 3 get ppr 1 get neg sub neg 0
TR}if yflip xflip not and{ppr 1 get neg ppr 0 get neg TR}if}{noflips{TR
pop pop 270 rotate 1 -1 scale}if xflip yflip and{TR pop pop 90 rotate 1
-1 scale ppr 3 get ppr 1 get neg sub neg ppr 2 get ppr 0 get neg sub neg
TR}if xflip yflip not and{TR pop pop 90 rotate ppr 3 get ppr 1 get neg
sub neg 0 TR}if yflip xflip not and{TR pop pop 270 rotate ppr 2 get ppr
0 get neg sub neg 0 S TR}if}ifelse scaleby96{ppr aload pop 4 -1 roll add
2 div 3 1 roll add 2 div 2 copy TR .96 dup scale neg S neg S TR}if}N /cp
{pop pop showpage pm restore}N end}if}if}N /normalscale{Resolution 72
div VResolution 72 div neg scale magscale{DVImag dup scale}if 0 setgray}
N /psfts{S 65781.76 div N}N /startTexFig{/psf$SavedState save N userdict
maxlength dict begin /magscale true def normalscale currentpoint TR
/psf$ury psfts /psf$urx psfts /psf$lly psfts /psf$llx psfts /psf$y psfts
/psf$x psfts currentpoint /psf$cy X /psf$cx X /psf$sx psf$x psf$urx
psf$llx sub div N /psf$sy psf$y psf$ury psf$lly sub div N psf$sx psf$sy
scale psf$cx psf$sx div psf$llx sub psf$cy psf$sy div psf$ury sub TR
/showpage{}N /erasepage{}N /copypage{}N /p 3 def @MacSetUp}N /doclip{
psf$llx psf$lly psf$urx psf$ury currentpoint 6 2 roll newpath 4 copy 4 2
roll moveto 6 -1 roll S lineto S lineto S lineto closepath clip newpath
moveto}N /endTexFig{end psf$SavedState restore}N /@beginspecial{SDict
begin /SpecialSave save N gsave normalscale currentpoint TR
@SpecialDefaults count /ocount X /dcount countdictstack N}N /@setspecial
{CLIP 1 eq{newpath 0 0 moveto hs 0 rlineto 0 vs rlineto hs neg 0 rlineto
closepath clip}if ho vo TR hsc vsc scale ang rotate rwiSeen{rwi urx llx
sub div rhiSeen{rhi ury lly sub div}{dup}ifelse scale llx neg lly neg TR
}{rhiSeen{rhi ury lly sub div dup scale llx neg lly neg TR}if}ifelse
CLIP 2 eq{newpath llx lly moveto urx lly lineto urx ury lineto llx ury
lineto closepath clip}if /showpage{}N /erasepage{}N /copypage{}N newpath
}N /@endspecial{count ocount sub{pop}repeat countdictstack dcount sub{
end}repeat grestore SpecialSave restore end}N /@defspecial{SDict begin}
N /@fedspecial{end}B /li{lineto}B /rl{rlineto}B /rc{rcurveto}B /np{
/SaveX currentpoint /SaveY X N 1 setlinecap newpath}N /st{stroke SaveX
SaveY moveto}N /fil{fill SaveX SaveY moveto}N /ellipse{/endangle X
/startangle X /yrad X /xrad X /savematrix matrix currentmatrix N TR xrad
yrad scale 0 0 1 startangle endangle arc savematrix setmatrix}N end
%%EndProcSet
TeXDict begin 40258431 52099146 1000 600 600 (paper.dvi)
@start /Fa 82[40 20[40 32[40 40 40 40 40 40 1[40 2[40
40 40 1[40 40 2[40 40 40 19[40 5[40 14[40 10[40 40 46[{
TeXBase1Encoding ReEncodeFont}22 66.666667 /Courier rf
/Fb 1 23 df<131C013EEB0380ED07C0017E130F1680137CA201FC131F16005BA200015C
153E5BA20003147E157C5BA20007ECFC08EDF8185BA2000F0101133816309038E003F002
071370001F90380EF8609039F83C78E090397FF03FC090391FC00F0048C9FCA2123EA212
7EA2127CA212FCA25AA21270252C7E9D2A>22 D E /Fc 82[22 51[29
29 1[29 33 18 26 26 1[33 33 33 48 18 29 18 18 33 33 18
29 33 29 33 33 8[41 55 1[48 37 33 41 1[41 48 44 55 37
2[22 48 48 41 41 48 44 1[41 7[33 33 33 33 33 33 2[33
33 1[17 1[17 2[22 22 22 39[{TeXBase1Encoding ReEncodeFont}56
66.666667 /Times-Italic rf /Fd 137[45 8[45 1[45 5[45
45 52[45 47[{TeXBase1Encoding ReEncodeFont}6 75.000000
/Courier rf /Fe 167[43 7[33 12[40 67[{TeXBase1Encoding ReEncodeFont}3
59.999974 /Times-Roman rf /Ff 82[22 4[22 17[33 27[29
33 33 48 33 33 18 26 22 1[33 33 33 52 18 33 18 18 33
33 22 29 33 29 33 29 3[22 1[22 41 48 48 63 48 48 41 37
44 1[37 48 48 59 41 48 26 22 48 48 37 41 48 44 44 48
1[29 4[18 33 33 33 33 33 33 33 33 33 33 18 17 1[17 2[22
22 22 8[22 26[37 37 2[{TeXBase1Encoding ReEncodeFont}76
66.666667 /Times-Roman rf /Fg 134[33 4[22 26 29 1[37
33 37 55 18 37 1[18 37 2[29 37 29 1[33 13[37 2[41 52
10[48 1[44 24[22 22 40[{TeXBase1Encoding ReEncodeFont}23
66.666667 /Times-Bold rf /Fh 1 49 df<EA01E0EA03F0A4EA07E0A213C0120FA213
80A2EA1F00A2121EA2123E123CA25AA3127012F05A12600C1A7E9B12>48
D E /Fi 2 42 df<EB01C0EB03E0130F131FEB3FC0EB7F80EBFE00485A5B1203485A5B48
5AA2485AA248C7FCA3127EA45AAC127EA47EA36C7EA26C7EA26C7E7F6C7E12017F6C7EEB
7F80EB3FC0EB1FE0130F1303EB01C0133A73B327>40 D<127012F812FE7E6C7E6C7EEA0F
E06C7E12037F6C7E1200137EA27FA2EB1F80A3EB0FC0A4EB07E0ACEB0FC0A4EB1F80A3EB
3F00A2137EA25B1201485A5B1207485AEA3FC0485A48C7FC5A12F81270133A7AB327>I
E /Fj 1 85 df<001FB612FCA29039003E007C003C151C00385B12300070151812605C5A
A3C648481300A4495AA4495AA4495AA449C8FCA35B381FFFFE5C26227DA124>84
D E /Fk 3 110 df<0003B812F05A18E0903AF0007F000FD80F8049130390C71401000E
5C48EE00C01401121800384A1301A2003001031580127000605CA20207140300E01700C7
4990C7FCA2140FA25DA2141FA25DA2143FA25DA2147FA292C9FCA25CA25CA21301A25CA2
1303A25C497E001FB512FEA334337FB22D>84 D<133FEA1FFFA25B1200A35BA21201A25B
A21203A25BA21207A2EBE0F8EBE3FF390FEF07809038FC03C001F813E0EBF001D81FE013
F013C0138015F8123FA21300A248130315F0127EA2140700FE14E05AA2EC0FC0A2EC1F80
007C14005C147E003C137C003E5B381E01F0380F07C06CB4C7FCEA00FC1D357EB321>98
D<D801E001FEEB07F03C07F803FF801FFC3C0E3E0F07E0783F001C903B3C03F1E01F803C
181F7001F3800F003801E0EBF70026303FC001FE14C01270006001805B02005B0303141F
D8E07F4A1480EA407E12000307143F01FE1700495C60030F147E1201494A13FEF0FC0403
1F150E00030401130C49028013F8191C033F01031318000717F04902001438050113704B
15E0000F933800F1C049017EEC7F80D80380011CEC1E003F227EA044>109
D E /Fl 82[25 50[33 37 37 54 37 42 25 29 33 42 42 37
42 62 21 42 1[21 42 37 25 33 42 33 42 37 8[54 75 1[54
50 42 54 1[46 58 54 71 50 58 1[29 58 58 46 50 54 54 50
54 6[25 10[21 19 46[{TeXBase1Encoding ReEncodeFont}50
75.000000 /Times-Bold rf /Fm 2 63 df<160E163E16FEED03F8ED0FE0ED3F80EDFE
00EC03F8EC0FE0EC3F8002FEC7FCEB03F8EB0FE0EB3F8001FEC8FCEA03F8EA0FE0EA3F80
00FEC9FC12F812FEEA3F80EA0FE0EA03F8EA00FEEB3F80EB0FE0EB03F8EB00FEEC3F80EC
0FE0EC03F8EC00FEED3F80ED0FE0ED03F8ED00FE163E160E27277AA134>60
D<12E012F812FEEA3F80EA0FE0EA03F8EA00FEEB3F80EB0FE0EB03F8EB00FEEC3F80EC0F
E0EC03F8EC00FEED3F80ED0FE0ED03F8ED00FE163E16FEED03F8ED0FE0ED3F80EDFE00EC
03F8EC0FE0EC3F8002FEC7FCEB03F8EB0FE0EB3F8001FEC8FCEA03F8EA0FE0EA3F8000FE
C9FC12F812E027277AA134>62 D E /Fn 1 14 df<913801FFC0021F13FC91B67E499038
007FC0D907F0EB07F0D91F80EB00FC49C8127E017C151F01F0ED078048486F7E48486F7E
48486F7E90CA1270481778001E83001C171C003C171E0038170E0078170F007083A200F0
1880481703A96C170700701800A200785F0038170E003C171E001C171C001E173C6C5F6C
17706D16F06C6C4B5A6C6C4B5A6C6C4B5A017C031FC7FC013F157E6D6C5CD907F0EB07F0
D901FFEB7FC06D90B55A021F01FCC8FC020113C039357CA842>13
D E /Fo 82[19 51[29 29 42 29 29 16 23 19 29 29 29 29
45 16 29 16 16 29 29 19 26 29 26 29 26 7[42 1[55 1[42
36 32 39 1[32 42 42 52 1[42 1[19 1[42 32 1[42 39 1[42
54 6[29 29 1[29 29 29 1[29 29 29 16 15 1[15 33 1[19 19
37[32 2[{TeXBase1Encoding ReEncodeFont}59 58.333334 /Times-Roman
rf /Fp 82[25 50[29 33 33 50 33 37 21 29 29 1[37 37 37
54 21 33 1[21 37 37 21 33 37 33 37 37 11[54 14[46 46
54 20[21 19 1[19 41[37 2[{TeXBase1Encoding ReEncodeFont}33
75.000000 /Times-Italic rf /Fq 82[25 21[75 37 1[33 33
24[33 37 37 54 37 37 21 29 25 37 37 37 37 58 21 37 21
21 37 37 25 33 37 33 37 33 3[25 1[25 1[54 54 71 54 54
46 42 50 54 42 54 54 66 46 54 29 25 54 54 42 46 54 50
50 54 1[33 3[21 21 37 37 37 37 37 37 37 37 37 37 21 19
1[19 2[25 25 25 1[62 33[42 42 2[{TeXBase1Encoding ReEncodeFont}80
75.000000 /Times-Roman rf /Fr 82[30 24[46 46 24[41 46
46 66 46 51 30 36 41 51 51 46 51 76 25 51 1[25 51 46
30 41 51 41 51 46 8[66 91 1[66 61 51 66 1[56 71 66 86
61 71 1[36 71 71 56 61 66 66 61 66 6[30 46 46 46 46 46
46 46 46 46 46 25 23 1[23 41[51 2[{TeXBase1Encoding ReEncodeFont}64
91.666666 /Times-Bold rf /Fs 136[55 1[55 55 55 2[55 55
1[55 55 2[55 55 2[55 55 55 40[55 10[55 55 46[{
TeXBase1Encoding ReEncodeFont}16 91.666666 /Courier rf
/Ft 75[30 27[30 29[41 46 1[66 46 46 25 36 30 1[46 46
46 71 25 46 1[25 46 46 30 41 46 41 46 41 11[66 56 51
61 1[51 2[81 56 66 36 30 66 66 51 56 66 61 61 66 7[46
5[46 46 46 46 1[23 1[23 13[30 30[{TeXBase1Encoding ReEncodeFont}51
91.666666 /Times-Roman rf /Fu 134[58 58 3[39 45 52 1[65
58 65 97 32 65 1[32 2[39 52 65 52 65 58 13[65 2[71 9[71
78 3[84 65[{TeXBase1Encoding ReEncodeFont}23 116.666669
/Times-Bold rf end
%%EndProlog
%%BeginSetup
%%Feature: *Resolution 600dpi
TeXDict begin

%%EndSetup
%%Page: 1 1
/Times-Roman findfont 9 scalefont setfont
60 732 moveto
(                     To appear in the Proceedings of the 
16th Symposium on Operating Systems Principles (SOSP),
October, 1997.) show
1 0 bop 383 77 a Fu(A)m(pplication)29 b(P)n(erf)m(ormance)d(and)i
(Flexibility)i(on)f(Exok)o(er)n(nel)e(Systems)845 302
y Ft(M.)c(Frans)e(Kaashoek,)f(Da)o(wson)h(R.)h(Engler)l(,)h(Gre)o(gory)
f(R.)g(Ganger)l(,)665 415 y(H)736 414 y(\264)731 415
y(ector)h(M.)g(Brice)1270 414 y(\230)1262 415 y(no,)e(Russell)h(Hunt,)g
(Da)n(vid)h(Mazi)2356 414 y(\036)2351 415 y(eres,)e(Thomas)g(Pinckne)o
(y)-6 b(,)943 527 y(Robert)22 b(Grimm,)i(John)d(Jannotti,)h(and)g(K)n
(enneth)f(Mack)o(enzie)1199 640 y(M.I.T)-7 b(.)23 b(Laboratory)f(for)h
(Computer)f(Science)1379 753 y(Cambridge,)f(MA)i(02139,)e(U.S.A)1173
866 y Fs(http://www.pdos.lcs.mit.edu/)-152 1276 y Fr(Abstract)-152
1437 y Fq(The)e(e)o(xok)o(ernel)h(operating)g(system)f(architecture)g
(safely)g(gi)n(v)o(es)h(untrusted)-152 1520 y(softw)o(are)g(ef)n
(\002cient)f(control)h(o)o(v)o(er)f(hardw)o(are)h(and)g(softw)o(are)g
(resources)g(by)-152 1603 y(separating)28 b(management)h(from)f
(protection.)f(This)g(paper)h(describes)g(an)-152 1686
y(e)o(xok)o(ernel)k(system)f(that)f(allo)n(ws)g(specialized)h
(applications)g(to)g(achie)n(v)o(e)-152 1769 y(high)c(performance)g
(without)f(sacri\002cing)g(the)f(performance)j(of)d(unmod\255)-152
1852 y(i\002ed)30 b(UNIX)g(programs.)h(It)f(e)n(v)n(aluates)h(the)g(e)o
(xok)o(ernel)g(architecture)g(by)-152 1935 y(measuring)j
(end\255to\255end)f(application)g(performance)h(on)e(Xok,)h(an)f(e)o
(xo\255)-152 2018 y(k)o(ernel)i(for)g(Intel)f(x86\255based)i
(computers,)f(and)g(by)g(comparing)g(Xok')l(s)-152 2101
y(performance)17 b(to)f(the)g(performance)h(of)e(tw)o(o)h
(widely\255used)h(4.4BSD)e(UNIX)-152 2184 y(systems)20
b(\(FreeBSD)e(and)i(OpenBSD\).)f(The)h(results)f(sho)n(w)h(that)f
(common)-152 2267 y(unmodi\002ed)30 b(UNIX)e(applications)h(can)g(enjo)
o(y)g(the)f(bene\002ts)h(of)f(e)o(xok)o(er)o(\255)-152
2350 y(nels:)j(applications)h(either)f(perform)h(comparably)h(on)e
(Xok/ExOS)g(and)-152 2433 y(the)24 b(BSD)g(UNIXes,)f(or)h(perform)g
(signi\002cantly)h(better)l(.)e(In)h(addition,)h(the)-152
2516 y(results)c(sho)n(w)g(that)g(customized)g(applications)h(can)f
(bene\002t)g(substantially)-152 2599 y(from)h(control)h(o)o(v)o(er)f
(their)g(resources)h(\(e.g.,)e(a)h(f)o(actor)g(of)g(eight)g(for)g(a)g
(W)-6 b(eb)-152 2682 y(serv)o(er\).)22 b(This)f(paper)h(also)g
(describes)g(insights)g(about)h(the)e(e)o(xok)o(ernel)i(ap\255)-152
2765 y(proach)h(gained)f(through)h(b)o(uilding)g(three)e(dif)n(ferent)h
(e)o(xok)o(ernel)i(systems,)-152 2848 y(and)20 b(presents)f(no)o(v)o
(el)h(approaches)h(to)d(resource)i(multiple)o(xing.)-152
3045 y Fr(1)91 b(Intr)n(oduction)-152 3197 y Fq(In)31
b(traditional)f(operating)i(systems,)f(only)g(pri)n(vile)o(ged)g(serv)o
(ers)g(and)h(the)-152 3280 y(k)o(ernel)g(can)f(manage)i(system)e
(resources.)g(Untrusted)h(applications)g(are)-152 3364
y(restricted)25 b(to)g(the)g(interf)o(aces)h(and)g(implementations)g
(of)f(this)g(pri)n(vile)o(ged)-152 3447 y(softw)o(are.)19
b(This)g(or)o(ganization)g(is)g(\003a)o(wed)f(because)j(application)e
(demands)-152 3530 y(v)n(ary)28 b(widely)-5 b(.)28 b(An)f(interf)o(ace)
h(designed)g(to)f(accommodate)j(e)n(v)o(ery)e(appli\255)-152
3613 y(cation)g(must)g(anticipate)g(all)f(possible)h(needs.)g(The)f
(implementation)i(of)-152 3696 y(such)j(an)f(interf)o(ace)h(w)o(ould)g
(need)g(to)f(resolv)o(e)g(all)g(tradeof)n(fs)g(and)h(antic\255)-152
3779 y(ipate)g(all)g(w)o(ays)h(the)f(interf)o(ace)g(could)h(be)f(used.)
h(Experience)g(suggests)-152 3862 y(that)23 b(such)g(anticipation)g(is)
f(infeasible)h(and)h(that)e(the)h(cost)f(of)h(mistak)o(es)g(is)-152
3945 y(high)d([1,)e(4)q(,)g(8)q(,)g(11)q(,)g(21)q(,)g(39)q(].)-40
4028 y(The)24 b Fp(e)o(xok)o(ernel)g(ar)m(c)o(hitectur)m(e)h
Fq([11)q(])e(solv)o(es)h(this)f(problem)i(by)f(gi)n(ving)-152
4111 y(untrusted)34 b(applications)g(as)e(much)i(control)f(o)o(v)o(er)g
(resources)h(as)e(possi\255)-152 4194 y(ble.)19 b(It)f(does)h(so)g(by)h
(di)n(viding)f(responsibilities)g(dif)n(ferently)h(from)e(the)h(w)o(ay)
-152 4277 y(con)m(v)o(entional)d(systems)f(do.)g(Exok)o(ernels)g
(separate)g(protection)g(from)f(man\255)-152 4360 y(agement:)19
b(the)o(y)g(protect)g(resources)g(b)o(ut)f(dele)o(gate)h(management)h
(to)f(appli\255)-152 4443 y(cations.)g(F)o(or)f(e)o(xample,)h(each)g
(application)g(manages)h(its)d(o)n(wn)i(disk\255block)p
-152 4505 797 4 v -158 4573 a Fo(This)14 b(research)g(w)o(as)g
(supported)h(in)f(part)h(by)f(the)g(Adv)o(anced)g(Research)f(Projects)h
(Agenc)o(y)h(under)-152 4639 y(contract)f(N00014\25594\2551\2550985)g
(and)f(by)h(a)f(NSF)g(National)h(Y)-6 b(oung)13 b(In)n(v)o(estigator)g
(A)-5 b(w)o(ard.)13 b(Robert)-152 4706 y(Grimm)j(is)e(currently)h(at)g
(the)f(Uni)o(v)o(ersity)h(of)g(W)-5 b(ashington,)14 b(Seattle.)-83
4814 y(Cop)o(yright)189 4812 y(c)169 4814 y Fn(\015)i
Fo(1995)h(by)f(the)h(Association)e(for)j(Computing)f(Machinery)l(,)e
(Inc.)i(Permission)-152 4880 y(to)e(mak)o(e)g(digital)h(or)f(hard)g
(copies)f(of)h(part)g(or)g(all)g(of)g(this)g(w)o(ork)h(for)f(personal)g
(or)g(classroom)f(use)-152 4946 y(is)20 b(granted)g(without)h(fee)f
(pro)o(vided)h(that)f(copies)g(are)g(not)g(made)g(or)g(distrib)o(uted)h
(for)f(pro\002t)h(or)-152 5013 y(commercial)15 b(adv)o(antage)f(and)g
(that)h(ne)o(w)f(copies)g(bear)h(this)f(notice)h(and)f(the)h(full)g
(citation)g(on)g(the)-152 5079 y(\002rst)e(page.)f(Cop)o(yrights)i(for)
f(components)g(of)g(this)g(W)o(ORK)f(o)o(wned)h(by)f(others)h(than)g(A)
n(CM)f(must)-152 5146 y(be)j(honored.)f(Abstracting)h(with)g(credit)g
(is)f(permitted.)-87 5212 y(T)-5 b(o)13 b(cop)o(y)g(otherwise,)f(to)h
(republish,)f(to)h(post)g(on)f(serv)o(ers)h(or)g(to)g(redistrib)o(ute)g
(to)g(lists,)f(requires)-152 5279 y(prior)20 b(speci\002c)f(permission)
g(and/or)h(a)f(fee.)f(Request)h(Permissions)g(from)h(Publications)f
(Dept,)-152 5345 y(A)n(CM)14 b(Inc.,)g(F)o(ax)h(+1)f(\(212\))h
(869\2550481,)g(or)g Fm(<)p Fo(permissions@acm.or)o(g)p
Fm(>)p Fo(.)2040 1276 y Fq(cache,)k(b)o(ut)f(the)h(e)o(xok)o(ernel)h
(allo)n(ws)e(cached)i(pages)f(to)g(be)f(shared)i(securely)2040
1359 y(across)f(all)e(applications.)i(Thus,)f(the)g(e)o(xok)o(ernel)h
(protects)f(pages)h(and)g(disk)2040 1442 y(blocks,)h(b)o(ut)e
(applications)i(manage)g(them.)2152 1525 y(Of)h(course,)h(not)f(all)g
(applications)h(need)h(customized)f(resource)g(man\255)2040
1608 y(agement.)17 b(Instead)h(of)e(communicating)j(with)d(the)h(e)o
(xok)o(ernel)h(directly)-5 b(,)17 b(we)2040 1691 y(e)o(xpect)31
b(most)g(programs)g(to)g(be)g(link)o(ed)g(with)f(libraries)g(that)h
(hide)g(lo)n(w\255)2040 1774 y(le)n(v)o(el)h(resources)i(behind)f
(traditional)f(operating)h(system)g(abstractions.)2040
1857 y(Ho)n(we)n(v)o(er)m(,)22 b(unlik)o(e)g(traditional)f
(implementations)h(of)f(these)g(abstractions,)2040 1940
y(library)15 b(implementations)h(are)g(unpri)n(vile)o(ged)g(and)g(can)g
(therefore)f(be)h(mod\255)2040 2023 y(i\002ed)k(or)h(replaced)g(at)f
(will.)g(W)-6 b(e)20 b(refer)g(to)g(these)h(unpri)n(vile)o(ged)h
(libraries)e(as)2040 2107 y Fp(libr)o(ary)f(oper)o(ating)h(systems,)f
Fq(or)g(libOSes.)2152 2190 y(W)-6 b(e)13 b(hope)h(the)f(e)o(xok)o
(ernel)h(or)o(ganization)g(will)e(f)o(acilitate)g(operating)i(sys\255)
2040 2273 y(tem)h(inno)o(v)n(ation:)i(there)e(are)g(se)n(v)o(eral)h
(orders)g(of)f(magnitude)h(more)g(applica\255)2040 2356
y(tion)h(programmers)i(than)f(OS)e(implementors,)i(and)g(an)o(y)g
(programmer)g(can)2040 2439 y(specialize)e(a)g(libOS)g(without)g(af)n
(fecting)g(the)g(rest)g(of)g(the)g(system.)g(LibOSes)2040
2522 y(also)21 b(allo)n(w)f(incremental,)h(selecti)n(v)o(e)g(adoption)h
(of)f(ne)n(w)g(OS)f(features:)g(ap\255)2040 2605 y(plications)g(link)g
(with)f(the)h(libOSes)f(that)g(pro)o(vide)i(what)e(the)o(y)h
(need\227ne)n(w)2040 2688 y(OS)k(functionality)h(is)f(ef)n(fecti)n(v)o
(ely)h(distrib)o(uted)f(with)g(the)g(application)i(bi\255)2040
2771 y(nary)-5 b(.)2152 2854 y(The)15 b(e)o(xok)o(ernel)h(approach)h
(raises)e(se)n(v)o(eral)g(questions.)h(Can)f(ambitious)2040
2937 y(applications)c(actually)g(achie)n(v)o(e)g(signi\002cant)g
(performance)g(impro)o(vements)2040 3020 y(on)20 b(an)h(e)o(xok)o
(ernel?)g(W)m(ill)d(traditional)i(applications\227for)h(e)o(xample,)f
(unal\255)2040 3103 y(tered)i(UNIX)f(applications\227pay)i(a)f(price)f
(in)h(reduced)h(performance?)g(Is)2040 3186 y(global)32
b(performance)h(compromised)g(when)f(no)g(centralized)g(authority)2040
3269 y(decides)26 b(scheduling)h(and)f(multiple)o(xing)g(policies?)g
(Does)f(the)h(lack)f(of)g(a)2040 3352 y(centralized)d(management)h
(polic)o(y)f(for)f(shared)h(OS)f(structures)h(lo)n(wer)f(the)2040
3435 y(inte)o(grity)e(of)g(the)g(system?)2152 3518 y(This)d(paper)h
(attempts)g(to)f(answer)h(these)f(questions)i(and)f(thereby)g(e)n(v)n
(al\255)2040 3601 y(uate)32 b(the)f(soundness)j(of)e(the)f(e)o(xok)o
(ernel)i(approach.)g(Our)f(e)o(xperiments)2040 3684 y(are)20
b(performed)h(on)f(the)g(Xok/ExOS)g(e)o(xok)o(ernel)h(system.)f(Xok)g
(is)g(an)g(e)o(xo\255)2040 3767 y(k)o(ernel)d(for)f(Intel)f
(x86\255based)j(computers)f(and)g(ExOS)e(is)h(its)f(def)o(ault)i
(libOS.)2040 3850 y(Xok/ExOS)c(compiles)h(on)g(itself)e(and)i(runs)g
(man)o(y)g(unmodi\002ed)g(UNIX)f(pro\255)2040 3933 y(grams)25
b(\(e.g.,)f(perl,)h(gcc,)f(telnet,)h(and)g(most)g(\002le)f
(utilities\).)f(W)-6 b(e)24 b(compare)2040 4016 y(Xok/ExOS)c(to)g(tw)o
(o)h(widely\255used)g(4.4BSD)f(UNIX)g(systems)g(running)i(on)2040
4099 y(the)d(same)g(hardw)o(are,)h(using)f(lar)o(ge,)g(real\255w)o
(orld)g(applications.)2152 4182 y(ExOS)28 b(ensures)i(the)e(inte)o
(grity)h(of)f(man)o(y)i(of)e(its)g(abstractions)i(using)2040
4265 y(Xok')l(s)25 b(support)h(for)f(protected)g(sharing.)h(Some)e
(abstractions,)i(ho)n(we)n(v)o(er)m(,)2040 4348 y(still)12
b(use)g(shared)g(global)g(data)g(structures.)g(ExOS)g(cannot)g(guaran)q
(tee)g(UNIX)2040 4431 y(semantics)21 b(for)f(these)g(abstractions)h
(until)f(the)o(y)h(are)f(protected)h(from)g(arbi\255)2040
4514 y(trary)g(writes)f(by)i(other)f(processes.)h(In)f(our)h
(measurements,)g(we)e(approxi\255)2040 4597 y(mate)g(the)g(cost)g(of)g
(this)f(protection)i(by)f(inserting)h(system)f(calls)f(before)i(all)
2040 4680 y(writes)d(to)h(shared)h(global)f(state.)2152
4763 y(Our)g(results)g(sho)n(w)g(that)g(most)g(unmodi\002ed)h(UNIX)e
(applications)i(per)o(\255)2040 4846 y(form)31 b(comparably)h(on)f
(Xok/ExOS)f(and)i(on)f(FreeBSD)e(or)i(OpenBSD.)2040 4929
y(Some)d(applications,)h(ho)n(we)n(v)o(er)m(,)g(run)g(up)g(to)f(a)g(f)o
(actor)h(of)f(four)h(f)o(aster)f(on)2040 5012 y(Xok/ExOS.)e
(Experiments)i(with)e(multiple)h(applications)h(running)g(con\255)2040
5095 y(currently)h(also)g(sho)n(w)h(that)f(e)o(xok)o(ernels)h(can)f(of)
n(fer)g(competiti)n(v)o(e)h(global)2040 5178 y(system)19
b(performance.)2152 5261 y(W)-6 b(e)23 b(also)g(demonstrate)h(that)e
(application\255le)n(v)o(el)i(control)f(can)h(signi\002\255)2040
5344 y(cantly)h(impro)o(v)o(e)f(the)h(performance)g(of)f(applications.)
h(F)o(or)f(e)o(xample,)h(we)p eop
%%Page: 2 2
2 1 bop -152 -69 a Fq(describe)27 b(a)e(ne)n(w)h(high\255performance)h
(HTTP)d(serv)o(er)m(,)i(Cheetah,)f(that)h(ac\255)-152
14 y(ti)n(v)o(ely)g(e)o(xploits)g(e)o(xok)o(ernel)i(e)o(xtensibility)-5
b(.)26 b(Cheetah)g(uses)g(a)g(\002le)f(system)-152 97
y(and)c(a)f(TCP)f(implementation)i(customized)g(for)f(the)g(properties)
h(of)f(HTTP)-152 180 y(traf)n(\002c.)13 b(Cheetah)h(performs)g(up)g(to)
f(eight)h(times)f(f)o(aster)h(than)g(the)f(best)h(UNIX)-152
263 y(HTTP)k(serv)o(er)h(we)g(measured)h(on)f(the)g(same)g(hardw)o
(are.)-40 346 y(In)33 b(addition)g(to)f(e)n(v)n(aluating)i(the)e(e)o
(xok)o(ernel)i(approach,)g(this)e(paper)-152 429 y(presents)25
b(ne)n(w)f(k)o(ernel)h(interf)o(aces)g(that)f(separate)g(protection)h
(from)f(man\255)-152 512 y(agement.)19 b(W)-6 b(e)18
b(discuss)h(the)g(disk)f(subsystem,)i(XN,)d(and)i(e)o(xplain)g(ho)n(w)g
(un\255)-152 596 y(pri)n(vile)o(ged)24 b(applications)f(can)h(de\002ne)
f(ne)n(w)g(\002le)f(systems)h(and)g(ho)n(w)g(these)-152
679 y(\002le)16 b(systems)i(can)f(safely)g(multiple)o(x)g(the)g(same)g
(disk)g(at)g(a)f(\002ne)h(granularity)-5 b(.)-152 762
y(Finally)g(,)24 b(we)h(summarize)g(what)f(we)h(ha)o(v)o(e)g(learned)g
(from)g(b)o(uilding)f(three)-152 845 y(complete)17 b(e)o(xok)o(ernel)h
(systems)f(\(Xok,)f(Ae)o(gis)g([11)q(])f(for)i(DECstations,)e(and)-152
928 y(Glaze)k([29)q(])f(for)h(the)g(Fugu)h(multiprocessor\).)-40
1011 y(The)14 b(rest)g(of)g(the)g(paper)h(is)e(or)o(ganized)i(as)f
(follo)n(ws.)g(Section)g(2)g(discusses)-152 1094 y(related)h(w)o(ork.)f
(Section)g(3)g(summarizes)h(the)f(e)o(xok)o(ernel)i(architecture.)e
(Sec\255)-152 1177 y(tion)g(4)f(pro)o(vides)i(a)e(detailed)h(e)o
(xample)g(of)g(reconciling)g(application)g(control)-152
1260 y(with)j(protection)g(by)g(presenting)h(the)e(disk)h(system)g(XN.)
f(Section)h(5)g(brie\003y)-152 1343 y(o)o(v)o(ervie)n(ws)g(Xok/ExOS,)f
(the)g(e)o(xperimental)h(en)m(vironment)h(for)e(this)g(paper)l(.)-152
1426 y(Section)24 b(6)g(reports)g(on)g(the)g(performance)h(of)f
(unaltered)h(UNIX)e(applica\255)-152 1509 y(tions,)f(while)f(Section)h
(7)f(reports)h(on)g(the)g(performance)h(of)e(aggressi)n(v)o(ely\255)
-152 1592 y(specialized)12 b(applications,)g(such)g(as)g(the)g
(high\255performan)q(ce)g(Che)q(etah)g(web)-152 1675
y(serv)o(er)l(.)23 b(Section)h(8)f(in)m(v)o(estigates)g(global)h
(performance)h(on)f(an)f(e)o(xok)o(ernel)-152 1758 y(system.)31
b(Section)g(9)g(discusses)h(our)f(e)o(xperiences)i(with)d(b)o(uilding)h
(three)-152 1841 y(dif)n(ferent)19 b(e)o(xok)o(ernel)i(systems.)e
(Section)g(10)g(concludes.)-152 2038 y Fr(2)91 b(Related)22
b(W)-7 b(ork)-152 2190 y Fq(The)16 b(e)o(xok)o(ernel)h(architecture)f
(w)o(as)g(proposed)h(in)f([11],)f(which)h(described)h(a)-152
2273 y(research)e(prototype)h(that)e(performed)h(signi\002cantly)g
(better)f(than)h(Ultrix)e(on)-152 2356 y(microbenchmarks.)19
b(While)e(the)g(paper)h(pro)o(vided)g(e)n(vidence)h(that)e(the)g(e)o
(xo\255)-152 2439 y(k)o(ernel)h(approach)g(w)o(as)f(promising,)g(it)f
(left)g(man)o(y)i(questions)f(unanswered.)-40 2522 y(There)f(is)f(a)h
(lar)o(ge)f(literature)g(on)h(e)o(xtensible)g(operating)h(systems,)e
(start\255)-152 2605 y(ing)j(with)g(the)g(classic)g(rationales)g(by)g
(Lampson)h(and)g(Brinch)f(Hansen)h([19,)-152 2688 y(25)q(,)i(26)q(].)g
(Pre)n(vious)h(approaches)i(to)e(e)o(xtensibility)g(can)g(be)g
(coarsely)h(clas\255)-152 2771 y(si\002ed)k(in)h(three)f(groups:)h
(better)g(microk)o(ernels,)g(virtual)f(machines,)h(and)-152
2854 y(do)n(wnloading)k(untrusted)e(code)h(into)e(the)h(k)o(ernel.)g(W)
-6 b(e)29 b(discuss)h(each)h(in)-152 2937 y(turn.)-40
3021 y(The)c(principal)h(goal)f(of)g(an)g(e)o(xok)o(ernel\227gi)n(ving)
i(applications)f(con\255)-152 3104 y(trol\227is)12 b(orthogonal)j(to)e
(the)g(question)h(of)f(monolithic)g(v)o(ersus)h(microk)o(ernel)-152
3187 y(or)o(ganization.)20 b(If)e(applications)i(are)f(restricted)g(to)
g(inadequate)h(interf)o(aces,)-152 3270 y(it)32 b(mak)o(es)h(little)e
(dif)n(ference)i(whether)g(the)f(implementations)h(reside)g(in)-152
3353 y(the)27 b(k)o(ernel)h(or)e(pri)n(vile)o(ged)i(user)o(\255le)n(v)o
(el)f(serv)o(ers)g([20,)f(18)q(];)g(in)h(both)g(cases)-152
3436 y(applications)c(lack)f(control.)g(F)o(or)f(e)o(xample,)i(it)e(is)
g(dif)n(\002cult)h(to)f(change)j(the)-152 3519 y(b)o(uf)n(fer)j
(management)h(polic)o(y)g(of)e(a)h(shared)h(\002le)e(serv)o(er)l(.)g
(In)h(man)o(y)g(w)o(ays,)-152 3602 y(serv)o(ers)16 b(can)h(be)f(vie)n
(wed)g(as)g(\002x)o(ed)g(k)o(ernel)h(subsystems)g(that)e(happen)j(to)d
(run)-152 3685 y(in)24 b(user)g(space.)g(Whether)g(monolithic)g(or)g
(microk)o(ernel\255based,)h(the)f(goal)-152 3768 y(of)e(an)g(e)o(xok)o
(ernel)h(system)g(remains)f(for)f(pri)n(vile)o(ged)i(softw)o(are)f(to)g
(pro)o(vide)-152 3851 y(interf)o(aces)h(that)f(do)h(not)g(limit)e(the)h
(ability)h(of)f(unpri)n(vile)o(ged)i(applications)-152
3934 y(to)19 b(manage)h(their)f(o)n(wn)g(resources.)-40
4017 y(Some)29 b(ne)n(wer)f(microk)o(ernels)i(push)f(the)f(k)o(ernel)i
(interf)o(ace)e(closer)h(to)-152 4100 y(the)21 b(hardw)o(are)h([8,)e
(20)q(,)g(36],)g(obtaining)i(better)e(performance)i(and)g(rob)o
(ust\255)-152 4183 y(ness)h(than)f(pre)n(vious)i(microk)o(ernels)f(and)
g(allo)n(wing)f(for)g(a)h(greater)f(de)o(gree)-152 4266
y(of)28 b(\003e)o(xibility)-5 b(,)27 b(since)h(shared)g(monolithic)g
(serv)o(ers)g(can)g(be)g(brok)o(en)i(into)-152 4349 y(se)n(v)o(eral)i
(serv)o(ers.)f(T)-5 b(echniques)32 b(to)f(reduce)h(the)g(cost)f(of)g
(shared)h(serv)o(ers)-152 4432 y(by)h(impro)o(ving)g(IPC)e
(performance,)i(mo)o(ving)g(code)g(from)f(serv)o(ers)h(into)-152
4515 y(libraries,)27 b(mapping)h(read\255only)g(shared)g(data)f
(structures,)g(and)h(batching)-152 4598 y(system)c(calls)e([2,)h(18)q
(,)f(28)q(,)g(30)q(])g(can)i(also)f(be)g(successfully)h(applied)f(in)g
(an)-152 4681 y(e)o(xok)o(ernel)e(system.)-40 4764 y(V)l(irtual)14
b(machines)i([5,)e(12)q(,)g(17])h(\(VMs\))f(are)h(an)g(OS)f(structure)h
(in)f(which)-152 4847 y(a)f(pri)n(vile)o(ged)h(virtual)f(machine)h
(monitor)f(\(VMM\))g(isolates)g(less)g(pri)n(vile)o(ged)-152
4930 y(softw)o(are)23 b(in)g(emulated)g(copies)g(of)g(the)f(underlying)
i(hardw)o(are.)f(Unfortu\255)-152 5013 y(nately)-5 b(,)30
b(emulation)g(hides)g(information.)g(This)f(can)h(lead)g(to)f(inef)n
(fecti)n(v)o(e)-152 5096 y(use)c(of)f(hardw)o(are)h(resources;)f(for)g
(instance,)h(the)f(VMM)g(has)h(no)f(w)o(ay)h(of)-152
5179 y(kno)n(wing)f(if)d(a)g(VM)h(no)h(longer)f(needs)h(a)e(particular)
h(virtual)g(page.)g(More\255)-152 5262 y(o)o(v)o(er)m(,)15
b(VMs)g(can)g(only)g(share)g(resources)h(through)g(remote)f
(communication)-152 5345 y(protocols.)24 b(This)e(pre)n(v)o(ents)i(VMs)
f(from)g(sharing)g(man)o(y)h(OS)e(abstractions)2153 1088
y @beginspecial 0 @llx 22 @lly 289 @urx 221 @ury 2160
@rwi @setspecial
%%BeginDocument: exokernel.eps


/thickarrow { % fromx fromy tox toy thickness
gsave
/@t exch def
2 index sub exch 3 index sub exch 4 2 roll translate exch
2 copy atan rotate
dup mul exch dup mul add sqrt /@x exch def

0 @t neg moveto
@x @t 2.35 mul sub dup @t neg lineto
@x @t 2.85 mul sub @t -2 mul 2 copy lineto
@x 0 lineto
neg lineto
@t lineto
0 @t lineto
closepath fill
grestore
} bind def

/thinarrowhead { % fromx fromy tox toy thickness
gsave newpath
/@t exch def
2 index sub exch 3 index sub exch 4 2 roll translate exch
2 copy atan rotate
dup mul exch dup mul add sqrt /@x exch @t 1.5 mul add def

@x @t 5.2 mul sub dup @t neg moveto
@x @t 7 mul sub @t -2 mul 2 copy lineto
@x 0 lineto
neg lineto
@t lineto
closepath fill
grestore
} bind def

/thinarrowpath { % from? to? thickness
/@t exch def /@to? exch def /@from? exch def
mark
{ counttomark 2 eq { } { stop } ifelse }
{ }
{ }
{ stop }
pathforall
@to? { 4 copy @t thinarrowhead } if
counttomark -4 roll 4 2 roll
@from? { @t thinarrowhead } if
cleartomark
stroke
} bind def

/min { 2 copy lt { pop } { exch pop } ifelse } bind def

/arrowbox { % x0 y0 w h x y thickness r g b
gsave 
/@t exch def /@y exch def /@x exch def 4 copy rectfill
2 copy min 2 div /@b exch def
2 index add exch 3 index add exch % now have x0 y0 x1 y1

/@cy @y def /@cx @x def
@b sub dup @cy lt { /@cy exch def } { pop } ifelse
@b sub dup @cx lt { /@cx exch def } { pop } ifelse
@b add dup @cy gt { /@cy exch def } { pop } ifelse
@b add dup @cx gt { /@cx exch def } { pop } ifelse

@cx @cy @x @y @t thinarrow
grestore
} bind def

/rrectpath {
/@t exch def /@y exch def /@x exch def
2 copy translate 
@t 0 moveto @x 0 @x @y @t arct @x @y 0 @y @t arct
0 @y 0 0 @t arct 0 0 @x 0 @t arct closepath
neg exch neg exch translate
} bind def

/#makecolor { 255 div 3 1 roll 255 div 3 1 roll 255 div 3 1 roll }
bind def
/#color { #makecolor setrgbcolor } bind def
/showpage {} def

/#grayprogram { [ exch dup dup /#color cvx ] cvx def } bind def
/#wid /setlinewidth load def

/##b		0   #grayprogram
/##w		255 #grayprogram

/@kerny		115 def
/@kernoff	48 def

/@bcrx		65 def
/@bcry		40 def
/@bcrw		100 def
/@bcrh		38 def
/@bcrn		3 def

/@diskx		185 def
/@disky		45 def
/@diskround	0.4 def
/@diskh		30 @diskround div def
/@diskw		20 def
/##disk		230 #grayprogram
/@blockx	10 def
/@blocky	7 def
/@blockw	14 def
/@blockh	16 def

/@pagex		133 def
/@pagey		90 def

##w
0 0 371 250 rectfill

##b


% KERNEL

gsave
0 @kerny translate

gsave
4 setlinewidth 
0.5 setgray
0 0 moveto 288 0
rlineto stroke grestore

%GenText 0 -12 w=278 right
% ``Kernel''
% wx=25.612 bb=0.323,-0.095,25.4125,6.4885 nc=6
% at=(252.388, -12) wxgot=25.612
/k{0 rmoveto}bind def/s/show load def/as/ashow load def/sf/selectfont load def
252.388 -12 moveto
/Times-Roman 9.5 sf(K)s -0.237 k(er)s 0 k(nel)s

grestore


% BCR

@bcrx @bcry translate

1 setlinewidth
0 0 @bcrw @bcrh rectstroke

0.5 setlinewidth
0 @bcrh @bcrn div @bcrh { 0 exch moveto @bcrw 0 rlineto } for stroke

gsave 0 -13 translate % 0 @bcrh translate
%GenText 0 3.5 
% ``Buffer Cache Registry''
% wx=85.101 bb=0.1615,-2.071,84.8635,6.4885 nc=21
% at=(0, 3.5) wxgot=85.101
0 3.5 moveto
/Times-Roman 9.5 sf(Buf)s -0.237 k(f)s 0 k(er\040Cac)s 0 k(he\040Re)s -0.142 k(g)s 0 k(istr)s 0 k(y)s
grestore

gsave 0 @bcrh @bcrn div @bcrn 1 sub mul translate
%GenText 5 3.5 
% ``Block b = Page p''
% wx=65.379 bb=0.1615,-2.071,65.0845,6.4885 nc=16
% at=(5, 3.5) wxgot=65.379
5 3.5 moveto
 currentpoint exch 5 sub exch 2 add transform % @exos-bcr-2
/Times-Roman 9.5 sf(Bloc)s 0 k(k\040)s currentpoint exch 3 add exch 2 sub transform % @bcr-disk-1
/Times-Italic 9.5 sf(b)s/Times-Roman 9.5 sf(\040=\040P)s -0.142 k(a)s 0 k(g)s 0 k(e\040)s/Times-Italic 9.5 sf(p)s currentpoint exch 1 add exch 6 add transform % @bcr-page-1

0 @bcrh @bcrn div neg translate
%GenText 5 3.5 
% ``. . .''
% wx=11.875 bb=0.2565,-0.1045,10.811,0.95 nc=5
% at=(5, 3.5) wxgot=11.875
5 3.5 moveto
/Times-Italic 9.5 sf(.\040.\040.)s
grestore

@bcrx neg @bcry neg translate

/@bcr-page-1 [ 4 2 roll itransform ] cvx def
/@bcr-disk-1 [ 4 2 roll itransform ] cvx def
/@exos-bcr-2 [ 4 2 roll itransform ] cvx def

% DISK

gsave
@diskx @disky translate
1 @diskround scale
0 @diskw @diskh add moveto
0 @diskw lineto
@diskw @diskw @diskw 180 360 arc
0 @diskh rlineto
@diskw @diskw @diskh add @diskw 0 360 arc
% closepath
gsave ##disk fill grestore 
1 1 @diskround div scale
1.3 setlinewidth stroke
grestore

@diskx @blockx add @disky @blocky add
gsave 2 copy translate
0.7 setlinewidth
0 0 @blockw @blockh ##w rectfill
0 0 @blockw @blockh ##b rectstroke
%GenText 5 5 
% ``b''
% wx=4.75 bb=0.2185,-0.1045,4.4935,6.4885 nc=1
% at=(5, 5) wxgot=4.75
5 5 moveto
/Times-Italic 9.5 sf(b)s
grestore
@blockh 2 div add
/@bcr-disk-2 [ 4 2 roll ] cvx def

% PAGE

@pagex @pagey
gsave translate
0.7 setlinewidth
0 0 @blockw @blockh ##w rectfill
0 0 @blockw @blockh ##b rectstroke
%GenText 5 5 
% ``p''
% wx=4.75 bb=-0.7125,-1.9475,4.4555,4.1895 nc=1
% at=(5, 5) wxgot=4.75
5 5 moveto
/Times-Italic 9.5 sf(p)s
grestore
/@bcr-page-2 [ @pagex @blockw 2 div add @pagey ] cvx def
/@spec-page-2 [ @pagex @blockw 2 div add @pagey @blockh add ] cvx def

% CHEETAH

/@appx		160 def
/@appy		125 def
/@appw		90 def
/@apph		80 def
/@libh		40 def
/##lib		200 #grayprogram

2.5 setlinewidth
gsave
@appx @appy @appw @apph 10 rrectpath clip
@appx @appy translate

% LIB
##lib 30 0 @appw @libh rectfill
##b
1 #wid
30 0 moveto 0 @libh rlineto @appw 0 rlineto stroke
0.5 #wid
0 @libh moveto 30 0 rlineto 15 0 moveto 0 @libh rlineto stroke

gsave @appw @libh translate 
%GenText -10 -15 w=0 right
% ``ExOS''
% wx=22.6955 bb=0.114,-0.133,22.078,6.422 nc=4
% at=(-32.6955, -15) wxgot=22.6955
-32.6955 -15 moveto
/Times-Roman 9.5 sf(ExOS)s
%GenText -10 -25 w=0 right
% ``Subset''
% wx=25.3365 bb=0.399,-0.133,25.346,6.4885 nc=6
% at=(-35.3365, -25) wxgot=25.3365
-35.3365 -25 moveto
/Times-Roman 9.5 sf(Subset)s
@appw neg 0 translate
%GenText 0.5 -12.5 w=15 center
% ``T''
% wx=5.8045 bb=0.1615,0,5.6335,6.289 nc=1
% at=(5.09775, -12.5) wxgot=5.8045
5.09775 -12.5 moveto
/Times-Roman 9.5 sf(T)s
%GenText 0.5 -21.5 w=15 center
% ``C''
% wx=6.3365 bb=0.266,-0.133,6.0135,6.422 nc=1
% at=(4.83175, -21.5) wxgot=6.3365
4.83175 -21.5 moveto
/Times-Roman 9.5 sf(C)s
%GenText 0.5 -30.5 w=15 center
% ``P''
% wx=5.282 bb=0.152,0,5.149,6.289 nc=1
% at=(5.359, -30.5) wxgot=5.282
5.359 -30.5 moveto
/Times-Roman 9.5 sf(P)s
%GenText 15 -12.5 w=15 center
% ``F''
% wx=5.282 bb=0.114,0,5.187,6.289 nc=1
% at=(19.859, -12.5) wxgot=5.282
19.859 -12.5 moveto
/Times-Roman 9.5 sf(F)s
%GenText 15 -21.5 w=15 center
% ``S''
% wx=5.282 bb=0.399,-0.133,4.6645,6.422 nc=1
% at=(19.859, -21.5) wxgot=5.282
19.859 -21.5 moveto
/Times-Roman 9.5 sf(S)s
grestore

% APP
gsave @appw @apph translate
%GenText -10 -15 w=0 right
% ``Specialized''
% wx=43.795 bb=0.399,-2.0615,43.7095,6.4885 nc=11
% at=(-53.795, -15) wxgot=43.795
-53.795 -15 moveto
/Times-Roman 9.5 sf(Specializ)s 0 k(ed)s
%GenText -10 -25 w=0 right
% ``Application''
% wx=44.859 bb=0.1425,-2.0615,44.7165,6.4885 nc=11
% at=(-54.859, -25) wxgot=44.859
-54.859 -25 moveto
/Times-Roman 9.5 sf(A)s 0 k(pplica)s 0 k(tion)s
grestore

20 @libh 20 add transform
grestore
@appx @appy @appw @apph 10 rrectpath stroke

/@spec-page-1 [ 4 2 roll itransform ] cvx def

% APP

/@appx		30 def
/@appy		125 def
/@appw		90 def
/@apph		90 def
/@libh		40 def

2.5 setlinewidth
gsave
@appx @appy @appw @apph 10 rrectpath clip
@appx @appy translate

% LIB
##lib 0 0 @appw @libh rectfill
##b
1 setlinewidth
0 @libh moveto @appw 0 rlineto stroke

gsave @appw @libh translate 
%GenText -10 -15 w=0 right
% ``ExOS''
% wx=22.6955 bb=0.114,-0.133,22.078,6.422 nc=4
% at=(-32.6955, -15) wxgot=22.6955
-32.6955 -15 moveto
/Times-Roman 9.5 sf(ExOS)s
grestore

% APP
gsave @appw @apph translate
%GenText -10 -15 w=0 right
% ``UNIX Application''
% wx=70.452 bb=0.133,-2.0615,70.3095,6.4885 nc=16
% at=(-80.452, -15) wxgot=70.452
-80.452 -15 moveto
/Times-Roman 9.5 sf(UNIX\040)s -0.522 k(A)s 0 k(pplica)s 0 k(tion)s
grestore

% FD
gsave 20 @libh translate
%GenText 0 9 
% ``fd''
% wx=7.391 bb=-1.3965,-1.9665,7.6475,6.4885 nc=2
% at=(0, 9) wxgot=7.391
0 9 moveto
/Times-Italic 9.5 sf(fd)s currentpoint exch 2.5 add exch transform

grestore

grestore
@appx @appy @appw @apph 10 rrectpath stroke

itransform 2 copy
/@fn-exos-1 [ 4 2 roll 15 add ] cvx def
pop
/@fn-exos-2 [ 2 index @appy @libh .6 mul add ] cvx def
pop

gsave @fn-exos-2 exch 13 sub exch 13 sub translate
0.8 #wid
0 0 26 13 rectstroke
%GenText 0 3.5 w=26 center
% ``read''
% wx=17.062 bb=0.4275,-0.1235,17.3185,6.4885 nc=4
% at=(4.469, 3.5) wxgot=17.062
4.469 3.5 moveto
/Times-Italic 9.5 sf(r)s -0.351 k(ead)s
13 3 transform
grestore

/@exos-bcr-1 [ 4 2 roll itransform ] cvx def

% ARROWS

##b

0.7 setlinewidth
[2 2] 0 setdash
newpath

@bcr-disk-1 moveto
@bcr-disk-1 exch 20 add exch 20 sub
@bcr-disk-2 exch 20 sub exch
@bcr-disk-2 curveto
true true 0.8 thinarrowpath

@bcr-page-1 moveto
@bcr-page-1 exch 5 add exch 5 add
@bcr-page-2 5 sub
@bcr-page-2 curveto
true true 0.8 thinarrowpath

0.7 setlinewidth
[] 0 setdash

@fn-exos-1 moveto
@fn-exos-2 lineto
false true 1 thinarrowpath

@exos-bcr-1 3 sub moveto
@exos-bcr-1 40 sub
@exos-bcr-2 exch 40 sub exch
@exos-bcr-2 curveto
false true 1 thinarrowpath

gsave @exos-bcr-1 exch 4.2 sub exch 42 sub translate
%GenText -2 0 
% ``b''
% wx=4.75 bb=0.2185,-0.1045,4.4935,6.4885 nc=1
% at=(-2, 0) wxgot=4.75
-2 0 moveto
/Times-Italic 9.5 sf(b)s
grestore

1.5 #wid
@spec-page-1 moveto
@spec-page-1 exch 40 sub exch
@spec-page-2 50 add
@spec-page-2 curveto
true true 1.5 thinarrowpath


%%EndDocument
 @endspecial 2040 1180 a(Figure)14 b(1:)g(A)g(simpli\002ed)g(e)o(xok)o
(ernel)i(system)e(with)g(tw)o(o)g(applications,)h(each)2040
1263 y(link)o(ed)j(with)f(its)g(o)n(wn)h(libOS)f(and)h(sharing)g(pages)
g(through)h(a)e(b)o(uf)n(fer)h(cache)2040 1346 y(re)o(gistry)-5
b(.)2040 1595 y(such)21 b(as)f(processes)h(or)g(\002le)e(descriptors)i
(with)f(each)h(other)l(.)f(Thus,)g(VMMs)2040 1678 y(con\002ne)k
(specialized)g(operating)h(systems)f(and)g(associated)g(processes)g(to)
2040 1761 y(isolated)15 b(virtual)g(machines,)g(while)g(e)o(xok)o
(ernels)h(let)e(applications)i(use)f(cus\255)2040 1844
y(tomized)20 b(libOSes)e(without)h(sacri\002cing)g(a)g(single)g(vie)n
(w)g(of)g(the)g(machine,)2152 1927 y(Do)n(wnloading)29
b(code)f(into)f(the)g(k)o(ernel)g(is)g(another)h(approach)g(to)f(e)o
(x\255)2040 2010 y(tensibility)-5 b(.)19 b(In)g(man)o(y)h(systems)f
(only)h(trusted)f(users)h(can)f(do)n(wnload)i(code,)2040
2093 y(either)g(through)h(dynamically\255loaded)h(k)o(ernel)e(e)o
(xtensions)h(or)f(static)f(con\255)2040 2176 y(\002guration)29
b([13,)f(21].)g(In)g(the)g(SPIN)f(and)i(V)l(ino)f(systems,)g(an)o(y)h
(user)f(can)2040 2259 y(safely)21 b(do)n(wnload)h(code)g(into)e(the)h
(k)o(ernel)g([4)q(,)f(39].)g(Safe)h(do)n(wnloading)h(of)2040
2342 y(code)12 b(through)g(type\255safety)g([4)s(,)g(37])g(and)g(softw)
o(are)g(f)o(ault\255isolation)g([39)r(,)g(42])2040 2425
y(is)23 b(complementary)h(to)f(the)g(e)o(xok)o(ernel)h(approach)g(of)f
(separating)h(protec\255)2040 2508 y(tion)19 b(from)h(management.)g
(Exok)o(ernels)h(use)e(do)n(wnloading)i(of)f(code)g(to)f(let)2040
2591 y(the)g(k)o(ernel)h(lea)o(v)o(e)e(decisions)i(to)f(untrusted)h
(softw)o(are)f([11)q(].)2152 2674 y(In)g(addition)g(to)g(these)f
(structural)h(approaches,)h(much)f(w)o(ork)h(has)f(been)2040
2757 y(done)33 b(on)f(better)g(OS)f(abstractions)h(that)f(gi)n(v)o(e)i
(more)f(control)g(to)f(appli\255)2040 2840 y(cations,)h(such)g(as)f
(user)o(\255le)n(v)o(el)g(netw)o(orking)i([40,)e(41)q(],)f(lottery)h
(schedul\255)2040 2923 y(ing)e([43)q(],)f(application\255controlled)i
(virtual)f(memory)h([22,)f(27])g(and)g(\002le)2040 3006
y(systems)19 b([6,)g(35].)f(All)g(of)h(this)f(w)o(ork)h(is)g(directly)f
(applicable)i(to)e(libOSes.)2040 3204 y Fr(3)91 b(Exok)o(er)o(nel)20
b(Backgr)n(ound)2152 3356 y Fq(This)15 b(section)g(brie\003y)g
(summarizes)h(the)f(e)o(xok)o(ernel)i(architecture.)e(Fig\255)2040
3439 y(ure)g(1)g(sho)n(ws)h(a)f(simpli\002ed)g(e)o(xok)o(ernel)h
(system)g(that)e(is)h(running)h(tw)o(o)f(appli\255)2040
3522 y(cations:)21 b(an)g(unmodi\002ed)h(UNIX)e(application)h(link)o
(ed)h(against)e(the)h(ExOS)2040 3605 y(libOS)j(and)i(a)f(specialized)h
(e)o(xok)o(ernel)h(application)f(using)f(its)g(o)n(wn)h(TCP)2040
3688 y(and)16 b(\002le)f(system)h(libraries.)f(Applications)i
(communicate)g(with)e(the)h(k)o(ernel)2040 3771 y(using)28
b(lo)n(w\255le)n(v)o(el)f(physical)h(names)g(\(e.g.,)e(block)i
(numbers\);)g(the)g(k)o(ernel)2040 3854 y(interf)o(ace)e(is)f(as)h
(close)g(to)f(the)h(hardw)o(are)g(as)g(possible.)g(LibOSes)e(handle)
2040 3937 y(higher)o(\255le)n(v)o(el)19 b(names)h(\(e.g.,)e(\002le)g
(descriptors\))i(and)f(supply)h(abstractions.)2152 4020
y(W)-6 b(e)18 b(brie\003y)g(describe)h(the)g(e)o(xok)o(ernel)h
(principles,)e(moti)n(v)n(ated)h(in)f([11)q(].)2040 4103
y(These)h(principles)h(illustrate)f(the)g(mechanics)h(of)f(e)o(xok)o
(ernel)i(systems)f(and)2040 4186 y(pro)o(vide)i(important)f(moti)n(v)n
(ation)g(for)g(man)o(y)g(design)h(decisions)f(discussed)2040
4269 y(later)g(in)h(this)f(paper)l(.)h(In)g(addition,)g(we)g(sho)n(w)g
(ho)n(w)g(the)g(principles)g(can)g(be)2040 4352 y(applied)e(and)f
(discuss)h(the)f(general)g(issue)h(of)e(protected)i(sharing.)2040
4541 y Fr(3.1)91 b(Exok)o(er)o(nel)20 b(principles)2040
4658 y Fq(The)27 b(goal)g(of)f(an)h(e)o(xok)o(ernel)h(is)e(to)h(gi)n(v)
o(e)g(ef)n(\002cient)f(control)h(of)f(resources)2040
4741 y(to)19 b(untrusted)h(applications)g(in)f(a)g(secure,)h
(multi\255user)f(system.)g(W)-6 b(e)18 b(follo)n(w)2040
4824 y(these)h(principles)h(to)f(achie)n(v)o(e)g(this)g(goal:)2152
4907 y Fl(Separate)32 b(pr)o(otection)g(and)f(management.)h
Fq(Exok)o(ernels)h(pro)o(vide)2040 4990 y(primiti)n(v)o(es)f(at)f(the)h
(lo)n(west)g(possible)h(le)n(v)o(el)f(required)g(for)g(protection\227)
2040 5073 y(ideally)-5 b(,)28 b(at)g(the)f(le)n(v)o(el)h(of)g(hardw)o
(are)h(\(disk)f(blocks,)h(conte)o(xt)f(identi\002ers,)2040
5156 y(TLB,)20 b(etc.\).)g(Resource)j(management)f(is)f(restricted)g
(to)h(functions)g(neces\255)2040 5239 y(sary)17 b(for)f(protection:)h
(allocation,)g(re)n(v)o(ocation,)g(sharing,)g(and)g(the)g(tracking)2040
5322 y(of)i(o)n(wnership.)1922 5647 y(2)p eop
%%Page: 3 3
3 2 bop -40 -69 a Fl(Expose)27 b(allocation.)f Fq(Applications)h
(allocate)g(resources)g(e)o(xplicitly)-5 b(.)-152 14
y(The)20 b(k)o(ernel)g(allo)n(ws)f(speci\002c)h(resources)g(to)g(be)g
(requested)g(during)h(alloca\255)-152 97 y(tion.)-40
180 y Fl(Expose)h(names.)g Fq(Exok)o(ernels)h(use)g(physical)f(names)h
(where)n(v)o(er)f(pos\255)-152 263 y(sible.)16 b(Physical)g(names)h
(capture)g(useful)f(information)h(and)g(do)g(not)f(require)-152
346 y(potentially)k(costly)f(or)g(race\255prone)h(translations)f(from)g
(virtual)g(names.)-40 429 y Fl(Expose)27 b(r)o(e)o(v)o(ocation.)f
Fq(Exok)o(ernels)i(e)o(xpose)f(re)n(v)o(ocation)g(policies)g(to)-152
512 y(applications.)e(The)o(y)e(let)h(applications)g(choose)h(which)f
(instance)h(of)e(a)h(re\255)-152 596 y(source)19 b(to)f(gi)n(v)o(e)h
(up.)f(Each)h(application)g(has)f(control)h(o)o(v)o(er)f(its)g(set)g
(of)g(phys\255)-152 679 y(ical)h(resources.)-40 762 y
Fl(Expose)13 b(inf)n(ormation.)g Fq(Exok)o(ernels)h(e)o(xpose)g(all)f
(system)g(information)-152 845 y(and)25 b(collect)e(data)h(that)g
(applications)g(cannot)h(easily)e(deri)n(v)o(e)i(locally)-5
b(.)23 b(F)o(or)-152 928 y(e)o(xample,)f(applications)g(can)f
(determine)h(ho)n(w)f(man)o(y)h(hardw)o(are)g(netw)o(ork)-152
1011 y(b)o(uf)n(fers)27 b(there)g(are)g(or)g(which)g(pages)g(cache)h
(\002le)e(blocks.)h(An)g(e)o(xok)o(ernel)-152 1094 y(might)g(also)f
(record)h(an)g(approximate)h(least\255recently\255used)f(ordering)h(of)
-152 1177 y(all)33 b(physical)h(pages,)g(something)h(indi)n(vidual)f
(applications)h(cannot)f(do)-152 1260 y(without)19 b(global)h
(information.)-40 1343 y(These)f(principles)f(apply)h(not)g(just)e(to)h
(the)h(k)o(ernel,)f(b)o(ut)g(to)g(an)o(y)h(compo\255)-152
1426 y(nent)k(of)g(an)g(e)o(xok)o(ernel)h(system.)e(Pri)n(vile)o(ged)h
(serv)o(ers)f(should)i(pro)o(vide)f(an)-152 1509 y(interf)o(ace)d
(boiled)f(do)n(wn)h(to)f(just)f(what)h(is)g(required)h(for)e
(protection.)-152 1698 y Fr(3.2)91 b(K)n(er)o(nel)21
b(support)g(f)n(or)h(pr)n(otected)g(abstractions)-152
1815 y Fq(Man)o(y)27 b(of)f(the)g(resources)h(protected)f(by)h
(traditional)e(operating)i(systems)-152 1898 y(are)e(themselv)o(es)h
(high\255le)n(v)o(el)f(abstractions.)h(Files,)d(for)i(instance,)g
(consist)-152 1981 y(of)e(metadata,)g(disk)g(blocks,)g(and)g(b)o(uf)n
(fer)g(cache)g(pages,)h(all)e(of)h(which)g(are)-152 2064
y(guarded)e(by)e(access)g(control)g(on)h(high\255le)n(v)o(el)f(\002le)f
(objects.)h(While)f(e)o(xok)o(er)o(\255)-152 2147 y(nels)23
b(allo)n(w)g(direct)g(access)g(to)g(lo)n(w\255le)n(v)o(el)g(resources,)
h(e)o(xok)o(ernel)g(systems)-152 2230 y(must)14 b(be)f(able)g(to)h(pro)
o(vide)g(UNIX\255lik)o(e)e(protection,)i(including)g(access)g(con\255)
-152 2313 y(trol)26 b(on)g(high\255le)n(v)o(el)g(objects)h(where)f
(required)g(for)g(security)-5 b(.)26 b(One)g(of)g(the)-152
2396 y(main)18 b(challenges)h(in)f(designing)h(e)o(xok)o(ernels)g(is)e
(to)h(\002nd)g(k)o(ernel)g(interf)o(aces)-152 2479 y(that)23
b(allo)n(w)f(such)h(higher)o(\255le)n(v)o(el)g(access)f(control)h
(without)g(either)f(mandat\255)-152 2562 y(ing)e(a)f(particular)h
(implementation)g(or)g(hindering)g(application)h(control)f(of)-152
2645 y(hardw)o(are)g(resources.)-40 2728 y(Xok)g(meets)f(this)g
(challenge)h(with)f(three)g(design)h(techniques.)h(First,)c(it)-152
2811 y(performs)22 b(access)h(control)f(on)g(all)f(resources)i(in)e
(the)h(same)g(manner)l(.)g(Sec\255)-152 2894 y(ond,)15
b(Xok)g(pro)o(vides)g(softw)o(are)g(abstractions)g(to)f(bind)h(hardw)o
(are)h(resources)-152 2977 y(together)l(.)21 b(F)o(or)f(e)o(xample,)i
(as)e(sho)n(wn)i(in)f(Figure)f(1,)h(the)g(Xok)g(b)o(uf)n(fer)g(cache)
-152 3060 y(re)o(gistry)f(binds)h(disk)f(blocks)h(to)f(the)h(memory)f
(pages)h(caching)h(them.)e(Ap\255)-152 3143 y(plications)26
b(ha)o(v)o(e)g(control)g(o)o(v)o(er)g(physical)g(pages)h(and)f(disk)g
(I/O,)f(b)o(ut)g(can)-152 3226 y(also)d(safely)f(use)h(each)g(other')l
(s)f(cached)i(pages.)f(Xok')l(s)f(protection)h(mech\255)-152
3309 y(anism)h(guarantees)h(that)e(a)g(process)i(can)f(only)g(access)g
(a)f(cache)h(page)g(if)f(it)-152 3392 y(has)17 b(the)g(same)g(le)n(v)o
(el)g(of)g(access)g(to)g(the)g(corresponding)i(disk)e(block.)g(Third,)
-152 3475 y(and)29 b(most)f(general,)g(some)g(of)g(Xok')l(s)g
(abstractions)g(allo)n(w)g(applications)-152 3558 y(to)23
b(do)n(wnload)i(code.)e(This)f(is)h(required)g(for)g(abstractions)h
(whose)f(protec\255)-152 3641 y(tion)18 b(does)h(not)f(map)h(to)f
(hardw)o(are)h(abstractions.)f(F)o(or)f(e)o(xample,)i(\002les)e(may)
-152 3724 y(require)j(v)n(alid)f(updates)h(to)f(their)f(modi\002cation)
i(times.)-40 3807 y(The)28 b(k)o(e)o(y)h(to)f(these)h(e)o(xok)o(ernel)g
(softw)o(are)g(abstractions)g(is)e(that)h(the)o(y)-152
3890 y(neither)e(hinder)g(lo)n(w\255le)n(v)o(el)g(access)g(to)f(hardw)o
(are)h(resources)h(nor)e(unduly)-152 3973 y(restrict)33
b(the)h(semantics)h(of)f(the)g(protected)g(abstractions)h(the)o(y)f
(enable.)-152 4056 y(Gi)n(v)o(en)11 b(these)g(properties,)g(a)g(k)o
(ernel)g(softw)o(are)g(ab)q(straction)g(d)q(oes)h(not)f(v)q(iolate)-152
4139 y(the)19 b(e)o(xok)o(ernel)i(principles.)-40 4222
y(Though)38 b(these)g(softw)o(are)f(abstractions)g(reside)g(in)g(the)g
(k)o(ernel)g(on)-152 4305 y(Xok,)22 b(the)o(y)f(could)h(also)g(be)g
(implemented)g(in)f(trusted)g(user)o(\255le)n(v)o(el)h(serv)o(ers.)-152
4388 y(This)e(microk)o(ernel)h(or)o(ganization)g(w)o(ould)f(cost)h(man)
o(y)f(additional)h(conte)o(xt)-152 4471 y(switches;)f(these)g(are)f
(particularly)h(e)o(xpensi)n(v)o(e)h(on)f(the)g(Intel)g(Pentium)f(Pro)
-152 4554 y(processors)h(on)f(which)g(Xok)g(runs.)g(Furthermore,)g
(partitioning)g(function\255)-152 4637 y(ality)g(in)g(user)o(\255le)n
(v)o(el)f(serv)o(ers)i(tends)f(to)g(be)g(more)g(comple)o(x.)-152
4826 y Fr(3.3)91 b(Pr)n(otected)21 b(sharing)-152 4943
y Fq(The)i(lo)n(w\255le)n(v)o(el)g(e)o(xok)o(ernel)h(interf)o(ace)f(gi)
n(v)o(es)g(libOSes)f(enough)j(hardw)o(are)-152 5026 y(control)e(to)g
(implement)g(all)f(traditional)g(operating)h(system)g(abstractions.)
-152 5109 y(Library)30 b(implementations)h(of)f(abstractions)h(ha)o(v)o
(e)f(the)g(adv)n(antage)i(that)-152 5192 y(the)o(y)24
b(can)f(trust)g(the)g(applications)h(the)o(y)g(link)f(with)f(and)i
(need)g(not)g(defend)-152 5275 y(against)17 b(malicious)g(use.)g(The)f
(\003ip)g(side,)h(ho)n(we)n(v)o(er)m(,)g(is)g(that)f(a)h(libOS)f
(cannot)2040 -69 y(necessarily)29 b(trust)f(all)f(other)i(libOSes)e
(with)h(access)g(to)g(a)h(particular)f(re\255)2040 14
y(source.)16 b(When)f(libOSes)g(guarantee)h(in)m(v)n(ariants)g(about)g
(their)f(abstractions,)2040 97 y(the)o(y)23 b(must)f(be)g(a)o(w)o(are)h
(of)f(e)o(xactly)h(which)f(resources)i(are)e(in)m(v)o(olv)o(ed,)g(what)
2040 180 y(other)k(processes)g(ha)o(v)o(e)f(access)h(to)f(those)h
(resources,)f(and)h(what)f(le)n(v)o(el)g(of)2040 263
y(trust)19 b(the)o(y)g(place)g(in)g(those)g(other)h(processes.)2152
346 y(As)15 b(an)g(e)o(xample,)g(consider)g(the)g(semantics)g(of)g(the)
g(UNIX)f(fork)h(system)2040 429 y(call.)i(It)g(spa)o(wns)g(a)h(ne)n(w)f
(process)i(initially)d(identical)i(to)f(the)g(currently)h(run\255)2040
512 y(ning)j(one.)g(This)g(in)m(v)o(olv)o(es)g(cop)o(ying)h(the)f
(entire)f(virtual)h(address)g(space)g(of)2040 596 y(the)15
b(parent)g(process,)h(a)e(task)h(operating)h(systems)f(typically)g
(perform)h(lazily)2040 679 y(through)33 b(cop)o(y\255on\255write)f(to)g
(a)o(v)o(oid)f(unnecessary)i(page)f(copies.)g(While)2040
762 y(cop)o(y\255on\255write)f(can)g(al)o(w)o(ays)f(be)h(done)f(in)g(a)
g(trusted,)g(in\255k)o(ernel)h(virtual)2040 845 y(memory)17
b(system,)g(a)f(libOS)f(must)i(e)o(x)o(ercise)f(care)h(to)f(a)o(v)o
(oid)g(compromising)2040 928 y(the)g(semantics)g(of)f(fork)h(when)g
(sharing)g(pages)h(with)e(potentially)h(untrusted)2040
1011 y(processes.)f(This)f(section)g(details)g(some)g(of)g(the)h
(approaches)g(we)f(ha)o(v)o(e)h(used)2040 1094 y(to)h(allo)n(w)g(a)f
(libOS)h(to)f(maintain)h(in)m(v)n(ariants)h(when)f(sharing)h(resources)
g(with)2040 1177 y(other)i(libOSes.)2152 1260 y(The)28
b(e)o(xok)o(ernel)i(pro)o(vides)f(four)f(mechanisms)i(libOSes)d(can)i
(use)f(to)2040 1343 y(maintain)c(in)m(v)n(ariants)h(in)e(shared)i
(abstractions.)f(First,)e Fp(softwar)m(e)j(r)m(e)m(gions)p
Fq(,)2040 1426 y(areas)g(of)f(memory)h(that)g(can)g(only)g(be)f(read)h
(or)g(written)e(through)j(system)2040 1509 y(calls,)d(pro)o(vide)i
(sub\255page)g(protection)f(and)g(f)o(ault)g(isolation.)f(Second,)h
(the)2040 1592 y(e)o(xok)o(ernel)18 b(allo)n(ws)e(on)h
(the\255\003y\255creation)g(of)f Fp(hier)o(ar)m(c)o(hically\255named)i
(capa\255)2040 1675 y(bilities)27 b Fq(and)h(requires)g(that)f(these)g
(capabilities)h(be)g(speci\002ed)f(e)o(xplicitly)2040
1758 y(on)32 b(each)g(system)f(call)g([31].)g(Thus,)g(a)g(b)o(uggy)h
(child)g(process)g(acciden\255)2040 1841 y(tally)e(requesting)h(write)f
(access)h(to)f(a)g(page)h(or)f(softw)o(are)h(re)o(gion)g(of)f(its)2040
1924 y(parent)23 b(will)e(lik)o(ely)h(pro)o(vide)i(the)e(wrong)h
(capability)f(and)h(be)g(denied)g(per)o(\255)2040 2007
y(mission.)j(Third,)f(the)h(e)o(xok)o(ernel)h(pro)o(vides)g
Fp(wak)o(eup)g(pr)m(edicates)p Fq(:)g(small,)2040 2090
y(k)o(ernel\255do)n(wnloaded)33 b(functions)e(that)f(w)o(ak)o(e)h(up)f
(processes)h(when)g(arbi\255)2040 2173 y(trary)21 b(conditions)h
(become)g(true)f(\(see)g(Section)f(5.1)h(for)g(details\).)f(W)-6
b(ak)o(eup)2040 2256 y(predicates)18 b(can)g(ensure)g(that)f(a)h(b)o
(uggy)g(or)g(crashed)g(process)g(will)f(not)g(hang)2040
2339 y(a)g(correctly)h(beha)o(v)o(ed)h(one.)e(F)o(ourth,)g(the)h(e)o
(xok)o(ernel)g(pro)o(vides)h(rob)o(ust)e(crit\255)2040
2422 y(ical)i(sections:)h(ine)o(xpensi)n(v)o(e)h(critical)e(sections)h
(that)f(are)g(implemented)i(by)2040 2505 y(disabling)h(softw)o(are)g
(interrupts)f([3)q(].)f(Using)i(critical)f(sections)h(instead)f(of)2040
2588 y(locks)f(eliminates)e(the)h(need)h(to)f(trust)f(other)i
(processes.)2152 2671 y(Three)g(le)n(v)o(els)g(of)g(trust)g(determine)g
(what)g(optimizations)h(can)f(be)h(used)2040 2754 y(by)e(the)g
(implementation)h(of)f(a)g(shared)h(abstraction.)2152
2837 y Fl(Optimize)h(f)n(or)h(the)f(common)h(case:)g(Mutual)d(trust.)i
Fq(It)g(is)g(often)g(the)2040 2920 y(case)12 b(that)g(applications)g
(sharing)g(resources)g(place)g(a)g(considerab)q(le)g(amoun)q(t)2040
3003 y(of)18 b(trust)f(in)g(each)h(other)l(.)f(F)o(or)g(instance,)h(an)
o(y)g(tw)o(o)g(UNIX)f(programs)h(run)g(by)2040 3086 y(the)i(same)h
(user)f(can)h(arbitrarily)e(modify)i(each)g(others')f(memory)h(through)
2040 3169 y(the)28 b(deb)o(ugger)h(system)f(call,)f(ptrace.)h(When)g
(tw)o(o)g(e)o(xok)o(ernel)h(processes)2040 3252 y(can)19
b(write)e(each)i(others')f(memory)-5 b(,)18 b(their)g(libOSes)g(can)g
(clearly)g(trust)g(each)2040 3335 y(other)e(not)g(to)g(be)g(malicious.)
g(This)g(reduces)g(the)g(problem)h(of)f(guaranteeing)2040
3418 y(in)m(v)n(ariants)j(from)g(one)g(of)f(security)h(to)f(one)i(of)e
(f)o(ault\255isolation,)g(and)i(conse\255)2040 3501 y(quently)26
b(allo)n(ws)e(libOS)g(code)h(to)g(resemble)g(that)f(of)g(monolithic)i
(k)o(ernels)2040 3584 y(implementing)20 b(the)f(same)g(abstraction.)
2152 3667 y Fl(Unidir)o(ectional)i(trust.)h Fq(Another)i(common)g
(scenario)g(occurs)g(when)2040 3750 y(tw)o(o)18 b(processes)i(share)f
(resources)g(and)g(one)g(trusts)f(the)g(other)m(,)g(b)o(ut)g(the)h
(trust)2040 3833 y(is)13 b(not)g(mutual.)f(Netw)o(ork)i(serv)o(ers)f
(often)g(follo)n(w)g(this)f(or)o(ganization:)h(a)g(pri)n(v\255)2040
3916 y(ile)o(ged)22 b(process)h(accepts)f(netw)o(ork)h(connections,)g
(forks,)f(and)g(then)h(drops)2040 3999 y(pri)n(vile)o(ges)h(to)g
(perform)g(actions)g(on)g(behalf)h(of)e(a)h(particular)g(user)l(.)f
(Man)o(y)2040 4082 y(abstractions)g(implemented)g(for)f(mutual)g(trust)
g(can)g(also)h(function)f(under)2040 4165 y(unidirectional)c(trust)e
(with)g(only)i(slight)e(modi\002cation.)h(In)g(the)g(e)o(xample)g(of)
2040 4248 y(cop)o(y\255on\255write,)24 b(for)e(instance,)h(the)g
(trusted)g(parent)g(process)h(must)e(retain)2040 4332
y(e)o(xclusi)n(v)o(e)e(control)g(of)f(shared)h(pages)g(and)g(its)f(o)n
(wn)h(page)g(tables,)f(pre)n(v)o(ent\255)2040 4415 y(ing)i(a)g(child)g
(from)g(child)g(making)h(copied)f(pages)h(writable)f(in)f(the)h
(parent.)2040 4498 y(While)j(this)g(requires)h(more)f(page)i(f)o(aults)
e(in)g(the)h(parent,)f(it)g(does)h(not)g(in\255)2040
4581 y(crease)19 b(the)f(number)i(of)e(page)h(copies)g(or)g(seriously)f
(complicate)h(the)g(code.)2152 4664 y Fl(Defensi)o(v)o(e)29
b(pr)o(ogramming)h(f)n(or)f(mutual)f(distrust.)f Fq(Finally)-5
b(,)28 b(there)2040 4747 y(are)15 b(situations)g(where)g(mutually)g
(distrustful)g(processes)h(must)f(share)g(high\255)2040
4830 y(le)n(v)o(el)20 b(abstractions)g(with)g(each)g(other)l(.)g(F)o
(or)f(instance,)h(tw)o(o)g(unrelated)g(pro\255)2040 4913
y(cesses)f(may)g(wish)g(to)f(communicate)i(o)o(v)o(er)f(a)g(UNIX)f
(domain)h(sock)o(et,)h(and)2040 4996 y(neither)c(may)h(ha)o(v)o(e)f(an)
o(y)h(trust)e(in)h(the)h(other)l(.)e(F)o(or)h(OS)f(abstractions)i(that)
f(can)2040 5079 y(be)23 b(shared)g(by)g(mutually)f(distrustful)g
(processes,)i(libOSes)d(must)i(include)2040 5162 y(defensi)n(v)o(e)29
b(implementations)f(that)g(gi)n(v)o(e)g(reasonable)h(interpretations)e
(to)2040 5245 y(all)g(possible)i(actions)f(by)g(the)g(foreign)g
(process)h(\(for)e(instance)i(a)e(sock)o(et)2040 5328
y(write)18 b(lar)o(ger)h(than)g(the)g(b)o(uf)n(fer)g(can)g(be)h
(interpreted)f(as)g(an)g(end)h(of)f(\002le\).)1922 5647
y(3)p eop
%%Page: 4 4
4 3 bop -40 -69 a Fq(F)o(ortunately)-5 b(,)36 b(sharing)h(with)f
(mutual)g(distrust)g(occurs)h(v)o(ery)f(infre\255)-152
14 y(quently)27 b(for)e(man)o(y)i(abstractions.)f(Man)o(y)g(types)h(of)
e(sharing)i(occur)f(only)-152 97 y(between)17 b(child)f(and)h(parent)g
(processes,)g(where)f(mutual)h(or)f(unidirectional)-152
180 y(trust)f(almost)h(al)o(w)o(ays)g(holds.)g(Where)g(mutual)f
(distrust)h(does)g(occur)m(,)g(defen\255)-152 263 y(si)n(v)o(e)g
(sanity)g(checks)g(are)g(often)f(not)h(on)g(the)g(critical)e(path)i
(for)g(performance.)-152 346 y(In)f(the)f(remaining)h(cases,)f(as)g(is)
g(the)g(case)h(for)f(disk)h(\002les,)e(we)h(ha)o(v)o(e)g(carefully)-152
429 y(crafted)27 b(k)o(ernel)g(softw)o(are)g(abstractions)g(to)f(help)h
(libOSes)f(maintain)h(the)-152 512 y(necessary)20 b(in)m(v)n(ariants.)
-152 743 y Fr(4)91 b(Multiplexing)24 b(Stable)e(Storage)-152
903 y Fq(An)14 b(e)o(xok)o(ernel)h(must)f(pro)o(vide)g(a)g(means)g(to)f
(safely)h(multiple)o(x)g(disks)f(among)-152 986 y(multiple)20
b(library)g(\002le)f(systems)h(\(libFSes\).)e(Each)i(libOS)f(contains)i
(one)g(or)-152 1069 y(more)g(libFSes.)d(Multiple)j(libFSes)e(can)h(be)h
(used)f(to)g(share)h(the)f(same)g(\002les)-152 1153 y(with)33
b(dif)n(ferent)g(semantics.)g(In)f(addition)i(to)f(accessing)h(e)o
(xisting)f(\002les,)-152 1236 y(libFSes)24 b(can)i(de\002ne)f(ne)n(w)g
(on\255disk)h(\002le)e(types)i(with)e(arbitrary)h(metadata)-152
1319 y(formats.)20 b(An)h(e)o(xok)o(ernel)g(must)g(gi)n(v)o(e)f
(libFSes)g(as)g(much)h(control)g(o)o(v)o(er)f(\002le)-152
1402 y(management)26 b(as)d(possible)h(while)g(still)e(protecting)j
(\002les)e(from)g(unautho\255)-152 1485 y(rized)k(access.)g(It)f
(therefore)h(cannot)g(rely)f(on)h(simple\255minded)h(solutions)-152
1568 y(lik)o(e)17 b(partitioning)h(to)e(multiple)o(x)h(a)g(disk:)g
(each)h(\002le)e(w)o(ould)i(require)f(its)f(o)n(wn)-152
1651 y(partition.)-40 1734 y(T)-6 b(o)32 b(allo)n(w)g(libFSes)f(to)h
(perform)g(their)g(o)n(wn)h(\002le)e(management,)i(an)-152
1817 y(e)o(xok)o(ernel)i(stable)e(storage)g(system)g(must)g(satisfy)g
(four)g(requirements.)-152 1900 y(First,)23 b(creating)h(ne)n(w)h
(\002le)e(formats)h(should)h(be)f(simple)g(and)h(lightweight.)-152
1983 y(It)f(should)g(not)g(require)h(an)o(y)f(special)g(pri)n(vile)o
(ge.)g(Second,)g(the)g(protection)-152 2066 y(substrate)g(should)f
(allo)n(w)g(multiple)g(libFSes)f(to)h(safely)g(share)g(\002les)f(at)h
(the)-152 2149 y(ra)o(w)13 b(disk)g(block)g(and)h(metadata)f(le)n(v)o
(el.)f(Third,)g(the)h(storage)g(system)h(must)e(be)-152
2232 y(ef)n(\002cient\227as)g(close)g(to)g(ra)o(w)g(hardw)o(are)g
(performance)g(as)g(possible.)g(F)o(ourth,)-152 2315
y(the)23 b(storage)h(system)f(should)h(f)o(acilitate)e(cache)i(sharing)
g(among)g(libFSes,)-152 2398 y(and)33 b(allo)n(w)e(them)h(to)g(easily)f
(address)i(problems)f(of)g(cache)g(coherence,)-152 2481
y(security)-5 b(,)19 b(and)h(concurrenc)o(y)-5 b(.)-40
2564 y(This)15 b(section)g(describes)g(ho)n(w)g(Xok)g(multiple)o(x)o
(es)g(stable)f(storage,)h(both)-152 2647 y(to)21 b(sho)n(w)h(ho)n(w)g
(we)f(address)h(these)f(problems)h(and)g(to)f(pro)o(vide)h(a)f
(concrete)-152 2730 y(e)o(xample)i(of)f(the)g(e)o(xok)o(ernel)h
(principles)f(in)g(practice.)g(First,)e(we)i(describe)-152
2813 y(XN,)29 b(Xok')l(s)h(e)o(xtensible,)f(lo)n(w\255le)n(v)o(el)h
(in\255k)o(ernel)g(stable)g(storage)g(system.)-152 2896
y(W)-6 b(e)29 b(also)h(describe)h(the)e(general)i(interf)o(ace)f
(between)g(XN)f(and)i(libFSes)-152 2979 y(and)e(present)f(one)g
(particular)f(libFS,)f(C\255FFS,)g(the)h(co\255locating)i(f)o(ast)e
(\002le)-152 3062 y(system)20 b([15].)-152 3284 y Fr(4.1)91
b(Ov)o(er)o(view)21 b(of)i(XN)-152 3418 y Fq(Designing)31
b(a)e(\003e)o(xible)g(e)o(xok)o(ernel)i(stable)f(storage)g(system)g
(has)g(pro)o(v)o(en)-152 3501 y(dif)n(\002cult:)14 b(XN)f(is)h(our)g
(fourth)h(design.)f(This)g(section)h(pro)o(vides)g(an)f(o)o(v)o(ervie)n
(w)-152 3584 y(of)26 b(UDFs,)f(the)i(cornerstone)g(of)f(XN;)g(the)g
(follo)n(wing)g(sections)h(describe)-152 3667 y(some)22
b(earlier)f(approaches)j(\(and)e(why)f(the)o(y)h(f)o(ailed\),)f(and)h
(aspects)g(of)g(XN)-152 3750 y(in)d(greater)g(depth.)-40
3833 y(XN)e(pro)o(vides)i(access)f(to)f(stable)h(storage)g(at)f(the)g
(le)n(v)o(el)h(of)f(disk)h(blocks,)-152 3916 y(e)o(xporting)32
b(a)f(b)o(uf)n(fer)f(cache)i(re)o(gistry)f(\(Section)f(4.3.3\))h(as)g
(well)f(as)h(free)-152 3999 y(maps)25 b(and)f(other)g(on\255disk)h
(structures.)f(The)g(main)g(purpose)h(of)f(XN)f(is)h(to)-152
4082 y(determine)32 b(the)f(access)h(rights)f(of)g(a)f(gi)n(v)o(en)i
(principal)g(to)f(a)f(gi)n(v)o(en)i(disk)-152 4165 y(block)23
b(as)f(ef)n(\002ciently)f(as)h(possible.)g(XN)f(must)h(pre)n(v)o(ent)h
(a)e(malicious)h(user)-152 4248 y(from)i(claiming)h(another)g(user')l
(s)f(disk)g(blocks)h(as)f(part)g(of)g(her)g(o)n(wn)h(\002les.)-152
4331 y(On)34 b(a)g(con)m(v)o(entional)h(OS,)d(this)i(task)f(is)h(easy)
-5 b(,)34 b(since)f(the)h(k)o(ernel)g(itself)-152 4414
y(kno)n(ws)17 b(the)f(\002le')l(s)f(metadata)h(format.)g(On)g(an)g(e)o
(xok)o(ernel,)h(where)f(\002les)f(ha)o(v)o(e)-152 4497
y(application\255de\002ned)21 b(metadata)e(layouts,)h(the)f(task)g(is)f
(more)h(dif)n(\002cult.)-40 4580 y(XN')l(s)31 b(no)o(v)o(el)h(solution)
g(emplo)o(ys)g Fp(UDFs)f Fq(\()p Fp(untrusted)h(deterministic)-152
4663 y(functions)p Fq(\).)16 b(UDFs)e(are)h(metadata)h(translation)f
(functions)h(speci\002c)f(to)g(each)-152 4746 y(\002le)23
b(type.)h(XN)g(uses)g(UDFs)f(to)h(analyze)h(metadata)f(and)h(translate)
e(it)h(into)-152 4829 y(a)j(simple)g(form)g(the)g(k)o(ernel)h
(understands.)h(A)d(libFS)g(de)n(v)o(eloper)i(can)g(in\255)-152
4912 y(stall)k(UDFs)f(to)h(introduce)h(ne)n(w)g(on\255disk)g(metadata)f
(formats.)g(The)g(re\255)-152 4995 y(stricted)17 b(language)i(in)f
(which)f(UDFs)g(are)h(speci\002ed)f(ensures)i(that)e(the)o(y)h(are)-152
5078 y(deterministic\227their)j(output)i(depends)g(only)f(on)g(their)f
(input)h(\(the)g(meta\255)-152 5161 y(data)g(itself\).)e(UDFs)g(allo)n
(w)i(the)f(k)o(ernel)h(to)f(safely)h(and)f(ef)n(\002ciently)h(handle)
-152 5244 y(an)o(y)e(metadata)f(layout)h(without)f(understanding)i(the)
e(layout)g(itself.)2152 -69 y(UDFs)27 b(are)h(stored)g(on)g(disk)g(in)g
(structures)g(called)g Fp(templates.)f Fq(Each)2040 14
y(template)j(corresponds)h(to)e(a)h(particular)f(metadata)h(format;)g
(for)f(e)o(xam\255)2040 97 y(ple,)j(a)h(UNIX)f(\002le)g(system)h(w)o
(ould)g(ha)o(v)o(e)g(templates)g(for)f(data)h(blocks,)2040
180 y(inode)19 b(blocks,)g(inodes,)g(indirect)g(blocks,)f(etc.)g(Each)h
(template)f Fk(T)29 b Fq(has)19 b(one)2040 263 y(UDF:)d
Fp(owns\255udf)2500 271 y Fj(T)2550 263 y Fq(,)g(and)i(tw)o(o)f
(untrusted)h(b)o(ut)f(potentially)g(nondeterminis\255)2040
346 y(tic)f(functions:)h Fp(acl\255uf)2620 354 y Fj(T)2685
346 y Fq(and)g Fp(size\255uf)3004 354 y Fj(T)3053 346
y Fq(.)f(All)g(three)g(functions)i(are)e(speci\002ed)2040
429 y(in)28 b(the)f(same)h(language)h(b)o(ut)e(only)h
Fp(owns\255udf)3276 437 y Fj(T)3353 429 y Fq(must)g(be)g
(deterministic.)2040 512 y(The)17 b(other)h(tw)o(o)f(can)g(ha)o(v)o(e)h
(access)f(to,)g(for)g(e)o(xample,)h(the)f(time)g(of)g(day)-5
b(.)17 b(The)2040 596 y(limited)27 b(language)i(used)f(to)g(write)e
(these)i(functions)g(is)g(a)f(pseudo\255RISC)2040 679
y(assembly)f(language,)f(check)o(ed)i(by)e(the)f(k)o(ernel)i(to)e
(ensure)i(determinac)o(y)-5 b(.)2040 762 y(Once)19 b(a)g(template)g(is)
g(speci\002ed,)g(it)f(cannot)i(be)f(changed.)2152 845
y(F)o(or)g(a)h(piece)h(of)e(metadata)i Fk(m)e Fq(of)h(template)g(type)g
Fk(T)11 b Fq(,)19 b Fp(owns\255udf)3837 853 y Fj(T)3887
845 y Fi(\()p Fk(m)p Fi(\))2040 928 y Fq(returns)29 b(the)h(set)f(of)g
(blocks)h(which)f Fk(m)g Fq(points)g(to)g(and)h(their)f(respecti)n(v)o
(e)2040 1011 y(template)i(types.)g(UDF)f(determinism)h(guarantees)h
(that)f Fp(owns\255udf)g Fq(will)2040 1094 y(al)o(w)o(ays)j(compute)g
(the)f(same)h(output)g(for)f(a)g(gi)n(v)o(en)g(input:)h(XN)e(cannot)
2040 1177 y(be)i(spoofed)g(by)g Fp(owns\255udf)p Fq(.)g(The)f(set)g(of)
g(blocks)h Fp(owns\255udf)g Fq(returns)g(is)2040 1260
y(represented)e(as)f(a)g(set)g(of)g(tuples.)g(Each)g(tuple)h
(constitutes)f(a)g(range:)g(a)2040 1343 y(block)d(address)f(that)g
(speci\002es)g(the)g(start)f(of)h(the)g(range,)h(the)e(number)i(of)2040
1426 y(blocks)h(in)f(the)g(range,)g(and)h(the)f(template)g
(identi\002er)g(for)g(the)g(blocks)g(in)2040 1509 y(the)i(range.)f
(Because)i(o)n(wned)f(sets)f(can)h(be)g(lar)o(ge,)f(XN)g(allo)n(ws)g
(libFSes)2040 1592 y(to)22 b(partition)g(metadata)h(blocks)g(into)g
(disjoint)f(pieces)h(such)g(that)f(each)h(set)2040 1675
y(returned)d(is)e(\(typically\))h(a)g(single)g(tuple.)2152
1758 y(F)o(or)26 b(e)o(xample,)h(say)g(a)g(libFS)e(w)o(ants)i(to)g
(allocate)g(a)f(disk)h(block)h Fk(b)e Fq(by)2040 1841
y(placing)h(a)e(pointer)h(to)g(it)f(in)h(a)f(metadata)i(structure,)e
Fk(m)p Fq(.)g(The)h(libFS)e(will)2040 1924 y(call)16
b(XN,)g(passing)i(it)d Fk(m)p Fq(,)h Fk(b)p Fq(,)g(and)h(the)g
(proposed)h(modi\002cation)f(to)f Fk(m)g Fq(\(spec\255)2040
2007 y(i\002ed)33 b(as)f(a)h(list)f(of)h(bytes)g(to)g(write)f(into)h
Fk(m)p Fq(\).)f(T)-6 b(o)32 b(enforce)i(protection,)2040
2090 y(XN)21 b(needs)h(to)f(kno)n(w)h(that)f(the)h(libFS')l(s)d
(proposed)k(modi\002cation)f(actually)2040 2173 y(does)f(what)g(it)f
(says)g(it)g(does\227that)h(is,)f(allocates)h Fk(b)f
Fq(in)g Fk(m)p Fq(.)g(Thus,)g(XN)g(runs)2040 2256 y Fp(owns\255udf)2313
2264 y Fj(T)2363 2256 y Fi(\()p Fk(m)p Fi(\))p Fq(;)c(mak)o(es)h(the)g
(proposed)h(modi\002cation)f(on)g Fk(m)3703 2224 y Fh(0)3725
2256 y Fq(,)f(a)h(cop)o(y)g(of)2040 2339 y Fk(m)p Fq(;)j(and)h(runs)g
Fp(owns\255udf)2699 2347 y Fj(T)2748 2339 y Fi(\()p Fk(m)2855
2307 y Fh(0)2878 2339 y Fi(\))p Fq(.)f(It)g(then)h(v)o(eri\002es)f
(that)g(the)h(ne)n(w)g(result)f(is)2040 2422 y(equal)g(the)f(old)g
(result)f(plus)i Fk(b)p Fq(.)2152 2505 y(The)14 b Fp(acl\255uf)f
Fq(function)h(implements)g(template\255speci\002c)g(access)g(control)
2040 2588 y(and)22 b(semantics;)f(its)f(input)h(is)f(a)h(piece)g(of)g
(metadata,)g(a)g(proposed)i(modi\002\255)2040 2671 y(cation)17
b(to)g(that)f(metadata,)h(and)g(set)g(of)g(credentials)g(\(e.g.,)f
(capabilities\).)g(Its)2040 2754 y(output)26 b(is)e(a)h(Boolean)g(v)n
(alue)h(appro)o(ving)g(or)f(disappro)o(ving)h(of)f(the)g(mod\255)2040
2837 y(i\002cation.)f(XN)f(runs)i(the)f(proper)h Fp(acl\255uf)f
Fq(function)h(before)g(an)o(y)g(metadata)2040 2920 y(modi\002cation.)30
b Fp(acl\255uf)p Fq(s)g(can)g(implement)h(access)f(control)g(lists,)f
(as)h(well)2040 3003 y(as)20 b(pro)o(viding)h(certain)e(other)h
(guarantees;)h(for)f(e)o(xample,)g(an)g Fp(acl\255uf)g
Fq(could)2040 3086 y(ensure)25 b(that)e(inode)i(modi\002cation)g(times)
e(are)h(k)o(ept)h(current)f(by)g(rejecting)2040 3169
y(an)o(y)c(metadata)f(changes)h(that)f(do)g(not)h(update)g(them.)2152
3252 y(The)i Fp(size\255uf)h Fq(function)g(simply)f(returns)h(the)f
(size)g(of)g(a)h(data)f(structure)2040 3335 y(in)d(bytes.)2040
3557 y Fr(4.2)91 b(XN:)23 b(Pr)n(oblem)f(and)g(history)2040
3691 y Fq(The)15 b(most)h(dif)n(\002cult)f(requirement)h(for)g(XN)f(is)
g(ef)n(\002ciently)g(determining)h(the)2040 3774 y(access)k(rights)g
(of)f(a)g(gi)n(v)o(en)i(principal)e(to)h(a)f(gi)n(v)o(en)h(disk)g
(block.)g(W)-6 b(e)19 b(discuss)2040 3857 y(the)g(successi)n(v)o(e)h
(approaches)h(that)e(we)g(ha)o(v)o(e)g(pursued.)2152
3940 y Fl(Disk\255block\255le)o(v)o(el)28 b(multiplexing)o(.)e
Fq(One)j(approach)i(is)d(to)h(associate)2040 4023 y(with)24
b(each)h(block)h(or)e(e)o(xtent)h(a)g(capability)f(\(or)h(access)g
(control)g(list\))f(that)2040 4106 y(guards)17 b(it.)d(Unfortunately)-5
b(,)17 b(if)e(the)g(capability)h(is)f(spatially)h(separated)g(from)2040
4189 y(the)j(disk)h(block)g(\(e.g.,)e(stored)i(separately)f(in)g(a)h
(table\),)e(accessing)j(a)e(block)2040 4272 y(can)k(require)g(tw)o(o)g
(disk)g(accesses)g(\(one)g(to)g(fetch)g(the)f(capability)h(and)h(one)
2040 4355 y(to)h(fetch)g(the)g(block\).)h(While)e(caching)i(can)g
(mitigate)e(this)h(problem)h(to)e(a)2040 4438 y(de)o(gree,)d(we)g(are)g
(nerv)o(ous)h(about)f(its)g(o)o(v)o(erhead)h(on)f(disk\255intensi)n(v)o
(e)h(w)o(ork\255)2040 4521 y(loads.)c(An)g(alternati)n(v)o(e)g
(approach)i(is)d(to)h(co\255locate)h(capabilities)f(with)f(disk)2040
4604 y(blocks)f(by)f(placing)h(them)f(immediately)h(before)f(a)g(disk)h
(block')l(s)f(data)g([26)q(].)2040 4687 y(Unfortunately)-5
b(,)26 b(on)g(common)h(hardw)o(are,)f(reserving)g(space)g(for)g(a)f
(capa\255)2040 4770 y(bility)c(w)o(ould)i(pre)n(v)o(ent)f(blocks)h
(from)e(being)i(multiples)e(of)h(the)f(page)i(size,)2040
4853 y(adding)d(o)o(v)o(erhead)g(and)g(comple)o(xity)g(to)f(disk)g
(operations.)2152 4936 y Fl(Self\255descripti)o(v)o(e)c(metadata.)g
Fq(Our)g(\002rst)g(serious)g(attempt)h(at)f(ef)n(\002cient)2040
5019 y(disk)23 b(multiple)o(xing)f(pro)o(vided)i(a)e(means)h(for)f
(each)h(instance)g(of)f(metadata)2040 5102 y(to)e(describe)g(itself.)f
(F)o(or)g(e)o(xample,)h(a)g(disk)g(block)h(w)o(ould)f(start)g(with)f
(some)2040 5185 y(number)h(of)e(bytes)i(of)e(application\255speci\002c)
i(data)f(and)g(then)g(say)g(\223the)g(ne)o(xt)2040 5268
y(ten)33 b(inte)o(gers)g(are)f(disk)i(block)f(pointers.)-5
b(\224)33 b(The)f(comple)o(xity)i(of)f(space\255)2040
5351 y(ef)n(\002cient)18 b(self\255description)h(caused)h(us)f(to)f
(limit)f(what)i(metadata)g(could)g(be)1922 5647 y(4)p
eop
%%Page: 5 5
5 4 bop -152 -69 a Fq(described.)20 b(W)-6 b(e)18 b(disco)o(v)o(ered)i
(that)f(this)f(approach)i(both)g(caused)f(unaccept\255)-152
14 y(able)29 b(amounts)g(of)g(space)g(o)o(v)o(erhead)h(and)f(required)g
(e)o(xcessi)n(v)o(e)g(ef)n(fort)g(to)-152 97 y(modify)24
b(e)o(xisting)g(\002le)e(system)i(code,)g(because)g(it)f(w)o(as)g(dif)n
(\002cult)g(to)g(shoe\255)-152 180 y(horn)d(e)o(xisting)f(\002le)f
(system)i(data)f(structures)g(into)g(a)g(uni)n(v)o(ersal)g(format.)-40
263 y Fl(T)-7 b(emplate\255based)14 b(description.)e
Fq(Self\255description)h(and)i(its)e(problems)-152 346
y(were)26 b(eliminated)g(by)g(the)g(insight)g(that)f(each)h(\002le)f
(system)h(is)g(b)o(uilt)f(from)-152 429 y(only)g(a)g(handful)g(of)f
(dif)n(ferent)h(on\255disk)g(data)g(structures,)f(each)h(of)f(which)
-152 512 y(can)29 b(be)g(considered)g(a)g(type.)f(Since)g(the)g(number)
i(of)e(types)h(is)f(small,)f(it)-152 596 y(is)22 b(feasible)g(to)g
(describe)g(each)h(type)f(only)g(once)h(per)f(\002le)f
(system\227rather)-152 679 y(than)f(once)f(per)h(instance)f(of)g(a)g
(type\227using)h(a)f Fp(template)p Fq(.)-40 762 y(Originally)-5
b(,)24 b(templates)h(were)f(written)g(in)g(a)g(declarati)n(v)o(e)h
(description)-152 845 y(language)i(\(similar)d(to)h(that)g(used)h(in)f
(self\255descripti)n(v)o(e)g(metadata\))h(rather)-152
928 y(than)17 b(UDFs.)f(This)g(system)h(w)o(as)g(simple)f(and)i(better)
e(than)h(self\255descripti)n(v)o(e)-152 1011 y(metadata,)27
b(b)o(ut)f(still)f(e)o(xhibited)i(what)g(we)f(ha)o(v)o(e)g(come)h(to)f
(appreciate)i(as)-152 1094 y(an)34 b(indication)g(that)f(applications)h
(do)g(not)f(ha)o(v)o(e)h(enough)h(control:)f(the)-152
1177 y(system)f(made)f(too)g(man)o(y)h(tradeof)n(fs.)f(W)-6
b(e)31 b(had)i(to)f(mak)o(e)g(a)g(myriad)h(of)-152 1260
y(decisions)17 b(about)g(which)f(base)g(types)h(were)f(a)o(v)n(ailable)
g(and)g(ho)n(w)g(the)o(y)h(were)-152 1343 y(represented)23
b(\(ho)n(w)f(lar)o(ge)g(disk)g(block)h(pointers)f(could)g(be,)g(ho)n(w)
g(the)g(type)-152 1426 y(layout)17 b(could)g(change,)f(ho)n(w)h(e)o
(xtents)f(were)g(speci\002ed\).)g(Gi)n(v)o(en)g(the)g(v)n(ariety)-152
1509 y(of)23 b(on\255disk)g(data)g(structures)g(described)g(in)g(the)f
(\002le)g(system)h(literature,)e(it)-152 1592 y(seems)15
b(unlik)o(ely)h(that)f(an)o(y)g(\002x)o(ed)g(set)f(of)h(components)i
(will)d(e)n(v)o(er)h(be)g(enough)-152 1675 y(to)k(describe)h(all)e
(useful)h(metadata.)-40 1758 y(Our)24 b(current)h(solution)f(uses)g
(templates,)g(b)o(ut)g(trades)g(the)g(declarati)n(v)o(e)-152
1841 y(description)18 b(language)h(for)e(a)g(more)h(e)o(xpressi)n(v)o
(e,)g(interpreted)f(language\227)-152 1924 y(UDFs.)22
b(This)g(lets)g(libFSes)g(track)h(their)f(o)n(wn)h(access)h(rights)e
(without)h(XN)-152 2007 y(understanding)16 b(ho)n(w)e(the)o(y)g(do)g
(so;)f(XN)h(merely)f(v)o(eri\002es)h(that)f(libFSes)f(track)-152
2090 y(block)20 b(o)n(wnership)g(correctly)-5 b(.)-152
2312 y Fr(4.3)91 b(XN:)23 b(Design)f(and)g(implementation)-152
2446 y Fq(W)-6 b(e)31 b(\002rst)f(describe)i(the)f(requirements)h(for)g
(XN)e(and)i(then)g(present)g(the)-152 2529 y(design.)-152
2751 y Fr(4.3.1)90 b(Requir)n(ements)21 b(and)h(appr)n(oach)-152
2884 y Fq(In)33 b(our)h(e)o(xperience)g(so)f(f)o(ar)m(,)f(the)h(follo)n
(wing)h(requirements)g(ha)o(v)o(e)f(been)-152 2967 y(suf)n(\002cient)19
b(to)g(reconcile)h(application)f(control)h(with)e(protected)i(sharing.)
-58 3127 y(1.)37 b(T)-6 b(o)18 b(pre)n(v)o(ent)g(unauthorized)h
(access,)f(e)n(v)o(ery)h(operation)f(on)g(disk)g(data)35
3210 y(must)26 b(be)g(guarded.)g(F)o(or)f(speed,)i(XN)e(uses)h
Fp(secur)m(e)h(bindings)f Fq([11)q(])35 3293 y(to)e(mo)o(v)o(e)h
(access)g(checks)g(to)f(bind)h(time)e(rather)i(than)f(checking)i(at)35
3376 y(e)n(v)o(ery)f(access.)f(F)o(or)f(e)o(xample,)i(the)f(permission)
g(to)g(read)h(a)e(cached)35 3459 y(disk)18 b(block)h(is)e(check)o(ed)i
(when)g(the)e(page)i(is)e(inserted)h(into)g(the)g(page)35
3542 y(table)f(of)g(the)g(libFS')l(s)f(en)m(vironment,)i(rather)f(than)
h(on)g(e)n(v)o(ery)f(access.)-58 3685 y(2.)37 b(XN)25
b(must)h(be)g(able)g(to)g(determine)g(unambiguously)i(what)e(access)35
3768 y(rights)18 b(a)g(principal)g(has)g(to)g(a)g(gi)n(v)o(en)h(disk)f
(block.)g(F)o(or)g(speed,)g(it)f(uses)35 3851 y(the)j(UDF)f(mechanism)h
(to)g(protect)g(disk)g(blocks)g(using)g(the)g(libFS')l(s)35
3934 y(o)n(wn)g(metadata)f(rather)g(than)g(guarding)i(each)e(block)h
(indi)n(vidually)-5 b(.)-58 4076 y(3.)37 b(XN)25 b(must)h(guarantee)h
(that)f(disk)f(updates)i(are)f(ordered)g(such)h(that)35
4159 y(a)i(crash)g(will)f(not)i(incorrectly)f(grant)g(a)g(libFS)f
(access)h(to)g(data)g(it)35 4242 y(either)17 b(has)h(freed)f(or)g(has)h
(not)f(allocated.)g(This)g(requirement)h(means)35 4325
y(that)f(metadata)h(that)f(is)g(persistent)h(across)g(crashes)g(cannot)
g(be)g(writ\255)35 4409 y(ten)25 b(when)g(it)e(contains)i(pointers)g
(to)g(uninitialized)f(metadata,)h(and)35 4492 y(that)i(reallocation)g
(of)g(a)g(freed)g(block)g(must)g(be)h(delayed)f(until)g(all)35
4575 y(persistent)19 b(pointers)h(to)e(it)h(ha)o(v)o(e)g(been)h(remo)o
(v)o(ed.)-40 4734 y(While)k(isolation)h(allo)n(ws)f(separate)h(libFSes)
e(to)h(coe)o(xist)h(safely)-5 b(,)24 b(pro\255)-152 4817
y(tected)i(sharing)g(of)f(\002le)f(system)i(state)e(by)i(mutually)g
(distrustful)f(libFSes)-152 4900 y(requires)20 b(three)f(additional)g
(features:)-58 5059 y(1.)37 b(Coherent)17 b(caching)g(of)f(disk)g
(blocks.)h(Distrib)o(uted,)e(per)o(\255application)35
5142 y(disk)j(block)g(caches)h(create)e(a)h(consistenc)o(y)h(problem:)f
(if)f(tw)o(o)h(appli\255)35 5225 y(cations)23 b(obli)n(viously)g(cache)
g(the)f(same)h(disk)f(block)h(in)f(tw)o(o)g(dif)n(fer)o(\255)35
5308 y(ent)16 b(physical)g(pages,)g(then)g(modi\002cations)g(will)e
(not)i(be)g(shared.)g(XN)35 5391 y(solv)o(es)f(this)f(problem)h(with)e
(an)i(in\255k)o(ernel,)f(system\255wide,)h(protected)2227
-69 y(cache)25 b(re)o(gistry)f(that)f(maps)i(cached)g(disk)f(blocks)h
(to)f(the)g(physical)2227 14 y(pages)c(holding)g(them.)2133
156 y(2.)38 b(Atomic)32 b(metadata)g(updates.)h(Man)o(y)g(\002le)e
(system)h(updates)h(ha)o(v)o(e)2227 239 y(multiple)28
b(steps.)h(T)-6 b(o)28 b(ensure)h(that)g(shared)g(state)f(al)o(w)o(ays)
i(ends)f(up)2227 322 y(in)20 b(a)g(consistent)h(and)f(correct)h(state,)
e(libFSes)g(can)i(lock)g(cache)f(re)o(g\255)2227 405
y(istry)31 b(entries.)g(\(Future)g(w)o(ork)h(will)e(e)o(xplore)i
(optimistic)f(concur)o(\255)2227 488 y(renc)o(y)19 b(control)h(based)g
(on)f(v)o(ersioning.\))2133 630 y(3.)38 b(W)-6 b(ell\255formed)24
b(updates.)h(File)f(abstractions)h(abo)o(v)o(e)h(the)e(XN)g(inter)o
(\255)2227 713 y(f)o(ace)g(may)g(require)g(that)f(metadata)i
(modi\002cations)f(satisfy)f(in)m(v)n(ari\255)2227 796
y(ants)c(\(e.g.,)f(that)h(link)g(counts)h(in)e(inodes)i(match)g(the)f
(number)h(of)f(as\255)2227 879 y(sociated)c(directory)g(entries\).)e
(UDFs)h(allo)n(w)g(XN)g(to)g(guarantee)i(such)2227 962
y(in)m(v)n(ariants)e(in)f(a)g(\002le\255system\255speci\002c)g(manner)m
(,)h(allo)n(wing)g(mutually)2227 1045 y(distrustful)19
b(applications)g(to)g(safely)g(share)h(metadata.)2152
1201 y(XN)f(controls)i(only)f(what)g(is)f(necessary)i(to)e(enforce)i
(these)f(protection)2040 1284 y(rules.)e(All)f(other)h
(abilities\227I/O)e(initiation,)h(disk)h(block)h(layout)f(and)h
(allo\255)2040 1367 y(cation)k(policies,)g(reco)o(v)o(ery)h(semantics,)
f(and)h(consistenc)o(y)g(guarantees\227)2040 1450 y(are)19
b(left)f(to)h(untrusted)h(libFSes.)2040 1672 y Fr(4.3.2)90
b(Order)n(ed)21 b(disk)h(writes)2040 1805 y Fq(Another)i(dif)n
(\002culty)f(XN)g(must)g(f)o(ace)h(is)e(guaranteeing)j(the)f(rules)f
(Ganger)2040 1888 y(and)j(P)o(att)f([16])g(gi)n(v)o(e)h(for)g(achie)n
(ving)g(strict)f(\002le)g(system)h(inte)o(grity)f(across)2040
1971 y(crashes:)19 b(First,)f(ne)n(v)o(er)h(reuse)h(an)f(on\255disk)g
(resource)h(before)g(nullifying)f(all)2040 2054 y(pre)n(vious)25
b(pointers)g(to)e(it.)g(Second,)h(ne)n(v)o(er)h(create)f(persistent)g
(pointers)g(to)2040 2137 y(structures)i(before)h(the)o(y)f(are)g
(initialized.)f(Third,)g(when)i(mo)o(ving)g(an)f(on\255)2040
2220 y(disk)15 b(resource,)g(ne)n(v)o(er)g(reset)f(the)h(old)g(pointer)
g(in)f(persistent)h(storage)g(before)2040 2303 y(the)k(ne)n(w)g(one)h
(has)f(been)h(set.)2152 2386 y(The)15 b(\002rst)g(tw)o(o)g(rules)g(are)
g(required)h(for)g(global)f(system)h(inte)o(grity\227and)2040
2469 y(thus)28 b(must)g(be)g(enforced)h(by)f(XN\227while)f(a)g(\002le)g
(system)h(violating)g(the)2040 2553 y(third)19 b(rule)g(will)f(only)h
(af)n(fect)g(itself.)2152 2636 y(The)i(rules)f(are)h(simple)g(b)o(ut)f
(dif)n(\002cult)g(to)h(enforce)g(ef)n(\002ciently:)f(a)h(nai)n(v)o(e)
2040 2719 y(implementation)e(will)d(incur)j(frequent)f(costly)g
(synchronous)i(disk)e(writes.)2040 2802 y(XN)25 b(allo)n(ws)g(libFSes)g
(to)g(address)h(this)f(by)h(enforcing)h(the)e(rules)g(without)2040
2885 y(le)o(gislating)i(ho)n(w)g(to)f(follo)n(w)h(them.)f(In)g
(particular)m(,)h(libFSes)e(can)i(choose)2040 2968 y(an)o(y)20
b(operation)f(order)h(which)f(satis\002es)f(the)h(constraints.)2152
3051 y(The)c(\002rst)e(rule)i(is)f(implemented)h(by)h(deferring)f(a)f
(block')l(s)h(deallocation)2040 3134 y(until)f(all)g(on\255disk)h
(pointers)f(to)g(that)g(block)h(ha)o(v)o(e)f(been)h(deleted;)g(a)f
(reference)2040 3217 y(count)g(performed)h(at)e(crash)h(reco)o(v)o(ery)
g(time)f(helps)h(libFSes)e(implement)i(the)2040 3300
y(third)19 b(rule.)2152 3383 y(The)e(second)h(rule)e(is)h(the)f
(hardest)i(of)e(the)h(three.)g(T)-6 b(o)16 b(implement)h(it,)f(XN)2040
3466 y(k)o(eeps)23 b(track)e(of)h Fp(tainted)f Fq(blocks.)h(An)o(y)g
(block)g(is)f(considered)i(tainted)e(if)g(it)2040 3549
y(points)c(either)g(to)f(an)h(uninitialized)g(block)h(or)e(to)h(a)g
(tainted)f(block.)i(LibFSes)2040 3632 y(must)i(not)g(be)g(allo)n(wed)g
(to)g(write)f(a)h(tainted)g(block)h(to)e(disk.)h(Ho)n(we)n(v)o(er)m(,)g
(tw)o(o)2040 3715 y(e)o(xceptions)g(allo)n(w)f(XN)g(to)f(enforce)i(the)
f(general)h(rule)f(more)g(ef)n(\002ciently:)2152 3798
y(First,)i(XN)g(allo)n(ws)h(entire)g(\002le)f(systems)i(to)f(be)g(mark)
o(ed)h(\223temporary\224)2040 3881 y(\(i.e.,)18 b(not)h(persistent)g
(across)g(reboots\).)h(Since)e(these)i(\002le)e(systems)h(are)g(not)
2040 3964 y(persistent,)27 b(the)o(y)h(are)f(not)g(required)h(to)f
(adhere)h(to)f(an)o(y)h(of)f(the)h(inte)o(grity)2040
4047 y(rules.)23 b(This)f(technique)i(allo)n(ws)f(memory\255based)i
(\002le)d(systems)h(to)g(be)g(im\255)2040 4130 y(plemented)d(with)f(no)
g(loss)g(of)g(ef)n(\002cienc)o(y)-5 b(.)2152 4213 y(The)11
b(second)g(e)o(xception)g(is)g(based)g(on)g(the)h(obse)q(rv)n(ation)g
(that)f(un)q(attached)2040 4296 y(subtrees\227trees)32
b(whose)g(root)g(is)f(not)h(reachable)h(from)e(an)o(y)h(persistent)2040
4379 y(root\227will)27 b(not)g(be)h(preserv)o(ed)h(across)f(reboots)g
(and)g(thus,)f(lik)o(e)h(tempo\255)2040 4462 y(rary)21
b(trees,)g(are)h(free)f(of)g(an)o(y)h(ordering)g(constraints.)g(Thus,)f
(XN)g(does)h(not)2040 4545 y(track)d(tainted)g(blocks)g(in)g(an)f
(unreachable)j(tree)d(until)h(it)e(is)i(connected)h(to)e(a)2040
4628 y(persistent)h(root.)2040 4850 y Fr(4.3.3)90 b(The)22
b(b)n(uffer)h(cache)e(r)n(egistry)2040 4983 y Fq(Finally)-5
b(,)17 b(we)h(discuss)g(the)g(XN)f(b)o(uf)n(fer)h(cache)g(re)o(gistry)
-5 b(,)17 b(which)h(allo)n(ws)g(pro\255)2040 5066 y(tected)e(sharing)g
(of)g(disk)f(blocks)i(among)f(libFSes.)f(The)g(re)o(gistry)h(tracks)f
(the)2040 5149 y(mapping)i(of)e(cached)h(disk)g(blocks)g(and)g(their)f
(metadata)h(to)f(physical)g(pages)2040 5232 y(\(and)27
b(vice)f(v)o(ersa\).)g(Unlik)o(e)h(traditional)f(b)o(uf)n(fer)g
(caches,)h(it)f(only)h(records)2040 5315 y(the)d(mapping,)h(not)f(the)h
(disk)f(blocks)h(themselv)o(es.)f(The)g(disk)h(blocks)f(are)2040
5398 y(stored)12 b(in)g(application\255managed)g(physical\255memory)g
(pages.)g(The)g(re)o(gistry)1922 5647 y(5)p eop
%%Page: 6 6
6 5 bop -152 -69 a Fq(tracks)12 b(both)g(the)g(mapping)g(and)g(its)g
(state)g(\(d)q(irty)-5 b(,)12 b(out)g(o)q(f)g(core)q(,)g
(uninitialized,)-152 14 y(lock)o(ed\).)21 b(T)-6 b(o)20
b(allo)n(w)h(libFSes)e(to)h(see)h(which)f(disk)h(blocks)g(are)f
(cached,)i(the)-152 97 y(b)o(uf)n(fer)d(cache)h(re)o(gistry)f(is)f
(mapped)j(read\255only)f(into)e(application)i(space.)-40
180 y(Access)28 b(control)f(is)f(performed)i(when)g(a)e(libFS)g
(attempts)h(to)f(map)i(a)-152 263 y(physical)20 b(page)h(containing)g
(a)e(disk)h(block)h(into)e(its)g(address)i(space,)f(rather)-152
346 y(than)c(when)g(that)g(block)g(is)f(requested)h(from)g(disk.)f
(That)h(is,)e(re)o(gistry)i(entries)-152 429 y(can)26
b(be)f(inserted)g(without)g(requiring)h(that)e(the)h(object)h(the)o(y)f
(describe)g(be)-152 512 y(in)20 b(memory)-5 b(.)20 b(Blocks)g(can)g
(also)f(be)h(installed)f(in)h(the)f(re)o(gistry)h(before)g(their)-152
596 y(template)25 b(or)f(parent)h(is)f(kno)n(wn.)h(As)f(a)h(result,)f
(libFSes)f(ha)o(v)o(e)h(signi\002cant)-152 679 y(freedom)c(to)f
(prefetch.)-40 762 y(Re)o(gistry)i(entries)g(are)g(installed)g(in)f(tw)
o(o)h(w)o(ays.)g(First,)f(an)h(application)-152 845 y(that)g(has)h
(write)e(access)h(to)g(a)g(block)h(can)g(directly)f(install)f(a)h
(mapping)h(to)f(it)-152 928 y(into)d(the)h(re)o(gistry)-5
b(.)18 b(Second,)g(applications)h(that)f(do)h(not)f(ha)o(v)o(e)h(write)
e(access)-152 1011 y(to)f(a)g(block)h(can)f(indirectly)g(install)g(an)g
(entry)g(for)g(it)f(by)h(performing)h(a)f(\223read)-152
1094 y(and)22 b(insert,)-5 b(\224)20 b(which)h(tells)f(the)h(k)o(ernel)
h(to)f(read)g(a)g(disk)g(block,)g(associate)g(it)-152
1177 y(with)12 b(an)g(application\255pro)o(vided)g(physical)g(page,)g
(set)g(the)g(protection)g(of)g(that)-152 1260 y(page)24
b(page)g(appropriately)-5 b(,)24 b(and)g(insert)f(this)g(mapping)h
(into)g(the)f(re)o(gistry)-5 b(.)-152 1343 y(This)26
b(latter)f(mechanism)i(is)e(used)i(to)f(pre)n(v)o(ent)h(applications)f
(that)g(do)g(not)-152 1426 y(ha)o(v)o(e)c(permission)g(to)f(write)f(a)i
(block)g(from)f(modifying)h(it)f(by)g(installing)h(a)-152
1509 y(bogus)f(in\255core)e(cop)o(y)-5 b(.)-40 1592 y(XN)14
b(does)g(not)h(replace)f(physical)g(pages)h(from)f(the)g(re)o(gistry)f
(\(e)o(xcept)i(for)-152 1675 y(those)j(freed)f(by)g(applications\),)g
(allo)n(wing)h(applications)f(to)g(determine)h(the)-152
1758 y(most)f(appropriate)g(caching)g(polic)o(y)-5 b(.)17
b(Because)g(applications)g(also)f(manage)-152 1841 y(virtual)26
b(memory)g(paging,)g(the)f(partitioning)h(of)g(disk)f(cache)i(and)f
(virtual)-152 1924 y(memory)33 b(backing)g(store)f(is)g(under)g
(application)h(control.)f(T)-6 b(o)32 b(simplify)-152
2007 y(the)20 b(application')l(s)h(task)f(and)h(because)h(it)d(is)h
(ine)o(xpensi)n(v)o(e)h(to)f(pro)o(vide,)h(XN)-152 2090
y(maintains)c(an)g(LR)m(U)e(list)h(of)g(unused)i(b)o(ut)e(v)n(alid)g(b)
o(uf)n(fers.)g(By)h(def)o(ault,)f(when)-152 2173 y(LibOSes)d(need)i
(pages)g(and)f(none)h(are)f(free,)f(the)o(y)h(rec)o(ycle)h(the)f
(oldest)g(b)o(uf)n(fer)-152 2256 y(on)20 b(this)e(LR)m(U)g(list.)-40
2339 y(XN)g(allo)n(ws)g(an)o(y)h(process)g(to)f(write)g(\223uno)n
(wned\224)i(dirty)e(blocks)h(to)f(disk)-152 2422 y(\(i.e.,)29
b(blocks)i(not)f(associated)h(with)f(a)g(running)h(process\),)f(e)n(v)o
(en)h(if)f(that)-152 2505 y(process)c(does)g(not)g(ha)o(v)o(e)f(write)g
(permission)h(for)f(the)g(dirty)g(blocks.)h(This)-152
2588 y(allo)n(ws)17 b(the)h(construction)g(of)f(daemons)h(that)f
(asynchronously)j(write)d(dirty)-152 2671 y(blocks.)30
b(LibFSes)e(do)h(not)g(ha)o(v)o(e)g(to)g(trust)g(daemons)h(with)f
(write)f(access)-152 2754 y(to)23 b(their)g(\002les,)f(only)i(to)f
(\003ush)g(the)g(blocks.)h(This)e(ability)h(has)h(three)f(bene\255)-152
2837 y(\002ts.)d(First,)f(the)i(contents)g(of)g(the)g(re)o(gistry)g
(can)g(be)g(safely)g(retained)g(across)-152 2920 y(process)i(in)m(v)o
(ocations)g(rather)f(than)h(ha)o(ving)f(to)g(be)h(brought)g(in)f(and)g
(paged)-152 3003 y(out)h(on)h(creation)f(and)g(e)o(xit.)f(Second,)i
(this)e(design)i(simpli\002es)e(the)h(imple\255)-152
3086 y(mentations)k(of)g(libFSes,)e(since)h(a)h(libFS)e(can)i(rely)f
(on)h(a)f(daemon)i(of)e(its)-152 3169 y(choice)e(to)f(\003ush)h(dirty)f
(blocks)h(e)n(v)o(en)g(in)f(dif)n(\002cult)f(situations)i(\(e.g.,)e(if)
h(the)-152 3252 y(application)c(containing)f(the)g(libFS)e(is)h(sw)o
(apped)i(out\).)e(Third,)g(this)g(design)-152 3335 y(allo)n(ws)i(dif)n
(ferent)g(write\255back)g(policies.)-152 3557 y Fr(4.4)91
b(XN)23 b(usage)-152 3691 y Fq(T)-6 b(o)16 b(illustrate)g(ho)n(w)g(XN)g
(is)g(used,)h(we)f(sk)o(etch)h(ho)n(w)g(a)f(libFS)f(can)h(implement)
-152 3774 y(common)33 b(\002le)d(system)i(operations.)g(These)f(tw)o(o)
h(setup)f(operations)i(are)-152 3857 y(used)20 b(to)f(install)f(a)h
(libFS:)-40 3940 y Fl(T)-6 b(ype)28 b(cr)o(eation.)e
Fq(The)h(libFS)f(describes)i(its)e(types)i(by)f(storing)h(tem\255)-152
4023 y(plates,)21 b(described)h(abo)o(v)o(e)g(in)f(Section)g(4.1,)g
(into)g(a)g Fp(type)g(catalo)o(gue)o(.)h Fq(Each)-152
4106 y(template)f(is)g(identi\002ed)g(by)h(a)f(unique)h(string)f
(\(e.g.,)f(\223FFS)g(Inode\224\).)h(Once)-152 4189 y(installed,)e
(types)g(are)g(persistent)g(across)h(reboots.)-40 4272
y Fl(LibFS)12 b(persistence.)g Fq(T)-6 b(o)13 b(ensure)h(that)f(libFS)f
(data)h(is)g(persistent)g(across)-152 4355 y(reboots,)26
b(a)f(libFS)f(can)h(re)o(gister)g(the)g(root)g(of)g(its)f(tree)h(in)g
(XN')l(s)g Fp(r)m(oot)g(cat\255)-152 4438 y(alo)o(gue)o(.)k
Fq(A)e(root)g(entry)h(consists)g(of)f(a)g(disk)h(e)o(xtent)f(and)h
(corresponding)-152 4521 y(template)19 b(type,)g(identi\002ed)g(by)h(a)
f(unique)h(string)f(\(e.g.,)f(\223mylibFS\224\).)-40
4604 y(After)24 b(a)g(crash,)g(XN)g(uses)h(these)f(roots)h(to)f
(garbage\255collect)h(the)f(disk)-152 4687 y(by)i(reconstructing)h(the)
f(free)g(map.)f(It)g(does)i(so)f(by)g(logically)g(tra)o(v)o(ersing)-152
4770 y(all)c(roots)g(and)g(all)g(blocks)g(reachable)h(from)f(them:)g
(reachable)h(blocks)g(are)-152 4853 y(allocated,)f(non\255reachable)h
(blocks)f(are)f(not.)g(If)g(reb)o(uilding)h(the)f(free)g(map)-152
4936 y(after)15 b(a)g(crash)h(needs)g(to)f(be)g(f)o(ast,)g(this)g(step)
g(can)h(be)g(eliminated)f(by)h(ordering)-152 5019 y(writes)j(to)f(the)h
(free)g(map.)-40 5102 y(After)24 b(initialization,)g(the)g(ne)n(w)h
(libFS)e(can)i(use)f(XN.)g(W)-6 b(e)24 b(describe)h(a)-152
5185 y(simpli\002ed)19 b(v)o(ersion)g(of)g(the)g(most)g(common)i
(operations.)-40 5268 y Fl(Startup.)k Fq(T)-6 b(o)26
b(start)g(using)g(XN,)g(a)g(libFS)f(loads)i(its)e(root\(s\))h(and)h(an)
o(y)-152 5351 y(types)18 b(it)e(needs)h(from)g(the)g(root)g(catalogue)h
(into)f(the)g(b)o(uf)n(fer)f(cache)i(re)o(gistry)-5 b(.)2040
-69 y(Usually)19 b(both)h(will)e(already)h(be)h(cached.)2152
14 y Fl(Read.)e Fq(Reading)h(a)f(block)h(from)f(disk)h(is)f(a)g(tw)o
(o\255stage)g(process,)h(where)2040 97 y(the)27 b(stages)h(can)g(be)f
(combined)i(or)e(separated.)h(First,)e(the)h(libFS)f(creates)2040
180 y(entries)20 b(in)h(the)f(re)o(gistry)g(by)h(passing)g(block)g
(addresses)h(for)e(the)g(requested)2040 263 y(disk)28
b(blocks)g(and)f(the)h(metadata)f(blocks)h(controlling)g(them)g
(\(their)e Fp(par)o(\255)2040 346 y(ents)p Fq(\).)f(The)g(parents)h
(must)f(already)h(e)o(xist)f(in)g(the)g(re)o(gistry\227libFSes)f(are)
2040 429 y(responsible)30 b(for)f(loading)h(them.)f(XN)g(uses)g
Fp(owns\255udf)h Fq(to)f(determine)h(if)2040 512 y(the)16
b(requested)h(blocks)g(are)f(controlled)h(by)f(the)g(supplied)h
(metadata)g(blocks)2040 596 y(and,)i(if)g(so,)f(installs)h(re)o(gistry)
g(entries.)2152 679 y(In)d(the)g(second)i(stage,)e(the)g(libFS)f
(initiates)g(a)h(read)g(request,)h(optionally)2040 762
y(supplying)k(pages)f(to)f(place)g(the)h(data)f(in.)g(Access)g(control)
h(through)g Fp(acl\255uf)2040 845 y Fq(is)27 b(performed)h(at)f(the)g
(parent)h(\(e.g.,)f(if)f(the)i(data)f(loaded)h(is)f(a)g(bare)h(disk)
2040 928 y(block\),)19 b(at)g(the)g(child)g(\(e.g.,)f(if)h(the)g(data)g
(is)f(an)h(inode\),)h(or)f(both.)2152 1011 y(A)d(libFS)g(can)h(load)g
(an)o(y)g(block)g(in)f(its)g(tree)g(by)h(tra)o(v)o(ersing)g(from)f(its)
g(root)2040 1094 y(entry)-5 b(,)21 b(or)f(optionally)i(by)f(starting)f
(from)h(an)o(y)g(intermediate)g(node)g(cached)2040 1177
y(in)c(the)g(re)o(gistry)-5 b(.)17 b(Note)g(that)g(XN)g(speci\002cally)
g(disallo)n(ws)g(metadata)h(blocks)2040 1260 y(from)h(being)h(mapped)g
(read/write.)2152 1343 y(T)-6 b(o)16 b(speculati)n(v)o(ely)h(read)f(a)f
(block)i(before)f(its)g(parent)g(is)f(kno)n(wn,)i(a)f(libFS)2040
1426 y(can)k(issue)g(a)f(ra)o(w)g(read)h(command.)h(If)e(the)g(block)h
(is)f(not)h(in)f(the)h(re)o(gistry)-5 b(,)19 b(it)2040
1509 y(will)d(be)i(mark)o(ed)g(as)g(\223unkno)n(wn)h(type\224)f(and)g
(a)f(disk)h(request)g(initiated.)e(The)2040 1592 y(block)23
b(cannot)g(be)g(used)g(until)f(after)f(it)h(is)g(bound)i(to)e(a)g
(parent)g(by)h(the)f(\002rst)2040 1675 y(stage)h(of)f(the)h(read)g
(process,)g(which)g(will)e(determine)i(its)f(type)h(and)g(allo)n(w)2040
1758 y(access)d(control)f(to)g(be)g(performed.)2152 1841
y Fl(Allocate.)27 b Fq(A)g(libFS)f(selects)h(blocks)i(to)e(allocate)g
(by)h(reading)g(XN')l(s)2040 1924 y(map)34 b(of)f(free)f(blocks,)i
(allo)n(wing)f(libFSes)f(to)h(control)h(\002le)e(layout)i(and)2040
2007 y(grouping.)29 b(Free)e(blocks)h(are)f(allocated)h(to)f(a)h(gi)n
(v)o(en)g(metadata)g(node)g(by)2040 2090 y(calling)21
b(XN)g(with)g(the)g(metadata)g(node,)h(the)f(blocks)h(to)f(allocate,)g
(and)g(the)2040 2173 y(proposed)29 b(modi\002cation)f(to)f(the)g
(metadata)h(node.)g(XN)f(checks)h(that)f(the)2040 2256
y(requested)e(blocks)g(are)f(free,)f(runs)h(the)g(appropriate)h
Fp(acl\255uf)f Fq(to)g(see)g(if)f(the)2040 2339 y(libFS)15
b(has)h(permission)h(to)f(allocate,)g(and)g(runs)h Fp(owns\255udf)p
Fq(,)f(as)g(described)h(in)2040 2422 y(Section)h(4.1,)h(to)f(see)h
(that)f(the)g(correct)h(block)g(is)f(being)i(allocated.)e(If)g(these)
2040 2505 y(checks)26 b(all)f(succeed,)h(the)f(metadata)h(is)f
(changed,)i(the)e(allocated)h(blocks)2040 2588 y(are)d(remo)o(v)o(ed)i
(from)e(the)g(free)g(list,)f(and)i(an)o(y)g(allocated)g(metadata)g
(blocks)2040 2671 y(are)19 b(mark)o(ed)h(tainted)f(\(see)g(Section)g
(4.3.2\).)2152 2754 y Fl(Write.)c Fq(A)h(libFS)f(writes)g(dirty)h
(blocks)g(to)g(disk)g(by)h(passing)g(the)f(blocks)2040
2837 y(to)k(write)g(to)h(XN.)e(If)h(the)h(blocks)g(are)g(not)f(in)h
(memory)-5 b(,)21 b(or)f(the)o(y)h(ha)o(v)o(e)g(been)2040
2920 y(pinned)16 b(in)e(memory)h(by)f(some)h(other)g(application,)g
(the)f(write)f(is)h(pre)n(v)o(ented.)2040 3003 y(The)24
b(write)f(also)h(f)o(ails)g(if)f(an)o(y)i(of)f(the)g(blocks)h(are)f
(tainted)g(and)g(reachable)2040 3086 y(from)f(a)g(persistent)g(root.)g
(Otherwise,)f(the)h(write)f(succeeds.)i(If)f(the)g(block)2040
3169 y(w)o(as)13 b(pre)n(viously)i(tainted)e(and)h(no)n(w)g(is)f(not)g
(\(either)g(by)h(eliminating)f(pointers)2040 3252 y(to)33
b(uninitialized)g(metadata)g(or)g(by)g(becoming)h(initialized)e
(itself\),)g(XN)2040 3335 y(modi\002es)19 b(its)f(state)h(and)h(remo)o
(v)o(es)f(it)g(from)f(the)h(tainted)g(list.)2152 3418
y(Since)c(applications)h(control)g(what)f(is)g(fetched)h(and)g(what)f
(is)g(paged)h(out)2040 3501 y(when)j(\(and)g(in)f(what)g(order\),)g
(the)o(y)g(can)h(control)g(man)o(y)f(disk)h(management)2040
3584 y(policies)g(and)h(can)f(enforce)h(strong)f(stability)g
(guarantees.)2152 3667 y Fl(Deallocate.)d Fq(XN)e(uses)i(UDFs)e(to)h
(check)h(deallocate)g(operations)g(anal\255)2040 3750
y(ogously)21 b(to)f(allocate)g(operations.)g(If)f(there)h(are)g(no)g
(on\255disk)h(pointers)f(to)f(a)2040 3833 y(deallocated)f(disk)f
(block,)g(XN)f(places)i(it)e(on)h(the)f(free)h(list.)f(Otherwise,)g(XN)
2040 3916 y(enqueues)24 b(the)e(block)g(on)g(a)g(\223will)f(free\224)h
(list)f(until)g(the)h(block')l(s)h(reference)2040 3999
y(count)18 b(is)e(zero.)h(Reference)g(counts)g(are)g(decremented)h
(when)g(a)e(parent)i(that)2040 4082 y(had)i(an)f(on\255disk)h(pointer)f
(to)g(the)g(block)h(deletes)f(that)g(pointer)g(via)g(a)g(write.)2040
4305 y Fr(4.5)91 b(C\255FFS:)23 b(a)f(library)g(\002le)g(system)2040
4438 y Fq(This)h(subsection)i(brie\003y)f(describes)g(C\255FFS)e
(\(co\255locating)j(f)o(ast)e(\002le)g(sys\255)2040 4521
y(tem)d([15)q(]\)\227a)g(UNIX\255lik)o(e)f(library)i(\002le)e(system)i
(we)f(b)o(uilt\227with)f(special)2040 4604 y(reference)h(to)e
(additional)i(protection)g(guarantees)g(it)e(pro)o(vides.)2152
4687 y(XN)32 b(pro)o(vides)h(the)f(basic)h(protection)f(guarantees)i
(needed)f(for)f(\002le)2040 4770 y(system)15 b(inte)o(grity)-5
b(,)14 b(b)o(ut)g(real\255w)o(orld)h(\002le)e(systems)i(often)g
(require)g(other)m(,)f(\002le\255)2040 4853 y(system\255speci\002c)28
b(in)m(v)n(ariants.)g(F)o(or)g(instance,)g(UNIX)f(\002le)g(systems)h
(must)2040 4936 y(ensure)19 b(the)f(uniqueness)h(of)f(\002le)f(names)i
(within)f(a)f(directory)-5 b(.)19 b(This)e(type)h(of)2040
5019 y(guarantee)e(can)f(be)g(pro)o(vided)h(in)f(an)o(y)g(number)h(of)f
(w)o(ays:)g(in)g(the)g(k)o(ernel,)g(in)f(a)2040 5102
y(serv)o(er)m(,)i(or)m(,)g(in)g(some)h(cases,)f(by)g(simple)h(defensi)n
(v)o(e)g(programming.)g(C\255FFS)2040 5185 y(currently)g(do)n(wnloads)g
(methods)g(into)g(the)f(k)o(ernel)h(to)f(check)h(its)e(in)m(v)n
(ariants.)2040 5268 y(W)-6 b(e)21 b(are)h(currently)f(de)n(v)o(eloping)
j(a)d(system)h(similar)f(to)g(UDFs)g(that)g(can)h(be)1922
5647 y(6)p eop
%%Page: 7 7
7 6 bop -152 -69 a Fq(used)27 b(to)g(enforce)g(type\255speci\002c)g(in)
m(v)n(ariants)g(in)f(an)h(ef)n(\002cient,)f(e)o(xtensible)-152
14 y(w)o(ay)-5 b(.)-40 97 y(Our)19 b(e)o(xperience)g(with)f(C\255FFS)e
(sho)n(ws)j(that,)f(e)n(v)o(en)h(with)f(the)g(strongest)-152
180 y(desired)d(guarantees,)g(a)g(protected)g(interf)o(ace)f(can)h
(still)e(pro)o(vide)i(signi\002cant)-152 263 y(\003e)o(xibility)f(to)h
(unpri)n(vile)o(ged)i(softw)o(are,)d(and)i(that)f(the)g(e)o(xok)o
(ernel)h(approach)-152 346 y(can)h(deal)g(as)f(readily)h(with)f
(high\255le)n(v)o(el)h(protection)g(requirements)g(as)f(it)g(can)-152
429 y(with)j(those)g(closer)g(to)g(hardw)o(are.)-40 512
y(C\255FFS)24 b(mak)o(es)j(four)f(main)g(additions)g(to)g(XN')l(s)f
(protection)i(mecha\255)-152 596 y(nisms:)-58 738 y(1.)37
b(Access)18 b(control:)g(it)e(maps)i(the)g(UNIX)f(representation)h(and)
g(seman\255)35 821 y(tics)12 b(of)g(access)g(control)g(\(uids)g(and)g
(gids,)g(etc.\))g(to)g(those)h(of)f(e)o(x)q(ok)o(e)q(rnel)35
904 y(capabilities.)-58 1047 y(2.)37 b(W)-6 b(ell\255formed)25
b(updates:)g(C\255FFS)e(guarantees)j(UNIX\255speci\002c)e(\002le)35
1130 y(semantics:)15 b(for)g(e)o(xample,)g(that)g(directories)g
(contain)h(le)o(gal,)e(aligned)35 1213 y(\002le)k(names.)-58
1356 y(3.)37 b(Atomicity:)20 b(C\255FFS)e(performs)j(locking)g(to)e
(ensure)i(that)f(its)g(data)g(is)35 1439 y(al)o(w)o(ays)15
b(reco)o(v)o(erable)f(and)h(disk)f(writes)f(only)h(occur)h(when)f
(metadata)35 1522 y(is)19 b(internally)g(consistent.)-58
1665 y(4.)37 b(Implicit)19 b(updates:)h(C\255FFS)d(ensures)j(that)f
(certain)h(state)e(transitions)35 1748 y(are)g(implicit)g(on)g(certain)
h(actions.)f(Some)g(e)o(xamples)h(are)f(that)g(mod\255)35
1831 y(i\002cation)25 b(times)f(are)h(updated)i(when)e(\002le)f(data)i
(are)f(changed,)h(and)35 1914 y(that)19 b(renaming)h(or)f(deleting)g(a)
g(\002le)f(updates)i(the)f(name)h(cache.)-40 2057 y(It)27
b(is)h(not)g(dif)n(\002cult)f(to)g(implement)h(UNIX)g(protection)g
(without)g(sig\255)-152 2140 y(ni\002cantly)33 b(de)o(grading)h
(application)f(po)n(wer)l(.)f(C\255FFS)f(protection)i(is)f(im\255)-152
2223 y(plemented)27 b(mainly)e(by)h(a)f(small)g(number)h(of)f
(if\255statements)g(rather)g(than)-152 2306 y(by)d(procedures)h(that)f
(limit)e(\003e)o(xibility)-5 b(.)21 b(The)g(most)h(intricate)f
(operation\227)-152 2389 y(ensuring)26 b(that)e(\002les)f(in)h(a)g
(directory)h(ha)o(v)o(e)f(unique)i(names\227is)e(less)g(than)-152
2472 y(100)16 b(lines)f(of)h(code)g(that)f(scans)h(through)g(a)f(link)o
(ed)h(list)f(of)g(cached)h(directory)-152 2555 y(blocks)k(to)f(ensure)h
(name)f(uniqueness.)-152 2777 y Fr(4.6)91 b(Futur)n(e)22
b(w)o(ork)-152 2910 y Fq(Stable)33 b(storage)g(is)g(the)f(most)h
(challenging)i(resource)e(we)g(ha)o(v)o(e)g(multi\255)-152
2994 y(ple)o(x)o(ed.)23 b(Future)e(w)o(ork)i(will)e(focus)h(on)g(tw)o
(o)g(areas.)g(First,)e(we)i(plan)g(to)g(im\255)-152 3077
y(plement)d(a)f(range)h(of)f(\002le)g(systems)h(\(log\255structured)g
(\002le)e(systems,)i(RAID,)-152 3160 y(and)27 b(memory\255based)i
(\002le)c(systems\),)i(thus)f(testing)h(if)f(the)g(XN)g(interf)o(ace)
-152 3243 y(is)18 b(po)n(werful)h(enough)h(to)e(support)h(concurrent)h
(use)e(by)h(radically)f(dif)n(ferent)-152 3326 y(\002le)d(systems.)g
(Second)h(we)f(will)f(in)m(v)o(estigate)h(using)h(lightweight)f
(protected)-152 3409 y(methods)23 b(lik)o(e)f(UDFs)e(to)i(implement)g
(the)f(simple)h(protection)g(checks)h(re\255)-152 3492
y(quired)d(by)f(higher)o(\255le)n(v)o(el)h(abstractions.)-152
3689 y Fr(5)91 b(Ov)o(er)o(view)22 b(of)h(Xok/ExOS)-152
3841 y Fq(F)o(or)e(the)g(e)o(xperiments)h(in)f(this)g(paper)m(,)g(we)g
(use)h(Xok/ExOS.)e(This)h(section)-152 3924 y(describes)f(both)g(Xok)f
(and)g(ExOS.)-152 4113 y Fr(5.1)91 b(Xok)-152 4230 y
Fq(Xok)26 b(safely)f(multiple)o(x)o(es)g(the)g(physical)h(resources)g
(on)f(Intel)g(x86\255based)-152 4313 y(computers.)19
b(Xok)f(performs)g(this)f(task)g(in)h(a)f(manner)i(similar)e(to)g(the)h
(Ae)o(gis)-152 4396 y(e)o(xok)o(ernel,)i(which)e(runs)h(on)f
(MIPS\255based)h(DECstations)e([11)q(].)g(The)i(CPU)-152
4479 y(is)24 b(multiple)o(x)o(ed)i(by)f(di)n(viding)g(time)f(into)h
(round\255robin\255scheduled)j(slices)-152 4562 y(with)g(e)o(xplicit)g
(noti\002cation)h(of)f(the)h(be)o(ginning)h(and)f(the)f(end)h(of)g(a)f
(time)-152 4645 y(slice.)c(En)m(vironments)g(pro)o(vide)h(the)f(hardw)o
(are\255speci\002c)h(state)f(needed)h(to)-152 4728 y(run)19
b(a)g(process)g(\(e.g.,)f(an)h(e)o(xception)g(stack\))g(and)g(to)g
(respond)h(to)e(an)o(y)h(e)n(v)o(ent)-152 4811 y(occurring)c(during)f
(process)g(e)o(x)o(ecution)g(\(e.g.,)f(interrupts)g(and)h(e)o
(xceptions\).)-152 4894 y(The)22 b(netw)o(ork)h(is)f(multiple)o(x)o(ed)
h(with)e(dynamic)j(pack)o(et)f(\002lters)e([10)q(].)g(This)-152
4977 y(subsection)15 b(brie\003y)e(describes)h(the)g(dif)n(ferences)g
(between)g(Ae)o(gis)f(and)h(Xok.)-40 5060 y Fl(Ph)o(ysical)h(memory)-5
b(.)16 b Fq(Unlik)o(e)f(the)h(MIPS)e(architecture,)h(the)h(x86)g
(archi\255)-152 5143 y(tecture)24 b(de\002nes)h(the)f(page\255table)h
(structure.)f(Since)g(x86)h(TLB)e(re\002lls)g(are)-152
5226 y(handled)g(in)f(hardw)o(are,)g(this)f(structure)h(cannot)h(be)f
(o)o(v)o(erridden)g(by)h(appli\255)-152 5309 y(cations.)k(Additionally)
-5 b(,)27 b(since)f(the)h(hardw)o(are)g(does)g(not)g(v)o(erify)f(that)h
(the)2040 -69 y(physical)18 b(page)g(of)g(a)f(translation)h(can)g(be)g
(mapped)h(by)f(a)f(process,)h(applica\255)2040 14 y(tions)d(are)g(pre)n
(v)o(ented)i(from)e(directly)g(modifying)h(the)f(page)h(table)g(and)f
(must)2040 97 y(instead)i(use)g(system)g(calls.)g(Although)g(these)g
(restrictions)g(mak)o(e)g(Xok)h(less)2040 180 y(e)o(xtensible)g(than)f
(Ae)o(gis,)g(the)o(y)g(simplify)g(the)g(implementation)h(of)f(libOSes)
2040 263 y(\(see)e(Section)g(9\))h(with)e(only)i(a)f(small)g(reduction)
h(in)f(application)h(\003e)o(xibility)-5 b(.)2152 346
y(Lik)o(e)21 b(Ae)o(gis,)g(Xok)h(allo)n(ws)f(ef)n(\002cient)g(and)h(po)
n(werful)g(virtual)f(memory)2040 429 y(abstractions)12
b(to)g(be)g(b)o(uilt)g(at)g(the)g(application)g(le)n(v)o(el.)g(It)g
(does)g(so)g(by)g(e)o(xposing)2040 512 y(the)32 b(capabilities)f(of)h
(the)f(hardw)o(are)i(\(e.g.,)e(all)f(MMU)j(protection)f(bits\))2040
596 y(and)27 b(e)o(xposing)g(man)o(y)g(k)o(ernel)g(data)f(structures)g
(\(e.g.,)f(free)h(lists,)f(in)m(v)o(erse)2040 679 y(page)32
b(mappings\).)f(Xok')l(s)h(lo)n(w\255le)n(v)o(el)e(interf)o(ace)i
(means)f(that)g(paging)h(is)2040 762 y(handled)22 b(by)g(applications.)
f(As)g(such,)g(it)f(can)h(be)g(done)h(from)f(disk,)g(across)2040
845 y(the)34 b(netw)o(ork,)g(or)f(by)h(data)g(re)o(generation.)h
(Additionally)-5 b(,)34 b(applications)2040 928 y(can)17
b(readily)g(perform)h(per)o(\255page)f(transformations)h(such)f(as)g
(compression,)2040 1011 y(v)o(eri\002cation)j(of)h(contents)g(using)g
(digital)f(signatures)h(\(to)f(allo)n(w)h(untrusted)2040
1094 y(nodes)f(in)f(a)g(netw)o(ork)h(to)e(cache)i(pages\),)f(or)g
(encryption.)2152 1177 y Fl(W)-5 b(ak)o(eup)26 b(pr)o(edicates.)f
Fq(Applications)i(often)g(w)o(ant)f(to)h(sleep)f(until)g(a)2040
1260 y(condition)d(is)f(true.)g(Unfortunately)-5 b(,)23
b(it)e(may)i(be)f(dif)n(\002cult)g(for)g(an)g(applica\255)2040
1343 y(tion)j(to)f(e)o(xpress)h(this)f(condition)h(to)g(the)f(k)o
(ernel.)h(This)f(problem)h(is)f(more)2040 1426 y(pre)n(v)n(alent)14
b(on)g(e)o(xok)o(ernels)g(because)h(the)e(b)o(ulk)g(of)g(OS)f
(functionality)i(resides)2040 1509 y(in)19 b(the)g(application.)2152
1592 y(T)-6 b(o)12 b(solv)o(e)g(this)g(problem,)g(Xok)g(pro)o(vides)g
(applications)g(with)g(the)h(ability)2040 1675 y(to)21
b(inject)g(w)o(ak)o(eup)h(predicates)g(into)f(the)g(k)o(ernel.)g(W)-6
b(ak)o(eup)22 b(predicates)f(are)2040 1758 y(boolean)g(e)o(xpressions)g
(used)g(by)f(applications)h(to)f(sleep)g(until)g(the)g(state)f(of)2040
1841 y(the)c(system)g(satis\002es)e(some)i(condition;)h(the)o(y)f(are)f
(e)n(v)n(aluated)i(by)f(the)g(k)o(ernel)2040 1924 y(when)23
b(an)h(en)m(vironment)g(is)e(about)i(to)e(be)h(scheduled.)h(The)f
(application)h(is)2040 2007 y(not)19 b(scheduled)i(if)d(the)h
(predicate)h(does)f(not)g(hold.)2152 2090 y(Predicate)30
b(e)n(v)n(aluation)h(is)e(ef)n(\002cient.)g(Lik)o(e)h(dynamic)h(pack)o
(et)g(\002lters,)2040 2173 y(Xok)20 b(compiles)f(predicates)h
(on\255the\255\003y)f(to)g(e)o(x)o(ecutable)h(code.)g(The)f(signif\255)
2040 2256 y(icant)h(o)o(v)o(erhead)i(of)e(an)g(address)h(space)g(conte)
o(xt)g(switch)f(is)g(eliminated)g(by)2040 2339 y(e)n(v)n(aluating)30
b(the)g(predicates)f(in)g(the)g(e)o(xok)o(ernel)i(and)e
(pre\255translating)h(all)2040 2422 y(predicate)d(virtual)f(addresses)h
(to)f(their)g(associated)h(physical)g(addresses.)2040
2505 y(When)12 b(a)g(virtual)g(page)g(referenced)g(in)g(a)g(predicate)g
(is)g(unmapped,)g(the)g(phys\255)2040 2588 y(ical)18
b(page)h(is)f(not)h(mark)o(ed)g(as)f(free)g(until)h(a)f(ne)n(w)g
(predicate)h(is)f(do)n(wnloaded)2040 2671 y(or)25 b(until)f(the)h
(application)h(e)o(xits.)e(Furthermore,)h(the)g(implementation)g(of)
2040 2754 y(w)o(ak)o(eup)i(predicates)f(is)e(simple)h(\(fe)n(wer)g
(than)h(200)g(lines)f(of)g(commented)2040 2837 y(code\))17
b(because)h(careful)f(language)h(design)g(\(no)f(loops)g(and)g(easy)h
(to)e(under)o(\255)2040 2920 y(stand)k(operations\))f(allo)n(ws)g
(predicates)h(to)f(be)g(easily)g(controlled.)2152 3003
y(Predicates)31 b(are)f(simple)h(b)o(ut)f(po)n(werful.)h(Coupled)h
(with)e(Xok')l(s)h(e)o(x\255)2040 3086 y(posure)36 b(of)f(data)h
(structures,)f(the)o(y)g(ha)o(v)o(e)h(pro)o(vided)g(us)f(with)g(a)g
(rob)o(ust)2040 3169 y(w)o(ak)o(eup)29 b(f)o(acility\227none)g(of)e
(the)h(ne)n(w)g(uses)g(of)g(w)o(ak)o(eup)h(predicates)g(re\255)2040
3252 y(quired)f(changes)h(to)f(Xok.)f(F)o(or)g(e)o(xample,)h(to)f(w)o
(ait)h(for)f(a)g(disk)h(block)g(to)2040 3335 y(be)c(paged)h(in,)e(a)h
(w)o(ak)o(eup)h(predicate)g(can)f(bind)g(to)g(the)g(block')l(s)g(state)
g(and)2040 3418 y(w)o(ak)o(e)e(up)e(when)i(it)d(changes)j(from)f
(\223in)f(transit\224)h(to)f(\223resident.)-5 b(\224)21
b(T)-6 b(o)20 b(bound)2040 3501 y(the)25 b(amount)g(of)g(time)f(a)h
(predicate)g(sleeps,)g(it)f(can)h(compare)h(against)e(the)2040
3584 y(system)14 b(clock.)g(The)g(composition)h(of)f(multiple)f
(predicates)i(allo)n(ws)e(atomic)2040 3667 y(checking)21
b(of)d(disjoint)h(data)h(structures.)2152 3750 y Fl(Access)36
b(contr)o(ol)f Fq(Unlik)o(e)h(Ae)o(gis,)f(Xok)h(performs)g(access)g
(control)2040 3833 y(through)28 b(hierarchically\255named)f
(capabilities)g([31];)f(despite)h(the)f(name,)2040 3916
y(these)35 b(capabilities)h(more)f(closely)h(resemble)f(a)g
(generalized)h(form)f(of)2040 3999 y(UNIX)21 b(user)h(and)g(group)h(ID)
e(than)h(traditional)g(capabilities)g([9].)f(All)g(Xok)2040
4082 y(calls)j(require)g(e)o(xplicit)g(credentials.)h(W)-6
b(e)23 b(belie)n(v)o(e)i(that)f(the)g(combination)2040
4165 y(of)31 b(an)h(e)o(xok)o(ernel)h(interf)o(ace,)e
(hierarchically\255named)i(capabilities,)e(and)2040 4248
y(e)o(xplicit)22 b(credentials)g(will)e(simplify)i(the)g
(implementation)g(of)g(secure)g(ap\255)2040 4332 y(plications,)d(as)g
(we)g(hope)h(to)f(demonstrate)g(in)g(future)g(w)o(ork.)2040
4520 y Fr(5.2)91 b(ExOS)22 b(1.0)2040 4637 y Fq(ExOS)27
b(is)h(a)f(libOS)g(that)h(supports)h(most)e(of)h(the)g(abstractions)h
(found)f(in)2040 4720 y(4.4BSD.)16 b(It)g(runs)h(man)o(y)h
(unmodi\002ed)g(UNIX)e(applications,)h(including)h(all)2040
4803 y(of)28 b(the)h(applications)g(that)f(are)g(needed)i(to)e(b)o
(uild)g(the)g(complete)h(system)2040 4886 y(\(k)o(ernel,)21
b(ExOS,)e(and)i(applications\))g(on)g(itself.)e(It)g(also)i(runs)f
(most)h(shells,)2040 4969 y(\002le)j(utilities)f(\(wc,)h(grep,)h(ls,)f
(vi,)g(etc.\),)g(and)h(man)o(y)g(netw)o(orking)h(applica\255)2040
5052 y(tions)19 b(\(telnetd,)g(ftp,)f(etc.\).)g(The)h(most)g(salient)g
(missing)g(functions)h(are)f(full)2040 5135 y(paging,)26
b(process)g(sw)o(apping,)h(process)f(groups,)g(and)g(a)f(windo)n(wing)h
(sys\255)2040 5218 y(tem.)21 b(There)g(is)g(no)h(fundamental)g(reason)g
(why)g(these)f(are)h(not)f(supported;)2040 5302 y(we)d(simply)f(ha)o(v)
o(e)h(not)g(yet)f(had)i(the)e(time)g(to)h(implement)g(or)f(port)h
(them.)f(On)1922 5647 y(7)p eop
%%Page: 8 8
8 7 bop -152 -69 a Fq(Ae)o(gis,)25 b(for)g(instance,)g(ExOS)g
(supported)h(full)f(paging)h(to)f(disk)h(and)f(o)o(v)o(er)-152
14 y(the)19 b(netw)o(ork.)-40 97 y(The)f(primary)g(goals)f(of)h(ExOS)f
(are)g(simplicity)g(and)h(\003e)o(xibility)-5 b(.)17
b(T)-6 b(o)17 b(al\255)-152 180 y(lo)n(w)k(applications)h(to)f(o)o(v)o
(erride)g(an)o(y)h(implementation)f(feature,)g(we)g(made)-152
263 y(the)g(system)g(entirely)g(library)g(based,)g(rather)g(than)h
(place)f(objects)g(such)h(as)-152 346 y(process)e(tables)e(in)h
(non\255customizable)i(serv)o(ers.)d(As)g(a)h(result,)f(customiza\255)
-152 429 y(tion)k(of)f(the)h(resulting)f(system)h(is)f(limited)g(only)h
(by)g(an)f(application')l(s)h(un\255)-152 512 y(derstanding)d(of)f(the)
f(system)h(interf)o(aces)g(and)g(by)g(the)f(protection)h(enforced)-152
596 y(by)e(shared)h(abstractions\227an)o(y)f(ExOS)f(functionality)h
(can)g(be)g(replaced)g(by)-152 679 y(application\255speci\002c)k(code.)
-40 762 y(The)f(tw)o(o)f(primary)g(ca)o(v)o(eats)h(of)f(the)g(current)h
(implementation)g(are)f(that)-152 845 y(the)e(system)f(is)g(research,)g
(not)h(production)g(quality)g(and)g(that)f(it)f(uses)i(shared)-152
928 y(global)k(state)f(for)f(some)i(abstractions.)f(These)g
(limitations)g(are)g(not)g(funda\255)-152 1011 y(mental)33
b(and)g(we)g(do)g(not)g(e)o(xpect)g(remo)o(ving)h(either)f(ca)o(v)o
(eat)f(to)h(ha)o(v)o(e)g(a)-152 1094 y(signi\002cant)23
b(impact)f(on)h(our)g(results.)f(T)-6 b(o)22 b(compensate)i(for)f(the)f
(ef)n(fects)h(of)-152 1177 y(shared)31 b(state)f(on)g(performance,)h
(measurements)h(in)e(Sections)g(6)g(and)g(8)-152 1260
y(include)19 b(the)e(cost)h(of)g(inserting)g(system)g(calls)f(before)h
(all)f(writes)g(to)h(shared)-152 1343 y(state.)i(This)h(represents)g
(the)g(o)o(v)o(erhead)h(of)f(in)m(v)o(oking)h(the)e(k)o(ernel)i(to)f
(check)-152 1426 y(writes)e(to)f(shared)i(state.)-152
1615 y Fr(5.2.1)90 b(Implementing)22 b(UNIX)g(abstractions)f(on)h(Xok)
-152 1732 y Fq(T)-6 b(o)22 b(implement)g(UNIX)f(abstractions)h(in)f(a)h
(library)-5 b(,)21 b(we)g(partitioned)i(most)-152 1815
y(of)f(the)g(UNIX)g(k)o(ernel)g(state)g(and)h(made)f(it)f(pri)n(v)n
(ate)i(to)f(each)g(process.)h(The)-152 1898 y(remainder)17
b(is)g(shared.)f(Most)h(critical)f(shared)h(state)f(\(inode)i(table,)e
(\002le)f(sys\255)-152 1981 y(tem)g(metadata,)f(page)i(tables,)e(b)o
(uf)n(fer)h(cache,)g(process)g(table,)f(and)h(pipes\),)g(is)-152
2064 y(protected)k(using)g(Xok')l(s)f(protections)h(mechanisms.)g(Ho)n
(we)n(v)o(er)m(,)f(for)g(some)-152 2147 y(shared)k(state)e(\(the)h
(process)g(map,)g(\002le)f(descriptor)h(table,)g(sock)o(ets,)g(TTYs,)
-152 2230 y(mount)15 b(table,)e(and)h(system)g(V)f(shared)i(memory)f
(table\),)f(ExOS)g(uses)h(shared)-152 2313 y(memory)-5
b(.)19 b(Using)g(softw)o(are)g(re)o(gions,)g(we)f(plan)h(to)f(mak)o(e)h
(this)g(shared)g(state)-152 2396 y(fully)25 b(protected)h(in)e(the)h
(near)g(future.)g(A)f(limited)h(de)o(gree)g(of)g(f)o(ault)g(isola\255)
-152 2479 y(tion)h(is)f(pro)o(vided)i(for)f(these)g(abstractions)g(by)g
(mapping)h(shared)g(data)f(at)-152 2562 y(addresses)20
b(f)o(ar)f(from)g(the)g(application)h(te)o(xt)e(and)i(data.)-40
2645 y Fl(Pr)o(ocesses.)h Fq(The)g Fp(pr)m(ocess)h(map)f
Fq(maps)g(UNIX)g(process)g(identi\002ers)g(to)-152 2728
y(Xok)h(en)m(vironment)g(numbers)g(using)g(a)f(shared)h(table.)f(The)g
Fp(pr)m(ocess)g(table)-152 2811 y Fq(records)c(the)f(process)h
(identi\002ers)f(of)g(each)h(process,)g(that)f(of)g(its)f(parent,)i
(the)-152 2894 y(ar)o(guments)h(with)e(which)h(the)g(process)g(w)o(as)g
(called,)g(its)f(run)h(status,)f(and)i(the)-152 2977
y(identity)k(of)f(its)g(children.)g(The)g(table)h(is)e(partitioned)i
(across)g(application\255)-152 3060 y(reserv)o(ed)17
b(memory)g(of)f(Xok')l(s)h(en)m(vironment)g(structure,)f(which)h(is)e
(mapped)-152 3143 y(readable)20 b(for)f(all)g(processes)h(and)g
(writeable)f(for)f(only)i(the)f(en)m(vironment')l(s)-152
3226 y(o)n(wning)i(process.)f(ExOS)f(uses)i(Xok')l(s)f(IPC)e(to)i
(safely)g(update)h(parent)f(and)-152 3309 y(child)25
b(process)g(state.)f(The)h(UNIX)f Fp(ps)h Fq(\(process)g(status\))f
(program)i(is)e(im\255)-152 3392 y(plemented)c(by)g(reading)f(all)g
(the)g(entries)g(of)g(the)g(process)g(table.)-40 3475
y(UNIX)31 b(pro)o(vides)h(the)e Fp(fork)h Fq(system)h(call)e(to)h
(duplicate)g(the)g(current)-152 3558 y(process)17 b(and)g
Fp(e)o(xec)g Fq(to)f(o)o(v)o(erlay)h(it)e(with)h(another)l(.)h
Fp(Exec)f Fq(is)g(implemented)h(by)-152 3641 y(creating)12
b(a)g(ne)n(w)g(address)g(space)g(for)g(the)g(ne)n(w)g(process,)g
(loading)g(on)g(demand)-152 3724 y(the)21 b(disk)f(image)h(of)f(the)h
(process)g(into)f(the)h(ne)n(w)f(address)h(space,)g(and)g(then)-152
3807 y(discarding)e(the)f(address)h(space)f(that)g(called)g
Fp(e)o(xec)p Fq(.)f(Implementing)i(fork)f(in)-152 3890
y(a)j(library)g(is)g(peculiar)g(since)h(it)e(requires)i(that)f(a)f
(process)i(create)g(a)f(replica)-152 3973 y(of)26 b(its)f(address)i
(space)f(and)g(state)g Fp(while)f(it)g(is)g(e)o(xecuting)p
Fq(.)h(T)-6 b(o)26 b(mak)o(e)g(fork)-152 4056 y(ef)n(\002cient,)20
b(ExOS)g(uses)h(cop)o(y\255on\255write)h(to)f(lazily)f(create)h
(separate)g(copies)-152 4139 y(of)h(the)g(parent')l(s)g(address)h
(space.)f(ExOS)f(scans)i(through)g(its)e(page)i(tables,)-152
4222 y(which)31 b(are)g(e)o(xposed)h(by)f(Xok,)g(marking)h(all)e(pages)
i(as)e(cop)o(y\255on\255write)-152 4305 y(e)o(xcept)18
b(those)g(data)g(se)o(gment)g(and)g(stack)g(pages)g(that)f(the)h
Fp(fork)f Fq(call)g(itself)g(is)-152 4388 y(using.)22
b(These)f(pages)i(must)e(be)h(duplicated)g(so)f(as)h(not)f(to)g
(generate)h(cop)o(y\255)-152 4471 y(on\255write)16 b(f)o(aults)g(while)
g(running)h(the)f Fp(fork)g Fq(and)h(page)g(f)o(ault)f(handling)h
(code.)-152 4554 y(Groups)f(of)f(page)h(table)f(entries)g(are)g
(updated)h(at)f(once)h(by)f(batching)h(system)-152 4637
y(calls)j(to)g(amortize)g(the)g(system)g(call)g(o)o(v)o(erhead)h(o)o(v)
o(er)f(man)o(y)h(updates.)-40 4720 y Fl(Inter)o(pr)o(ocess)28
b(communication.)e Fq(UNIX)h(de\002nes)h(a)f(v)n(ariety)h(of)f(in\255)
-152 4803 y(terprocess)g(communication)h(primiti)n(v)o(es:)d(signals)h
(\(softw)o(are)g(interrupts)-152 4886 y(that)k(can)g(be)g(sent)f
(between)h(processes)h(or)f(to)f(a)g(process)i(itself\),)d(pipes)-152
4969 y(\(producer)o(\255consumer)20 b(untyped)f(message)f(queues\),)h
(and)f(sock)o(ets)g(\(dif)n(fer)o(\255)-152 5052 y(ing)j(from)f(pipes)h
(in)f(that)g(the)o(y)h(can)g(be)f(established)i(between)f
(non\255related)-152 5135 y(processes,)f(potentially)f(e)o(x)o(ecuting)
h(on)g(dif)n(ferent)f(machines\).)-40 5218 y(Signals)i(are)h(layered)g
(on)f(top)h(of)f(Xok)h(IPC.)e(Pipes)g(are)i(implemented)-152
5302 y(using)16 b(Xok')l(s)g(softw)o(are)f(re)o(gions,)h(coupled)g
(with)f(a)g(\223directed)h(yield\224)f(to)h(the)-152
5385 y(other)g(party)g(when)h(it)e(is)g(required)h(to)g(do)g(w)o(ork)g
(\(i.e.,)e(if)i(the)f(queue)i(is)e(full)h(or)2040 -69
y(empty\).)h(Sock)o(ets)g(communicating)i(on)e(the)g(same)g(machine)g
(are)g(currently)2040 14 y(implemented)j(using)g(a)e(shared)i(b)o(uf)n
(fer)l(.)2152 97 y(Inter)o(\255machine)h(sock)o(ets)h(are)f
(implemented)h(through)g(user)o(\255le)n(v)o(el)e(net\255)2040
180 y(w)o(ork)i(libraries)f(for)g(UDP)g(and)h(TCP)-8
b(.)20 b(The)h(netw)o(ork)h(libraries)f(are)h(imple\255)2040
263 y(mented)f(using)g(Xok')l(s)f(timers,)g(upcalls,)g(and)h(pack)o(et)
g(rings,)f(which)g(allo)n(w)2040 346 y(protected)g(b)o(uf)n(fering)f
(of)g(recei)n(v)o(ed)h(netw)o(ork)g(pack)o(et,)2152 429
y Fl(File)e(descriptors.)g Fq(File)g(descriptors)h(are)f(small)h(inte)o
(gers)g(used)g(to)f(ac\255)2040 512 y(cess)26 b(man)o(y)h(UNIX)e
(resources)i(\(e.g.,)e(\002les,)g(sock)o(ets,)h(pipes\).)g(On)g(ExOS)
2040 596 y(the)o(y)j(name)f(entries)h(in)f(a)g(global)h
Fp(\002le)f(descriptor)h(table)p Fq(,)f(which)h(is)f(cur)o(\255)2040
679 y(rently)16 b(stored)g(in)f(shared)h(memory)-5 b(.)16
b(As)g(in)f(the)h(UNIX)f(k)o(ernel)h(itself,)e(ExOS)2040
762 y(accesses)33 b(each)h(table)e(element)h(in)f(an)h
(object\255oriented)h(manner:)f(each)2040 845 y(resource)25
b(is)e(associated)i(with)f(a)g(table)g(of)f(pointers)i(to)f(functions)h
(imple\255)2040 928 y(menting)c(each)g(operation)g(\(read,)f(write,)f
(etc.\).)g(Ho)n(we)n(v)o(er)m(,)h(unlik)o(e)h(UNIX,)2040
1011 y(ExOS)d(allo)n(ws)h(applications)h(to)f(install)f(their)h(o)n(wn)
g(methods.)2152 1094 y Fl(Files.)13 b Fq(Local)h(\002les)f(are)h
(accessed)h(through)g(C\255FFS,)d(which)i(uses)h(XN)e(to)2040
1177 y(protect)i(\002le)f(metadata;)h(remote)g(\002les)f(are)g
(accessed)i(through)g(the)f(Netw)o(ork)2040 1260 y(File)d(System)g
(protocol)g(\(NFS\))g([38].)g(Both)g(\002le)g(systems)g(are)g(library)g
(based.)2040 1343 y(ExOS)22 b(uses)h(XN')l(s)f(b)o(uf)n(fer)h(cache)h
(re)o(gistry)e(to)h(safely)g(share)g(both)g(C\255FFS)2040
1426 y(and)d(NFS)d(disk)j(blocks.)2152 1509 y(UNIX)12
b(allo)n(ws)g(dif)n(ferent)g(\002le)g(systems)g(to)g(be)g(attached)g
(to)g(its)g(hierarchi\255)2040 1592 y(cal)20 b(name)g(space.)g(ExOS)f
(duplicates)i(this)e(functionality)h(by)h(maintaining)2040
1675 y(a)28 b(currently)g(unprotected)h(shared)g(mount)g(table)e(that)h
(maps)g(directories)2040 1758 y(from)19 b(one)h(\002le)e(system)h(to)g
(another)l(.)2040 1945 y Fr(5.2.2)90 b(Shar)n(ed)21 b(libraries)2040
2062 y Fq(Since)k(ExOS)f(is)h(implemented)h(as)f(a)g(library)-5
b(,)25 b(shared)h(libraries)e(are)h(cru\255)2040 2145
y(cial.)f(W)m(ithout)g(shared)h(libraries,)f(e)n(v)o(ery)h(application)
h(w)o(ould)f(contain)g(its)2040 2228 y(o)n(wn)c(cop)o(y)h(of)f(ExOS,)f
(w)o(asting)h(memory)g(and)h(making)f(process)h(creation)2040
2311 y(e)o(xpensi)n(v)o(e.)30 b(W)-6 b(e)28 b(emplo)o(y)h(a)g(simple)f
(b)o(ut)h(primiti)n(v)o(e)f(scheme)h(for)g(shared)2040
2394 y(libraries.)22 b(ExOS)f(is)h(link)o(ed)i(as)e(a)g(stand\255alone)
i(e)o(x)o(ecutable)f(with)f(its)g(base)2040 2477 y(address)27
b(starting)f(at)g(a)g(reserv)o(ed)h(section)g(of)f(the)h(application')l
(s)g(address)2040 2560 y(space.)21 b(Its)f(e)o(xported)i(symbols)g(are)
e(then)h(e)o(xtracted)h(and)f(stored)g(in)g(an)g(as\255)2040
2643 y(sembly)16 b(\002le.)e(T)-6 b(o)15 b(resolv)o(e)g(calls)g(to)g
(library)g(routines,)g(the)g(application)h(links)2040
2726 y(against)23 b(this)g(assembly)g(\002le.)f(During)i(process)f
(creation)h(the)f(application)2040 2809 y(is)c(loaded)h(and)f(ExOS)f
(maps)i(the)f(library)g(at)f(its)g(indicated)i(address.)2152
2892 y(This)13 b(or)o(ganization)g(separates)h(the)f(\002le)f(that)g
(the)h(libOS)f(resides)i(in)e(from)2040 2975 y(applications,)24
b(allo)n(wing)f(multiple)g(applications)h(to)f(share)h(the)f(same)g
(on\255)2040 3058 y(disk)d(cop)o(y)h(and,)f(more)g(importantly)-5
b(,)20 b(an)o(y)g(cached)h(disk)f(blocks)g(from)g(this)2040
3141 y(\002le.)e(Code)h(sharing)h(reduces)g(the)f(size)g(of)g(ExOS)f(e)
o(x)o(ecutables)i(to)f(roughly)2040 3224 y(that)e(of)f(normal)h(UNIX)g
(applications.)g(Unlik)o(e)g(traditional)g(dynamic)g(link\255)2040
3307 y(ing,)26 b(procedure)i(calls)e(are)g(no)h(more)f(e)o(xpensi)n(v)o
(e)i(than)f(for)f(normal)h(code)2040 3390 y(since)19
b(the)o(y)h(do)f(not)g(require)g(the)g(use)h(of)f(a)f(relocation)i
(table.)2040 3586 y Fr(6)91 b(A)n(pplication)22 b(P)n(erf)n(ormance)e
(on)i(Xok)2040 3738 y Fq(This)f(section)i(sho)n(ws)f(that)g
(unmodi\002ed)h(UNIX)e(applications)i(run)f(as)f(f)o(ast)2040
3821 y(on)e(Xok/ExOS)f(as)g(on)g(con)m(v)o(entional)i(centralized)f
(operating)g(systems.)f(In)2040 3904 y(f)o(act,)23 b(because)h(of)e
(C\255FFS,)f(some)i(applications)h(run)f(considerably)h(f)o(aster)2040
3987 y(on)19 b(Xok/ExOS.)e(W)-6 b(e)18 b(compare)h(Xok/ExOS)f(to)g
(both)h(FreeBSD)e(2.2.2)i(and)2040 4070 y(OpenBSD)i(2.1)h(on)f(the)g
(same)h(hardw)o(are.)g(Xok)f(uses)h(de)n(vice)g(dri)n(v)o(ers)g(that)
2040 4153 y(are)33 b(deri)n(v)o(ed)g(from)f(those)h(of)g(OpenBSD.)f
(ExOS)g(also)g(shares)h(a)g(lar)o(ge)2040 4236 y(source)22
b(code)g(base)g(with)f(OpenBSD,)g(including)h(most)g(applications)g
(and)2040 4319 y(most)e(of)h(libc.)e(Compared)i(to)g(OpenBSD)f(and)g
(FreeBSD,)f(ExOS)h(has)g(not)2040 4402 y(had)d(much)g(time)f(to)h
(mature;)f(we)g(b)o(uilt)g(the)g(system)h(in)f(less)h(than)f(tw)o(o)h
(years)2040 4485 y(and)j(mo)o(v)o(ed)g(to)e(the)h(x86)h(platform)f
(only)h(a)e(year)i(ago.)2152 4568 y(All)g(e)o(xperiments)i(are)e
(performed)i(on)f(200\255MHz)h(Intel)e(Pentium)h(Pro)2040
4651 y(processors)26 b(with)e(a)h(256\255KByte)h(on\255chip)f(L2)g
(cache)g(and)h(64\255MByte)f(of)2040 4734 y(main)19 b(memory)-5
b(.)20 b(The)f(disk)g(system)g(consists)h(of)f(an)g(NCR)f(815)i(SCSI)e
(con\255)2040 4817 y(troller)28 b(connecting)j(a)e(f)o(ast)g(SCSI)e
(chain)j(with)f(one)g(or)g(more)h(Quantum)2040 4900 y(Atlas)22
b(XP32150)h(disk)g(dri)n(v)o(es)g(to)f(the)g(PCI)g(b)o(us)g(\(vs440fx)i
(PCI)d(chip)i(set\).)2040 4983 y(Reported)29 b(times)f(are)g(the)g
(minimum)g(time)g(of)g(ten)g(trials)f(\(the)h(standard)2040
5066 y(de)n(viations)20 b(of)f(the)g(total)g(run)g(times)f(are)h(less)g
(than)g(three)g(percent\).)2152 5149 y(The)32 b(measurements)h
(establish)f(tw)o(o)f(results.)h(First,)e(the)i(base)g(per)o(\255)2040
5232 y(formance)26 b(of)f(unaltered)g(UNIX)g(applications)g(link)o(ed)h
(against)f(ExOS)f(is)2040 5315 y(comparable)i(to)f(OpenBSD)g(and)h
(FreeBSD.)d(Untrusted)i(libOSes)g(on)g(an)2040 5398 y(e)o(xok)o(ernel)
17 b(can)f(support)h(unchanged)h(UNIX)d(applications)h(with)f(the)h
(same)1922 5647 y(8)p eop
%%Page: 9 9
9 8 bop -152 -69 a Fq(performance)31 b(as)f(centralized)g(monolithic)h
(UNIX)e(operating)i(systems.)-152 14 y(Second,)g(because)h(of)f(ExOS')l
(s)e(high\255performance)k(\002le)d(system,)g(some)-152
97 y(unaltered)17 b(UNIX)f(applications)g(perform)h(better)f(on)g(ExOS)
f(than)i(on)f(Free\255)-152 180 y(BSD)23 b(and)h(OpenBSD.)g
(Applications)g(do)g(not)g(need)h(to)e(be)i(re\255written)e(or)-152
263 y(e)n(v)o(en)d(modi\002ed)f(in)g(order)h(to)e(tak)o(e)i(adv)n
(antage)h(of)d(an)i(e)o(xok)o(ernel.)-40 346 y(It)i(is)g(important)h
(to)g(note)f(that)h(a)f(suf)n(\002ciently)h(moti)n(v)n(ated)g(k)o
(ernel)g(pro\255)-152 429 y(grammer)k(can)f(implement)g(an)o(y)h
(optimization)f(that)g(is)f(implemented)i(in)-152 512
y(an)33 b(e)o(xtensible)g(system.)f(In)g(f)o(act,)g(a)g(member)h(of)f
(our)h(research)g(group,)-152 596 y(Costa)f(Sapuntzakis,)f(has)h
(implemented)g(a)f(v)o(ersion)h(of)g(C\255FFS)d(within)-152
679 y(OpenBSD.)23 b(Extensible)g(systems)h(\(and)g(we)f(belie)n(v)o(e)g
(e)o(xok)o(ernels)i(in)e(par)o(\255)-152 762 y(ticular\))c(mak)o(e)h
(these)g(optimizations)g(signi\002cantly)g(easier)f(to)g(implement)-152
845 y(than)h(centralized)g(systems)g(do.)g(F)o(or)e(e)o(xample,)i
(porting)g(C\255FFS)e(to)h(Open\255)-152 928 y(BSD)k(took)i(more)f(ef)n
(fort)g(than)g(designing)i(C\255FFS)c(and)i(implementing)h(it)-152
1011 y(as)i(a)g(library)f(\002le)g(system.)h(The)f(e)o(xperiments)i
(belo)n(w)f(demonstrate)h(that)-152 1094 y(by)21 b(using)g(unpri)n
(vile)o(ged)h(application\255le)n(v)o(el)g(resource)f(management,)h(an)
o(y)-152 1177 y(skilled)k(programmer)i(can)e(implement)h(useful)f(OS)f
(optimizations.)i(The)-152 1260 y(e)o(xtra)32 b(layer)h(of)f
(protection)g(required)h(to)f(mak)o(e)h(this)f(application\255le)n(v)o
(el)-152 1343 y(management)21 b(safe)e(costs)g(little.)-152
1532 y Fr(6.1)91 b(Base)21 b(system)h(perf)n(ormance)-152
1649 y Fq(W)-6 b(e)33 b(test)f(ExOS')l(s)h(base)g(performance)i(by)e
(running)h(the)g(I/O\255intensi)n(v)o(e)-152 1732 y(benchmarks)27
b(from)d(T)-6 b(able)25 b(1)g(o)o(v)o(er)g(ExOS')l(s)e(library)i
(implementation)h(of)-152 1815 y(C\255FFS)20 b(on)i(top)f(of)g(XN)g
(and)h(comparing)h(it)e(to)g(OpenBSD)g(with)g(a)g(C\255FFS)-152
1898 y(\002le)k(system.)h(The)g(w)o(orkload)g(in)g(the)g(e)o
(xperiments)g(represents)h(unmodi\255)-152 1981 y(\002ed)d(UNIX)f
(programs)i(in)m(v)o(olv)o(ed)g(with)e(installing)h(a)g(softw)o(are)g
(package:)-152 2064 y(cop)o(ying)g(a)d(compressed)i(archi)n(v)o(e)f
(\002le,)f(uncompressing)i(it,)e(unpacking)i(it)-152
2147 y(\(which)28 b(results)f(in)g(a)h(source)g(tree\),)e(cop)o(ying)j
(the)f(resulting)g(tree,)e(com\255)-152 2230 y(paring)g(the)f(tw)o(o)g
(trees,)g(compiling)h(the)f(source)h(tree,)e(deleting)i(binaries,)-152
2313 y(archi)n(ving)18 b(the)f(source)g(tree,)f(compressing)i(the)e
(archi)n(v)o(e)h(\002le,)f(and)h(deleting)-152 2396 y(the)i(source)h
(tree)f(\(see)g(T)-6 b(able)19 b(1\).)-40 2479 y(Figure)36
b(2)h(sho)n(ws)f(the)g(performance)i(of)e(these)g(applications)h(o)o(v)
o(er)-152 2562 y(Xok/ExOS,)d(OpenBSD/C\255FFS,)e(OpenBSD,)i(and)h
(FreeBSD.)e(T)-6 b(o)35 b(es\255)-152 2645 y(tablish)i(base)f(system)h
(performance,)g(we)f(compare)h(Xok/ExOS)f(with)-152 2728
y(OpenBSD/C\255FSS,)11 b(since)j(the)o(y)f(both)h(use)g(a)f(C\255FFS)e
(\002le)i(system.)g(The)g(total)-152 2811 y(running)j(time)e(for)h
(Xok/ExOS)f(is)g(41)h(seconds)h(and)f(for)g(OpenBSD/C\255FFS)-152
2894 y(is)h(51)h(seconds.)g(Since)f(ExOS)g(and)g(OpenBSD/C\255FFS)f
(use)h(the)h(same)f(type)-152 2977 y(of)i(\002le)f(system,)h(one)g(w)o
(ould)g(e)o(xpect)h(that)e(ExOS)g(and)i(OpenBSD)e(perform)-152
3060 y(equally)23 b(well.)f(As)g(can)h(be)f(seen)h(in)f(Figure)g(2,)g
(Xok/ExOS)g(performance)-152 3143 y(is)k(indeed)i(comparable)f(to)g
(OpenBSD/C\255FFS)d(on)j(eight)g(of)f(the)h(11)f(ap\255)-152
3226 y(plications.)k(On)g(three)f(applications)i(\(pax,)e(cp,)h(dif)n
(f\),)f(Xok/ExOS)g(runs)-152 3309 y(considerably)22 b(f)o(aster)e
(\(though)h(we)e(do)i(not)f(yet)g(ha)o(v)o(e)g(a)f(good)i(e)o
(xplanation)-152 3392 y(for)e(this\).)-40 3475 y(From)d(these)g
(measurements)h(we)f(conclude)i(that,)d(e)n(v)o(en)i(though)g(ExOS)-152
3558 y(implements)e(the)f(b)o(ulk)h(of)f(the)g(operating)h(system)g(at)
f(the)g(application)h(le)n(v)o(el,)-152 3641 y(common)25
b(softw)o(are)e(de)n(v)o(elopment)i(operations)f(on)f(Xok/ExOS)g
(perform)-152 3724 y(comparably)i(to)f(OpenBSD/C\255FFS.)d(The)o(y)j
(demonstrate)h(that\227at)e(least)-152 3807 y(for)16
b(this)g(common)i(domain)f(of)f(applications\227an)h(e)o(xok)o(ernel')l
(s)g(\003e)o(xibility)-152 3890 y(can)32 b(be)f(pro)o(vided)h(for)e
(free:)h(e)n(v)o(en)g(without)g(aggressi)n(v)o(e)h(optimizations)-152
3973 y(ExOS')l(s)c(performance)h(is)f(comparable)i(to)e(that)g(of)g
(mature)h(monolithic)-152 4056 y(systems.)19 b(The)g(cost)g(of)g(lo)n
(w\255le)n(v)o(el)g(multiple)o(xing)h(is)e(ne)o(gligible.)-152
4245 y Fr(6.2)91 b(In)l(visible)22 b(optimization)h(using)f(C\255FFS)
-152 4362 y Fq(These)33 b(comparisons)h(concentrate)g(on)g(I/O)e
(intensi)n(v)o(e)h(operations)h(that)-152 4445 y(e)o(xploit)26
b(the)f(C\255FFS)f(library)h(\002le)f(system)i([15)q(].)e(W)-6
b(e)25 b(again)g(use)h(the)f(I/O\255)-152 4528 y(intensi)n(v)o(e)11
b(benchmarks)g(described)g(in)g(T)-6 b(able)11 b(1,)g(b)o(ut)g(n)q(o)n
(w)g(co)q(mpa)q(re)g(Xok/C\255)-152 4611 y(FFS)24 b(with)h(OpenBSD)g
(and)h(FreeBSD.)e(As)h(Figure)h(2)f(sho)n(ws,)h(unaltered)-152
4694 y(UNIX)14 b(applications)i(can)e(run)h(signi\002cantly)g(f)o
(aster)f(on)h(top)g(of)f(Xok/ExOS.)-152 4777 y(Xok/ExOS)29
b(completes)g(all)f(benchmarks)i(in)f(41)g(seconds,)g(19)g(seconds)-152
4860 y(f)o(aster)20 b(than)h(FreeBSD)d(and)j(OpenBSD.)f(On)g(eight)g
(of)g(the)g(ele)n(v)o(en)h(bench\255)-152 4943 y(marks)d(Xok/ExOS)e
(performs)i(better)e(than)i(Free/OpenBSD)e(\(in)h(one)g(case)-152
5026 y(by)26 b(o)o(v)o(er)g(a)g(f)o(actor)g(of)f(four\).)g(ExOS')l(s)g
(performance)i(impro)o(v)o(ements)g(are)-152 5109 y(due)20
b(to)f(its)f(C\255FFS)f(\002le)h(system.)-40 5192 y(W)-6
b(e)32 b(also)g(ran)h(the)f(Modi\002ed)h(Andre)n(w)f(Benchmark)i
(\(MAB\))e([33].)-152 5275 y(On)25 b(this)g(benchmark,)h(Xok/ExOS)f
(tak)o(es)h(11.5)f(seconds,)h(OpenBSD/C\255)-152 5358
y(FFS)d(tak)o(es)i(12.5)g(seconds,)g(OpenBSD)g(tak)o(es)g(14.2)g
(seconds,)g(and)g(Free\255)p 2121 -72 1831 4 v 2119 3
4 75 v 2166 -20 a Fg(Benchmark)p 2617 3 V 167 w(Description)19
b(\(application\))p 3950 3 V 2121 6 1831 4 v 2119 81
4 75 v 2166 58 a Ff(Cop)o(y)f(small)f(\002le)p 2617 81
V 93 w(cop)o(y)h(the)g(compressed)g(archi)n(v)o(ed)i(source)e(tree)g
(\(cp\))p 3950 81 V 2121 84 1831 4 v 2119 159 4 75 v
2166 136 a(Uncompress)p 2617 159 V 166 w(uncompress)g(the)g(archi)n(v)o
(e)h(\(gunzip\))p 3950 159 V 2121 162 1831 4 v 2119 237
4 75 v 2166 214 a(Cop)o(y)f(lar)o(ge)g(\002le)p 2617
237 V 105 w(cop)o(y)g(the)g(uncompressed)h(archi)n(v)o(e)g(\(cp\))p
3950 237 V 2121 240 1831 4 v 2119 315 4 75 v 2166 292
a(Unpack)f(\002le)p 2617 315 V 190 w(unpack)h(archi)n(v)o(e)g(\(pax\))p
3950 315 V 2121 318 1831 4 v 2119 393 4 75 v 2166 371
a(Cop)o(y)f(lar)o(ge)g(tree)p 2617 393 V 91 w(recursi)n(v)o(ely)i(cop)o
(y)e(the)g(created)i(directories)f(\(cp\).)p 3950 393
V 2121 396 1831 4 v 2119 471 4 75 v 2166 449 a(Dif)n(f)f(lar)o(ge)g
(tree)p 2617 471 V 125 w(compute)h(the)e(dif)n(ference)k(between)d(the)
g(trees)g(\(dif)n(f\))p 3950 471 V 2121 474 1831 4 v
2119 549 4 75 v 2166 527 a(Compile)p 2617 549 V 270 w(compile)h(source)
f(code)g(\(gcc\))p 3950 549 V 2121 552 1831 4 v 2119
627 4 75 v 2166 605 a(Delete)h(\002les)p 2617 627 V 197
w(delete)h(binary)e(\002les)f(\(rm\))p 3950 627 V 2121
630 1831 4 v 2119 705 4 75 v 2166 683 a(P)o(ack)h(tree)p
2617 705 V 254 w(archi)n(v)o(e)i(the)d(tree)i(\(pax\))p
3950 705 V 2121 708 1831 4 v 2119 783 4 75 v 2166 761
a(Compress)p 2617 783 V 232 w(compress)f(the)g(archi)n(v)o(e)h(tree)f
(\(gzip\))p 3950 783 V 2121 786 1831 4 v 2119 861 4 75
v 2166 839 a(Delete)p 2617 861 V 326 w(delete)i(the)d(created)j(source)
e(tree)g(\(rm\))p 3950 861 V 2121 865 1831 4 v 2040 1006
a Fq(T)-6 b(able)16 b(1:)g(The)f(I/O\255intensi)n(v)o(e)h(w)o(orkload)h
(installs)e(a)h(lar)o(ge)g(application)g(\(the)2040 1089
y(lcc)j(compiler\).)g(The)h(size)f(of)g(the)g(compressed)i(archi)n(v)o
(e)f(\002le)e(for)h(lcc)g(is)g(1.1)2040 1172 y(MByte.)2153
2527 y @beginspecial -42 @llx -38 @lly 577 @urx 365 @ury
2160 @rwi @setspecial
%%BeginDocument: exos-cffs.ps
1 setlinecap 1 setlinejoin
0.700 setlinewidth
0.00 setgray

/Jrnd { exch cvi exch cvi dup 3 1 roll idiv mul } def
/JDEdict 8 dict def
JDEdict /mtrx matrix put
/JDE {
  JDEdict begin
  /yrad exch def
  /xrad exch def
  /savematrix mtrx currentmatrix def
  xrad yrad scale
  0 0 1 0 360 arc
  savematrix setmatrix
  end
} def
/JSTR {
  gsave 1 eq { gsave 1 setgray fill grestore } if
    exch neg exch neg translate 
    clip                        
    rotate                      
    4 dict begin
      pathbbox  /&top exch def
                /&right exch def
                /&bottom exch def
                &right sub /&width exch def
      newpath
      currentlinewidth mul round dup               
      &bottom exch Jrnd exch &top             
      4 -1 roll currentlinewidth mul setlinewidth  
      { &right exch moveto &width 0 rlineto stroke } for    
    end
  grestore
  newpath
} bind def
 gsave /Times-Roman findfont 9.000000 scalefont setfont
0.000000 0.000000 translate
0.700000 setlinewidth  gsave newpath 0.000000 0.000000 moveto 576.000000 0.000000 lineto stroke
/Helvetica-Bold findfont 18.000000 scalefont setfont
gsave 26.181816 -8.000000 translate 0.000000 rotate
0 -10.800000 translate (cp) dup stringwidth pop 2 div neg 0 moveto
show
grestore
gsave 78.545448 -8.000000 translate 0.000000 rotate
0 -10.800000 translate (gunzip) dup stringwidth pop 2 div neg 0 moveto
show
grestore
gsave 130.909088 -8.000000 translate 0.000000 rotate
0 -10.800000 translate (cp) dup stringwidth pop 2 div neg 0 moveto
show
grestore
gsave 183.272720 -8.000000 translate 0.000000 rotate
0 -10.800000 translate (pax) dup stringwidth pop 2 div neg 0 moveto
show
grestore
gsave 235.636353 -8.000000 translate 0.000000 rotate
0 -10.800000 translate (cp) dup stringwidth pop 2 div neg 0 moveto
show
grestore
gsave 288.000000 -8.000000 translate 0.000000 rotate
0 -10.800000 translate (diff) dup stringwidth pop 2 div neg 0 moveto
show
grestore
gsave 340.363617 -8.000000 translate 0.000000 rotate
0 -10.800000 translate (gcc) dup stringwidth pop 2 div neg 0 moveto
show
grestore
gsave 392.727264 -8.000000 translate 0.000000 rotate
0 -10.800000 translate (rm) dup stringwidth pop 2 div neg 0 moveto
show
grestore
gsave 445.090881 -8.000000 translate 0.000000 rotate
0 -10.800000 translate (pax) dup stringwidth pop 2 div neg 0 moveto
show
grestore
gsave 497.454529 -8.000000 translate 0.000000 rotate
0 -10.800000 translate (gzip) dup stringwidth pop 2 div neg 0 moveto
show
grestore
gsave 549.818176 -8.000000 translate 0.000000 rotate
0 -10.800000 translate (rm) dup stringwidth pop 2 div neg 0 moveto
show
grestore
gsave 288.000000 -26.799999 translate 0.000000 rotate
0 -10.800000 translate (Unmodified UNIX Programs) dup stringwidth pop 2 div neg 0 moveto
show
grestore
 grestore 
0.700000 setlinewidth  gsave newpath 0.000000 0.000000 moveto 0.000000 360.000000 lineto stroke
newpath 0.000000 0.000000 moveto -5.000000 0.000000 lineto stroke
newpath 0.000000 24.000000 moveto -2.000000 24.000000 lineto stroke
newpath 0.000000 48.000000 moveto -2.000000 48.000000 lineto stroke
newpath 0.000000 72.000000 moveto -2.000000 72.000000 lineto stroke
newpath 0.000000 96.000000 moveto -2.000000 96.000000 lineto stroke
newpath 0.000000 120.000000 moveto -5.000000 120.000000 lineto stroke
newpath 0.000000 144.000000 moveto -2.000000 144.000000 lineto stroke
newpath 0.000000 168.000000 moveto -2.000000 168.000000 lineto stroke
newpath 0.000000 192.000000 moveto -2.000000 192.000000 lineto stroke
newpath 0.000000 216.000000 moveto -2.000000 216.000000 lineto stroke
newpath 0.000000 240.000000 moveto -5.000000 240.000000 lineto stroke
newpath 0.000000 264.000000 moveto -2.000000 264.000000 lineto stroke
newpath 0.000000 288.000000 moveto -2.000000 288.000000 lineto stroke
newpath 0.000000 312.000000 moveto -2.000000 312.000000 lineto stroke
newpath 0.000000 336.000000 moveto -2.000000 336.000000 lineto stroke
newpath 0.000000 360.000000 moveto -5.000000 360.000000 lineto stroke
/Helvetica-Bold findfont 15.000000 scalefont setfont
gsave -8.000000 0.000000 translate 0.000000 rotate
0 -4.500000 translate (0) dup stringwidth pop neg 0 moveto
show
grestore
gsave -8.000000 120.000000 translate 0.000000 rotate
0 -4.500000 translate (5) dup stringwidth pop neg 0 moveto
show
grestore
gsave -8.000000 240.000000 translate 0.000000 rotate
0 -4.500000 translate (10) dup stringwidth pop neg 0 moveto
show
grestore
gsave -8.000000 360.000000 translate 0.000000 rotate
0 -4.500000 translate (15) dup stringwidth pop neg 0 moveto
show
grestore
/Helvetica-Bold findfont 18.000000 scalefont setfont
gsave -30.400000 180.000000 translate 90.000000 rotate
0 0.000000 translate (Runtime \(seconds\)) dup stringwidth pop 2 div neg 0 moveto
show
grestore
 grestore 
 gsave 
 gsave  gsave  10.472727 1.920000 translate 0.000000 rotate
 newpath 5.236363 0.000000 moveto  -5.236363 0.000000 lineto
  -5.236363 -1.920000 lineto
  5.236363 -1.920000 lineto
closepath gsave 0.000000 setgray  fill grestore
stroke
 grestore  gsave  62.836361 24.480000 translate 0.000000 rotate
 newpath 5.236363 0.000000 moveto  -5.236363 0.000000 lineto
  -5.236363 -24.480000 lineto
  5.236363 -24.480000 lineto
closepath gsave 0.000000 setgray  fill grestore
stroke
 grestore  gsave  115.199997 15.840000 translate 0.000000 rotate
 newpath 5.236363 0.000000 moveto  -5.236363 0.000000 lineto
  -5.236363 -15.840000 lineto
  5.236363 -15.840000 lineto
closepath gsave 0.000000 setgray  fill grestore
stroke
 grestore  gsave  167.563629 39.840000 translate 0.000000 rotate
 newpath 5.236363 0.000000 moveto  -5.236363 0.000000 lineto
  -5.236363 -39.840000 lineto
  5.236363 -39.840000 lineto
closepath gsave 0.000000 setgray  fill grestore
stroke
 grestore  gsave  219.927261 48.480000 translate 0.000000 rotate
 newpath 5.236363 0.000000 moveto  -5.236363 0.000000 lineto
  -5.236363 -48.480000 lineto
  5.236363 -48.480000 lineto
closepath gsave 0.000000 setgray  fill grestore
stroke
 grestore  gsave  272.290894 12.480000 translate 0.000000 rotate
 newpath 5.236363 0.000000 moveto  -5.236363 0.000000 lineto
  -5.236363 -12.480000 lineto
  5.236363 -12.480000 lineto
closepath gsave 0.000000 setgray  fill grestore
stroke
 grestore  gsave  324.654541 336.000000 translate 0.000000 rotate
 newpath 5.236363 0.000000 moveto  -5.236363 0.000000 lineto
  -5.236363 -336.000000 lineto
  5.236363 -336.000000 lineto
closepath gsave 0.000000 setgray  fill grestore
stroke
 grestore  gsave  377.018158 5.760000 translate 0.000000 rotate
 newpath 5.236363 0.000000 moveto  -5.236363 0.000000 lineto
  -5.236363 -5.760000 lineto
  5.236363 -5.760000 lineto
closepath gsave 0.000000 setgray  fill grestore
stroke
 grestore  gsave  429.381805 16.559999 translate 0.000000 rotate
 newpath 5.236363 0.000000 moveto  -5.236363 0.000000 lineto
  -5.236363 -16.559999 lineto
  5.236363 -16.559999 lineto
closepath gsave 0.000000 setgray  fill grestore
stroke
 grestore  gsave  481.745422 110.399994 translate 0.000000 rotate
 newpath 5.236363 0.000000 moveto  -5.236363 0.000000 lineto
  -5.236363 -110.399994 lineto
  5.236363 -110.399994 lineto
closepath gsave 0.000000 setgray  fill grestore
stroke
 grestore  gsave  534.109070 125.759995 translate 0.000000 rotate
 newpath 5.236363 0.000000 moveto  -5.236363 0.000000 lineto
  -5.236363 -125.759995 lineto
  5.236363 -125.759995 lineto
closepath gsave 0.000000 setgray  fill grestore
stroke
 grestore  grestore 
 gsave  gsave  314.181793 345.599976 translate 0.000000 rotate
/Times-Roman findfont 16.000000 scalefont setfont
gsave 0.000000 0.000000 translate 0.000000 rotate
0 -4.800000 translate (23.0) dup stringwidth pop 2 div neg 0 moveto
show
grestore
 grestore  grestore 
 gsave  gsave  20.945454 10.320000 translate 0.000000 rotate
 newpath 5.236363 0.000000 moveto  -5.236363 0.000000 lineto
  -5.236363 -10.320000 lineto
  5.236363 -10.320000 lineto
closepath gsave 0.500000 setgray  fill grestore
stroke
 grestore  gsave  73.309090 20.880001 translate 0.000000 rotate
 newpath 5.236363 0.000000 moveto  -5.236363 0.000000 lineto
  -5.236363 -20.880001 lineto
  5.236363 -20.880001 lineto
closepath gsave 0.500000 setgray  fill grestore
stroke
 grestore  gsave  125.672722 15.840000 translate 0.000000 rotate
 newpath 5.236363 0.000000 moveto  -5.236363 0.000000 lineto
  -5.236363 -15.840000 lineto
  5.236363 -15.840000 lineto
closepath gsave 0.500000 setgray  fill grestore
stroke
 grestore  gsave  178.036362 120.959999 translate 0.000000 rotate
 newpath 5.236363 0.000000 moveto  -5.236363 0.000000 lineto
  -5.236363 -120.959999 lineto
  5.236363 -120.959999 lineto
closepath gsave 0.500000 setgray  fill grestore
stroke
 grestore  gsave  230.399994 86.399994 translate 0.000000 rotate
 newpath 5.236363 0.000000 moveto  -5.236363 0.000000 lineto
  -5.236363 -86.399994 lineto
  5.236363 -86.399994 lineto
closepath gsave 0.500000 setgray  fill grestore
stroke
 grestore  gsave  282.763611 31.199999 translate 0.000000 rotate
 newpath 5.236363 0.000000 moveto  -5.236363 0.000000 lineto
  -5.236363 -31.199999 lineto
  5.236363 -31.199999 lineto
closepath gsave 0.500000 setgray  fill grestore
stroke
 grestore  gsave  335.127258 336.000000 translate 0.000000 rotate
 newpath 5.236363 0.000000 moveto  -5.236363 0.000000 lineto
  -5.236363 -336.000000 lineto
  5.236363 -336.000000 lineto
closepath gsave 0.500000 setgray  fill grestore
stroke
 grestore  gsave  387.490906 7.440000 translate 0.000000 rotate
 newpath 5.236363 0.000000 moveto  -5.236363 0.000000 lineto
  -5.236363 -7.440000 lineto
  5.236363 -7.440000 lineto
closepath gsave 0.500000 setgray  fill grestore
stroke
 grestore  gsave  439.854523 26.400002 translate 0.000000 rotate
 newpath 5.236363 0.000000 moveto  -5.236363 0.000000 lineto
  -5.236363 -26.400002 lineto
  5.236363 -26.400002 lineto
closepath gsave 0.500000 setgray  fill grestore
stroke
 grestore  gsave  492.218170 129.839996 translate 0.000000 rotate
 newpath 5.236363 0.000000 moveto  -5.236363 0.000000 lineto
  -5.236363 -129.839996 lineto
  5.236363 -129.839996 lineto
closepath gsave 0.500000 setgray  fill grestore
stroke
 grestore  gsave  544.581787 124.080002 translate 0.000000 rotate
 newpath 5.236363 0.000000 moveto  -5.236363 0.000000 lineto
  -5.236363 -124.080002 lineto
  5.236363 -124.080002 lineto
closepath gsave 0.500000 setgray  fill grestore
stroke
 grestore  grestore 
 gsave  gsave  329.890900 360.000000 translate 0.000000 rotate
/Times-Roman findfont 16.000000 scalefont setfont
gsave 0.000000 0.000000 translate 0.000000 rotate
0 -4.800000 translate (23.1) dup stringwidth pop 2 div neg 0 moveto
show
grestore
 grestore  grestore 
 gsave  gsave  31.418180 10.559999 translate 0.000000 rotate
 newpath 5.236363 0.000000 moveto  -5.236363 0.000000 lineto
  -5.236363 -10.559999 lineto
  5.236363 -10.559999 lineto
closepath gsave 1.000000 setgray  fill grestore
stroke
 grestore  gsave  83.781815 18.960001 translate 0.000000 rotate
 newpath 5.236363 0.000000 moveto  -5.236363 0.000000 lineto
  -5.236363 -18.960001 lineto
  5.236363 -18.960001 lineto
closepath gsave 1.000000 setgray  fill grestore
stroke
 grestore  gsave  136.145447 4.560000 translate 0.000000 rotate
 newpath 5.236363 0.000000 moveto  -5.236363 0.000000 lineto
  -5.236363 -4.560000 lineto
  5.236363 -4.560000 lineto
closepath gsave 1.000000 setgray  fill grestore
stroke
 grestore  gsave  188.509079 217.919998 translate 0.000000 rotate
 newpath 5.236363 0.000000 moveto  -5.236363 0.000000 lineto
  -5.236363 -217.919998 lineto
  5.236363 -217.919998 lineto
closepath gsave 1.000000 setgray  fill grestore
stroke
 grestore  gsave  240.872711 167.040009 translate 0.000000 rotate
 newpath 5.236363 0.000000 moveto  -5.236363 0.000000 lineto
  -5.236363 -167.040009 lineto
  5.236363 -167.040009 lineto
closepath gsave 1.000000 setgray  fill grestore
stroke
 grestore  gsave  293.236359 30.240000 translate 0.000000 rotate
 newpath 5.236363 0.000000 moveto  -5.236363 0.000000 lineto
  -5.236363 -30.240000 lineto
  5.236363 -30.240000 lineto
closepath gsave 1.000000 setgray  fill grestore
stroke
 grestore  gsave  345.599976 336.000000 translate 0.000000 rotate
 newpath 5.236363 0.000000 moveto  -5.236363 0.000000 lineto
  -5.236363 -336.000000 lineto
  5.236363 -336.000000 lineto
closepath gsave 1.000000 setgray  fill grestore
stroke
 grestore  gsave  397.963623 12.000000 translate 0.000000 rotate
 newpath 5.236363 0.000000 moveto  -5.236363 0.000000 lineto
  -5.236363 -12.000000 lineto
  5.236363 -12.000000 lineto
closepath gsave 1.000000 setgray  fill grestore
stroke
 grestore  gsave  450.327240 23.039999 translate 0.000000 rotate
 newpath 5.236363 0.000000 moveto  -5.236363 0.000000 lineto
  -5.236363 -23.039999 lineto
  5.236363 -23.039999 lineto
closepath gsave 1.000000 setgray  fill grestore
stroke
 grestore  gsave  502.690887 131.040009 translate 0.000000 rotate
 newpath 5.236363 0.000000 moveto  -5.236363 0.000000 lineto
  -5.236363 -131.040009 lineto
  5.236363 -131.040009 lineto
closepath gsave 1.000000 setgray  fill grestore
stroke
 grestore  gsave  555.054504 228.240005 translate 0.000000 rotate
 newpath 5.236363 0.000000 moveto  -5.236363 0.000000 lineto
  -5.236363 -228.240005 lineto
  5.236363 -228.240005 lineto
closepath gsave 1.000000 setgray  fill grestore
stroke
 grestore  grestore 
 gsave  gsave  345.599976 345.599976 translate 0.000000 rotate
/Times-Roman findfont 16.000000 scalefont setfont
gsave 0.000000 0.000000 translate 0.000000 rotate
0 -4.800000 translate (23.2) dup stringwidth pop 2 div neg 0 moveto
show
grestore
 grestore  grestore 
 gsave  gsave  41.890907 1.440000 translate 0.000000 rotate
 newpath 5.236363 0.000000 moveto  -5.236363 0.000000 lineto
  -5.236363 -1.440000 lineto
  5.236363 -1.440000 lineto
closepath gsave 0.750000 setgray  fill grestore
stroke
 grestore  gsave  94.254539 22.320000 translate 0.000000 rotate
 newpath 5.236363 0.000000 moveto  -5.236363 0.000000 lineto
  -5.236363 -22.320000 lineto
  5.236363 -22.320000 lineto
closepath gsave 0.750000 setgray  fill grestore
stroke
 grestore  gsave  146.618179 14.160000 translate 0.000000 rotate
 newpath 5.236363 0.000000 moveto  -5.236363 0.000000 lineto
  -5.236363 -14.160000 lineto
  5.236363 -14.160000 lineto
closepath gsave 0.750000 setgray  fill grestore
stroke
 grestore  gsave  198.981812 181.200012 translate 0.000000 rotate
 newpath 5.236363 0.000000 moveto  -5.236363 0.000000 lineto
  -5.236363 -181.200012 lineto
  5.236363 -181.200012 lineto
closepath gsave 0.750000 setgray  fill grestore
stroke
 grestore  gsave  251.345444 208.799988 translate 0.000000 rotate
 newpath 5.236363 0.000000 moveto  -5.236363 0.000000 lineto
  -5.236363 -208.799988 lineto
  5.236363 -208.799988 lineto
closepath gsave 0.750000 setgray  fill grestore
stroke
 grestore  gsave  303.709076 25.920002 translate 0.000000 rotate
 newpath 5.236363 0.000000 moveto  -5.236363 0.000000 lineto
  -5.236363 -25.920002 lineto
  5.236363 -25.920002 lineto
closepath gsave 0.750000 setgray  fill grestore
stroke
 grestore  gsave  356.072723 336.000000 translate 0.000000 rotate
 newpath 5.236363 0.000000 moveto  -5.236363 0.000000 lineto
  -5.236363 -336.000000 lineto
  5.236363 -336.000000 lineto
closepath gsave 0.750000 setgray  fill grestore
stroke
 grestore  gsave  408.436340 16.799999 translate 0.000000 rotate
 newpath 5.236363 0.000000 moveto  -5.236363 0.000000 lineto
  -5.236363 -16.799999 lineto
  5.236363 -16.799999 lineto
closepath gsave 0.750000 setgray  fill grestore
stroke
 grestore  gsave  460.799988 8.400000 translate 0.000000 rotate
 newpath 5.236363 0.000000 moveto  -5.236363 0.000000 lineto
  -5.236363 -8.400000 lineto
  5.236363 -8.400000 lineto
closepath gsave 0.750000 setgray  fill grestore
stroke
 grestore  gsave  513.163635 130.799988 translate 0.000000 rotate
 newpath 5.236363 0.000000 moveto  -5.236363 0.000000 lineto
  -5.236363 -130.799988 lineto
  5.236363 -130.799988 lineto
closepath gsave 0.750000 setgray  fill grestore
stroke
 grestore  gsave  565.527222 287.519989 translate 0.000000 rotate
 newpath 5.236363 0.000000 moveto  -5.236363 0.000000 lineto
  -5.236363 -287.519989 lineto
  5.236363 -287.519989 lineto
closepath gsave 0.750000 setgray  fill grestore
stroke
 grestore  grestore 
 gsave  gsave  361.309082 360.000000 translate 0.000000 rotate
/Times-Roman findfont 16.000000 scalefont setfont
gsave 0.000000 0.000000 translate 0.000000 rotate
0 -4.800000 translate (21.6) dup stringwidth pop 2 div neg 0 moveto
show
grestore
 grestore  grestore 
 grestore 
 gsave 20.945454 360.000000 translate 0.000000 rotate
 gsave  gsave  0.000000 -5.100000 translate 0.000000 rotate
 newpath -5.236363 -2.000000 moveto  5.236363 -2.000000 lineto
  5.236363 2.000000 lineto
  -5.236363 2.000000 lineto
closepath gsave 0.000000 setgray  fill grestore
stroke
 grestore  grestore 
/Helvetica-Bold findfont 17.000000 scalefont setfont
gsave 9.236363 0.000000 translate 0.000000 rotate
0 -10.200000 translate (Xok/ExOS) dup stringwidth pop pop 0 0 moveto
show
grestore
 gsave  gsave  0.000000 -25.500000 translate 0.000000 rotate
 newpath -5.236363 -2.000000 moveto  5.236363 -2.000000 lineto
  5.236363 2.000000 lineto
  -5.236363 2.000000 lineto
closepath gsave 0.500000 setgray  fill grestore
stroke
 grestore  grestore 
gsave 9.236363 -20.400000 translate 0.000000 rotate
0 -10.200000 translate (OpenBSD/C-FFS) dup stringwidth pop pop 0 0 moveto
show
grestore
 gsave  gsave  0.000000 -45.900002 translate 0.000000 rotate
 newpath -5.236363 -2.000000 moveto  5.236363 -2.000000 lineto
  5.236363 2.000000 lineto
  -5.236363 2.000000 lineto
closepath gsave 1.000000 setgray  fill grestore
stroke
 grestore  grestore 
gsave 9.236363 -40.799999 translate 0.000000 rotate
0 -10.200000 translate (OpenBSD) dup stringwidth pop pop 0 0 moveto
show
grestore
 gsave  gsave  0.000000 -66.300003 translate 0.000000 rotate
 newpath -5.236363 -2.000000 moveto  5.236363 -2.000000 lineto
  5.236363 2.000000 lineto
  -5.236363 2.000000 lineto
closepath gsave 0.750000 setgray  fill grestore
stroke
 grestore  grestore 
gsave 9.236363 -61.200001 translate 0.000000 rotate
0 -10.200000 translate (FreeBSD) dup stringwidth pop pop 0 0 moveto
show
grestore
 grestore 
0.000000 0.000000 translate
 grestore 
%%EndDocument
 @endspecial 2040 2620 a(Figure)65 b(2:)g(Performance)g(of)g
(unmodi\002ed)h(UNIX)f(applications.)2040 2703 y(Xok/ExOS)29
b(and)g(OpenBSD/C\255FFS)e(use)i(a)g(C\255FFS)d(\002le)j(system)g
(while)2040 2786 y(Free/OpenBSD)18 b(use)i(their)e(nati)n(v)o(e)i(FFS)d
(\002le)h(systems.)h(T)m(imes)g(are)g(in)f(sec\255)2040
2869 y(onds.)2040 3100 y(BSD)e(tak)o(es)g(11.5)h(seconds.)h(The)e(dif)n
(ference)h(in)f(performance)i(on)f(MAB)f(is)2040 3183
y(less)21 b(profound)h(than)f(on)g(the)g(I/O\255intensi)n(v)o(e)f
(benchmark,)j(because)e(MAB)2040 3266 y(stresses)15 b(fork,)g(an)g(e)o
(xpensi)n(v)o(e)h(function)f(in)g(Xok/ExOS.)f(ExOS')l(s)g(fork)h(per)o
(\255)2040 3349 y(formance)23 b(suf)n(fers)f(because)h(Xok)f(does)h
(not)f(yet)f(allo)n(w)h(en)m(vironments)h(to)2040 3432
y(share)d(page)h(tables.)f(F)o(ork)f(tak)o(es)i(six)e(milliseconds)i
(on)f(ExOS,)f(compared)2040 3515 y(to)g(less)g(than)g(one)h
(millisecond)f(on)g(OpenBSD.)2040 3704 y Fr(6.3)91 b(The)22
b(cost)g(of)h(pr)n(otection)2040 3821 y Fq(In)c(this)g(section,)g(we)g
(in)m(v)o(estigate)g(the)g(cost)g(of)g(protection)h(on)f(Xok/ExOS.)2040
3904 y(As)27 b(discussed)g(in)g(the)g(pre)n(vious)h(section,)e(we)h(ha)
o(v)o(e)g(not)g(yet)f(completed)2040 3987 y(the)j(protected)h
(implementation)g(of)f(all)g(data)g(structures.)g(ExOS)f(stores)2040
4070 y(some)c(tables)g(in)f(writeable)h(global)g(shared)g(memory)-5
b(,)25 b(including)f(the)g(\002le)2040 4153 y(descriptor)34
b(table.)f(In)g(order)h(for)f(our)h(measurements)g(to)f(estimate)g(the)
2040 4236 y(performance)26 b(of)f(a)g(fully)g(protected)h(ExOS,)e(we)h
(inserted)g(three)g(system)2040 4319 y(calls)g(before)h(e)n(v)o(ery)g
(write)f(to)g(these)g(shared)i(tables.)e(All)f(measurements)2040
4402 y(reported)c(in)f(Section)f(6)h(include)h(these)f(e)o(xtra)g
(calls.)2152 4485 y(T)-6 b(o)24 b(measure)h(the)f(costs)g(of)h(all)e
(protection)i(we)f(ran)g(the)h(benchmarks)2040 4568 y(presented)d(in)e
(Figure)h(2)g(without)g(XN)f(or)h(an)o(y)g(of)g(the)f(e)o(xtra)h
(system)g(calls.)2040 4651 y(This)d(reduces)i(the)e(o)o(v)o(erall)h
(number)h(of)e(Xok)h(system)g(calls)f(from)h(300,000)2040
4734 y(to)13 b(81,000,)h(b)o(ut)f(only)g(changes)i(the)e(total)g
(running)h(time)e(from)i(41.1)f(seconds)2040 4817 y(to)19
b(39.7)h(seconds.)g(Real)e(w)o(orkloads)j(are)e(dominated)h(by)f(costs)
h(other)f(than)2040 4900 y(system)g(call)g(o)o(v)o(erhead.)2152
4983 y(T)-6 b(o)18 b(in)m(v)o(estigate)f(the)h(cost)g(of)g(protection)g
(in)g(more)g(detail,)f(we)h(measure)2040 5066 y(the)d(cost)f(of)h(the)g
(protection)g(mechanisms)h(described)f(in)g(Section)f(3.)h(W)-6
b(e)14 b(do)2040 5149 y(so)23 b(by)f(comparing)i(tw)o(o)e
(implementations)i(of)e(pipes)h(\(see)f(T)-6 b(able)22
b(2\).)g(The)2040 5232 y(\002rst)15 b(implementation)i(places)f(all)g
(data)g(in)g(shared)h(memory)f(and)h(performs)2040 5315
y(no)25 b(sanity)f(checking.)h(The)f(second)h(implementation)g(uses)f
(softw)o(are)h(re\255)2040 5398 y(gions)c(to)f(protect)g(pipe)g(data)g
(and)h(installs)e(a)h(w)o(ak)o(eup)i(predicate)e(on)h(e)n(v)o(ery)1922
5647 y(9)p eop
%%Page: 10 10
10 9 bop -75 -72 1839 4 v -77 3 4 75 v -30 -20 a Fg(Benchmark)p
461 3 V 207 w(Shar)o(ed)17 b(memory)p 1005 3 V 92 w(Pr)o(otection)p
1388 3 V 92 w(OpenBSD)p 1762 3 V -75 6 1839 4 v -77 81
4 75 v -30 58 a Ff(Latenc)o(y)i(1\255byte)p 461 81 V
139 w(13)p 1005 81 V 478 w(30)p 1388 81 V 318 w(34)p
1762 81 V -77 156 V -30 133 a(Latenc)o(y)g(8\255Kbyte)p
461 156 V 91 w(150)p 1005 156 V 445 w(148)p 1388 156
V 285 w(160)p 1762 156 V -75 159 1839 4 v -152 300 a
Fq(T)-6 b(able)19 b(2:)f(The)h(cost)f(of)h(a)f(local\255trust)h
(implementation)g(of)g(pipes)g(\(times)f(in)-152 383
y(microseconds\).)-152 622 y(read)d(\(something)f(unnecessary)i(e)n(v)o
(en)f(with)e(mutual)i(distrust\).)e(The)h(results)-152
705 y(sho)n(w)h(that)f(e)n(v)o(en)g(with)g(gratuitous)h(use)f(of)g
(Xok')l(s)g(protection)h(mechanisms,)-152 788 y(user)o(\255le)n(v)o(el)
k(pipes)h(can)f(still)f(outperform)i(OpenBSD.)-152 984
y Fr(7)91 b(Exploiting)23 b(Extensibility)g(in)g(A)n(pplications)-152
1136 y Fq(This)k(section)g(demonstrates)h(some)f(of)f(the)h
(interesting)g(possibilities)g(in)-152 1220 y(functionality)11
b(and)g(performance)g(enabled)g(by)h(app)q(lication\255le)n(v)o(el)f
(reso)q(urce)-152 1303 y(management.)24 b(W)-6 b(e)21
b(report)h(on)h(a)f(binary)h(emulator)m(,)f(a)g(\223zero\255touch\224)h
(\002le\255)-152 1386 y(cop)o(y)j(program,)f(and)h(the)e(Cheetah)i(web)
f(serv)o(er)l(.)f(Because)h(XN)g(w)o(as)f(de\255)-152
1469 y(v)o(eloped)18 b(recently)-5 b(,)17 b(the)f(applications)h(in)g
(this)f(section)h(were)f(not)h(measured)-152 1552 y(with)i(XN.)-152
1739 y Fr(7.1)91 b(F)n(ast,)22 b(simple)g(binary)g(emulation)-152
1856 y Fq(Xok)k(pro)o(vides)g(f)o(acilities)e(to)i(ef)n(\002ciently)f
(reroute)g(speci\002c)g(INT)g(instruc\255)-152 1939 y(tions.)16
b(W)-6 b(e)14 b(ha)o(v)o(e)i(used)g(this)g(ability)f(to)g(b)o(uild)g(a)
h(binary)g(emulator)g(for)f(Open\255)-152 2022 y(BSD)20
b(applications)h(by)g(capturing)h(the)f(system)f(calls)h(made)g(by)g
(emulated)-152 2105 y(OpenBSD)h(programs.)f(This)g(binary)h(emulator)g
(is)f(useful)h(for)f(OpenBSD)-152 2188 y(programs)33
b(for)f(which)g(we)g(do)g(not)g(ha)o(v)o(e)h(source)f(code.)h(Although)
g(the)-152 2271 y(emulator)19 b(is)f(only)h(partially)g(completed)g
(\(it)f(supports)i(90)f(of)f(the)h(approxi\255)-152 2354
y(mately)f(155)g(OpenBSD)g(system)g(calls\),)f(initial)f(results)i(are)
f(promising:)h(it)-152 2437 y(has)i(been)f(able)h(to)e(e)o(x)o(ecute)i
(lar)o(ge)f(programs)h(such)f(as)g(Mosaic.)-40 2520 y(The)e(main)f
(interesting)g(feature)h(of)f(the)g(emulator)h(is)e(that)h(it)g(runs)g
(in)h(the)-152 2603 y(same)12 b(address)g(space)g(as)g(the)g(emulated)g
(pro)q(gram,)g(an)q(d)g(co)q(nseq)q(uen)q(tly)g(do)q(es)-152
2686 y(not)19 b(need)g(an)o(y)g(pri)n(vile)o(ge.)f(Measurements)i(sho)n
(w)f(that)f(most)g(programs)h(on)-152 2769 y(the)f(emulator)f(run)h
(only)g(a)f(fe)n(w)g(percent)h(slo)n(wer)f(than)h(the)f(same)h
(programs)-152 2852 y(running)i(directly)f(under)h(Xok/ExOS.)-40
2935 y(A)j(counter)o(\255intuiti)n(v)o(e)h(result)f(is)f(that,)h
(because)h(the)g(emulator)f(runs)h(in)-152 3018 y(the)31
b(same)f(address)h(space)g(as)g(ExOS,)e(it)g(is)h(possible)h(to)f(run)h
(emulated)-152 3101 y(programs)d(f)o(aster)g(than)f(on)h(their)f(nati)n
(v)o(e)g(OS.)g(F)o(or)f(e)o(xample,)i(the)f(tri)n(vial)-152
3184 y(\223get)18 b(process)f(id\224)h(system)f(call)g(tak)o(es)g(270)h
(c)o(ycles)g(on)f(OpenBSD)g(and)h(100)-152 3267 y(c)o(ycles)h(on)g(the)
f(emulator)h(running)g(on)g(Xok/ExOS)f(\(on)g(a)g(120\255MHz)i(Intel)
-152 3350 y(Pentium\).)29 b(This)f(dif)n(ference)i(comes)g(from)e(the)h
(f)o(act)g(that)g(the)g(emulator)-152 3433 y(replaces)f(OpenBSD)f
(system)g(calls)g(with)f(procedure)j(calls)e(into)g(ExOS.)-152
3516 y(ExOS)e(can)h(omit)f(man)o(y)h(e)o(xpensi)n(v)o(e)g(checks)h
(that)e(UNIX)g(must)g(perform)-152 3599 y(in)31 b(order)g(to)f(guard)i
(against)f(application)g(errors)g(\(on)f(an)h(e)o(xok)o(ernel,)h(if)
-152 3683 y(an)f(application)g(passes)f(the)g(wrong)h(ar)o(guments)g
(to)f(a)g(libOS,)f(only)i(the)-152 3766 y(application)20
b(will)e(be)h(af)n(fected\).)-152 3953 y Fr(7.2)91 b(XCP:)23
b(a)f(\223zer)n(o\255touch\224)f(\002le)h(copying)f(pr)n(ogram)-152
4070 y Fe(XCP)g Fq(is)g(an)g(ef)n(\002cient)f(\002le)g(cop)o(y)j
(program.)e(It)f(e)o(xploits)h(the)g(lo)n(w\255le)n(v)o(el)g(disk)-152
4153 y(interf)o(ace)31 b(by)g(remo)o(ving)h(arti\002cial)e(ordering)h
(constraints,)g(by)g(impro)o(v\255)-152 4236 y(ing)d(disk)g(scheduling)
h(through)g(lar)o(ge)f(schedules,)g(by)h(eliminating)e(data)-152
4319 y(touching)c(by)f(the)f(CPU,)f(and)i(by)f(performing)i(all)d(disk)
i(operations)g(asyn\255)-152 4402 y(chronously)-5 b(.)-40
4485 y(Gi)n(v)o(en)22 b(a)f(list)g(of)g(\002les,)f Fe(XCP)i
Fq(w)o(orks)g(as)f(follo)n(ws.)g(First,)f(it)h(enumerates)-152
4568 y(and)f(sorts)f(the)g(disk)h(blocks)f(of)g(all)g(\002les)f(and)i
(issues)f(lar)o(ge,)g(asynchronous)-152 4651 y(disk)29
b(reads)g(using)h(this)e(schedule.)i(\(If)e(multiple)g(instances)i(of)f
Fe(XCP)f Fq(run)-152 4734 y(concurrently)-5 b(,)24 b(the)f(disk)g(dri)n
(v)o(er)g(will)f(mer)o(ge)h(the)g(schedules.\))g(Second,)g(it)-152
4817 y(creates)30 b(ne)n(w)f(\002les)g(of)g(the)g(correct)g(size,)g(o)o
(v)o(erlapping)i(inode)f(and)f(disk)-152 4900 y(block)19
b(allocation)f(with)f(the)h(disk)g(reads.)g(Finally)-5
b(,)17 b(as)g(the)h(disk)g(reads)g(com\255)-152 4983
y(plete,)28 b(it)g(constructs)h(lar)o(ge)f(writes)g(to)g(the)g(ne)n(w)h
(disk)f(blocks)i(using)f(the)-152 5066 y(b)o(uf)n(fer)23
b(cache)h(entries.)f(This)f(strate)o(gy)h(eliminates)g(all)f(copies;)i
(the)f(\002le)f(is)-152 5149 y(DMAed)c(into)e(and)h(out)g(of)g(the)f(b)
o(uf)n(fer)h(cache)g(by)g(the)g(disk)g(controller)o(\227the)-152
5232 y(CPU)h(ne)n(v)o(er)i(touches)g(the)f(data.)-40
5315 y Fe(XCP)27 b Fq(is)f(a)h(f)o(actor)f(of)h(three)g(f)o(aster)f
(than)h(the)g(cop)o(y)h(program)f(\()p Fe(CP)p Fq(\))f(on)-152
5398 y(Xok/ExOS)g(that)g(uses)g(UNIX)f(interf)o(aces,)i(irrespecti)n(v)
o(e)f(of)g(whether)g(all)2040 -69 y(\002les)e(are)g(in)g(core)h
(\(because)g Fe(XCP)f Fq(does)h(not)g(touch)g(the)f(data\))g(or)g(on)h
(disk)2040 14 y(\(because)32 b Fe(XCP)f Fq(issues)g(disk)g(schedules)h
(with)e(a)h(minimum)g(number)g(of)2040 97 y(seeks)20
b(and)f(the)g(lar)o(gest)g(contiguous)h(ranges)g(of)f(disk)g(blocks\).)
2152 180 y(The)j(f)o(act)f(that)h(the)g(\002le)e(system)i(is)g(an)g
(application)g(library)g(allo)n(ws)f(us)2040 263 y(both)e(to)e(ha)o(v)o
(e)h(inte)o(gration)h(when)f(appropriate)h(and)g(to)e(craft)h(ne)n(w)g
(abstrac\255)2040 346 y(tions)13 b(as)g(needed.)h(This)e(latter)h
(ability)f(is)h(especially)g(pro\002table)g(for)g(the)g(disk)2040
429 y(both)19 b(because)h(of)f(the)f(high)i(cost)e(of)h(disk)g
(operations)h(and)f(because)h(of)e(the)2040 512 y(demonstrated)28
b(reluctance)e(of)h(operating)g(systems)f(v)o(endors)h(to)f(pro)o(vide)
2040 596 y(useful,)f(simple)g(impro)o(v)o(ements)g(to)g(their)g(interf)
o(aces)g(\(e.g.,)f(prefetching,)2040 679 y(asynchronous)f(reads)d(and)h
(writes,)f(\002ne\255grained)h(disk)f(restructuring)h(and)2040
762 y(\223sync\224)f(operations\).)2040 951 y Fr(7.3)91
b(The)22 b(Cheetah)f(HTTP/1.0)h(Ser)o(v)o(er)2040 1067
y Fq(The)28 b(e)o(xok)o(ernel)i(architecture)e(is)g(well)f(suited)i(to)
f(b)o(uilding)g(f)o(ast)g(serv)o(ers)2040 1150 y(\(e.g.,)22
b(for)g(NFS)g(serv)o(ers)h(or)f(web)h(serv)o(ers\).)g(Serv)o(er)f
(performance)i(is)e(cru\255)2040 1233 y(cial)e(to)g(client/serv)o(er)g
(applications)h([23],)f(and)g(the)g(I/O\255centric)g(nature)g(of)2040
1316 y(serv)o(ers)f(mak)o(es)h(operating)g(system\255based)g
(optimizations)g(pro\002table.)2152 1399 y(W)-6 b(e)32
b(ha)o(v)o(e)h(de)n(v)o(eloped)i(an)e(e)o(xtensible)g(I/O)f(library)h
(\(XIO\))f(for)g(f)o(ast)2040 1483 y(serv)o(ers)c(and)g(a)g(sample)g
(application)g(that)f(uses)h(it,)f(the)h(Cheetah)g(HTTP)2040
1566 y(serv)o(er)l(.)12 b(This)g(library)g(is)g(designed)g(to)g(allo)n
(w)g(application)g(writers)g(to)g(e)o(xploit)2040 1649
y(domain\255speci\002c)g(kno)n(wledge)g(and)g(to)g(simplify)g(the)g
(construction)g(of)g(high\255)2040 1732 y(performance)21
b(serv)o(ers)g(by)f(remo)o(ving)h(the)f(need)h(to)e(\223trick\224)h
(the)g(operating)2040 1815 y(system)25 b(into)g(doing)g(what)g(the)g
(application)g(requires)g(\(e.g.,)f(Harv)o(est)h([7])2040
1898 y(stores)30 b(cached)h(pages)g(in)e(multiple)h(directories)g(to)f
(achie)n(v)o(e)i(f)o(ast)f(name)2040 1981 y(lookup\).)2152
2064 y(An)18 b(HTTP)f(serv)o(er')l(s)h(task)h(is)e(simple:)h(gi)n(v)o
(en)h(a)f(client)g(request,)h(it)e(\002nds)2040 2147
y(the)29 b(appropriate)g(document)h(and)f(sends)h(it.)d(The)i(Cheetah)g
(W)-6 b(eb)28 b(serv)o(er)2040 2230 y(performs)f(the)f(follo)n(wing)h
(set)f(of)g(optimizations)h(as)f(well)f(as)i(others)f(not)2040
2313 y(listed)19 b(here.)2152 2396 y Fl(Mer)o(ged)c(File)f(Cache)h(and)
f(Retransmission)h(P)o(ool.)f Fq(Cheetah)i(a)o(v)o(oids)2040
2479 y(all)d(in\255memory)h(data)g(touching)h(\(by)e(the)h(CPU\))e(and)
i(the)g(need)g(for)f(a)h(distinct)2040 2562 y(TCP)k(retransmission)h
(pool)g(by)g(transmitting)g(\002le)f(data)h(directly)g(from)f(the)2040
2645 y(\002le)d(cache)h(using)g(precomputed)i(\002le)d(checksums)i
(\(which)e(are)h(stored)g(with)2040 2728 y(each)21 b(\002le\).)f(Data)g
(are)h(transmitted)f(\(and)h(retransmitted,)g(if)f(necessary\))h(to)
2040 2811 y(the)16 b(client)g(directly)g(from)g(the)g(\002le)f(cache)h
(without)g(CPU)f(cop)o(y)j(operations.)2040 2894 y(\(P)o(ai)g(et)h(al.)
f(ha)o(v)o(e)h(also)g(used)h(this)e(technique)j([34].\))2152
2977 y Fl(Kno)o(wledge\255based)j(P)o(ack)o(et)h(Mer)o(ging)o(.)f
Fq(Cheetah)h(e)o(xploits)g(kno)n(wl\255)2040 3060 y(edge)19
b(of)f(its)g(per)o(\255request)g(state)g(transitions)g(to)g(reduce)h
(the)g(number)g(of)f(I/O)2040 3143 y(actions)e(it)e(initiates.)g(F)o
(or)h(e)o(xample,)g(it)g(a)o(v)o(oids)g(sending)h(redundant)h(control)
2040 3226 y(pack)o(ets)i(by)f(delaying)h(A)m(CKs)e(on)h(client)f(HTTP)g
(requests,)h(since)f(it)g(kno)n(ws)2040 3309 y(it)k(will)f(be)h(able)h
(to)f(piggy\255back)i(them)e(on)h(the)f(response.)h(This)f
(optimiza\255)2040 3392 y(tion)28 b(is)g(particularly)g(v)n(aluable)h
(for)e(small)h(document)h(sizes,)f(where)g(the)2040 3475
y(reduction)e(represents)g(a)f(substantial)g(fraction)g(\(e.g.,)f
(20\045\))i(of)f(the)g(total)2040 3558 y(number)20 b(of)f(pack)o(ets.)
2152 3641 y Fl(HTML\255based)11 b(File)g(Gr)o(ouping)o(.)g
Fq(Cheetah)g(co\255locates)g(\002les)g(included)2040
3724 y(in)21 b(an)h(HTML)f(document)i(by)f(allocating)g(them)f(in)h
(disk)f(blocks)i(adjacent)2040 3807 y(to)29 b(that)f(\002le)g(when)i
(possible.)f(When)g(the)g(\002le)f(cache)h(does)h(not)f(capture)2040
3890 y(the)c(majority)h(of)f(client)g(requests,)h(this)f(e)o(xtension)h
(can)g(impro)o(v)o(e)g(HTTP)2040 3973 y(throughput)21
b(by)e(up)h(to)e(a)h(f)o(actor)g(of)g(tw)o(o.)2152 4056
y(Figure)14 b(3)g(sho)n(ws)h(HTTP)d(request)j(throughput)h(as)e(a)g
(function)h(of)f(the)g(re\255)2040 4139 y(quested)19
b(document)h(size)e(for)g(\002v)o(e)f(serv)o(ers:)h(the)h(NCSA)e(1.4.2)
h(serv)o(er)g([32)q(])2040 4222 y(running)j(on)f(OpenBSD)f(2.0,)h(the)f
(Harv)o(est)h(cache)g([7])f(running)i(on)f(Open\255)2040
4305 y(BSD)26 b(2.0,)g(the)h(base)g(sock)o(et\255based)h(serv)o(er)f
(running)h(on)f(OpenBSD)f(2.0)2040 4388 y(\(i.e.,)17
b(our)i(HTTP)e(serv)o(er)i(without)g(an)o(y)g(optimizations\),)g(the)f
(base)i(sock)o(et\255)2040 4471 y(based)g(serv)o(er)g(running)h(on)f
(the)f(Xok)h(e)o(xok)o(ernel)h(system)f(\(i.e.,)e(our)i(HTTP)2040
4554 y(serv)o(er)28 b(without)f(an)o(y)i(optimizations)f(with)f(v)n
(anilla)h(sock)o(et)g(and)g(\002le)f(de\255)2040 4637
y(scriptor)15 b(implementations)g(layered)g(o)o(v)o(er)g(XIO\),)e(and)j
(the)e(Cheetah)h(serv)o(er)2040 4720 y(running)22 b(on)e(the)h(Xok)g(e)
o(xok)o(ernel)h(\(i.e.,)d(our)h(HTTP)f(serv)o(er)i(with)f(all)f
(opti\255)2040 4803 y(mizations)g(enabled\).)2152 4886
y(Figure)c(3)g(pro)o(vides)g(se)n(v)o(eral)h(important)f(pieces)g(of)g
(information.)g(First,)2040 4969 y(our)c(base)g(HTTP)g(serv)o(er)g
(performs)g(roughly)g(as)g(well)g(as)h(the)f(Harvest)g(cach)q(e,)2040
5052 y(which)20 b(has)g(been)g(sho)n(wn)g(to)f(outperform)i(man)o(y)f
(other)f(HTTP)f(serv)o(er)i(im\255)2040 5135 y(plementations)h(on)g
(general\255purpose)h(operating)g(systems.)e(Both)g(outper)o(\255)2040
5218 y(form)28 b(the)g(NCSA)f(serv)o(er)l(.)g(This)h(gi)n(v)o(es)g(us)g
(a)g(reasonable)h(starting)f(point)2040 5302 y(for)h(e)n(v)n(aluating)g
(e)o(xtensions)h(that)f(impro)o(v)o(e)g(performance.)g(Second,)g(the)
2040 5385 y(def)o(ault)19 b(sock)o(et)h(and)g(\002le)e(system)h
(implementations)h(b)o(uilt)e(on)h(top)g(of)g(XIO)1903
5647 y(10)p eop
%%Page: 11 11
11 10 bop -47 1059 a @beginspecial -56 @llx -38 @lly
577 @urx 361 @ury 2160 @rwi @setspecial
%%BeginDocument: cheetah.ps
1 setlinecap 1 setlinejoin
0.700 setlinewidth
0.00 setgray

/Jrnd { exch cvi exch cvi dup 3 1 roll idiv mul } def
/JDEdict 8 dict def
JDEdict /mtrx matrix put
/JDE {
  JDEdict begin
  /yrad exch def
  /xrad exch def
  /savematrix mtrx currentmatrix def
  xrad yrad scale
  0 0 1 0 360 arc
  savematrix setmatrix
  end
} def
/JSTR {
  gsave 1 eq { gsave 1 setgray fill grestore } if
    exch neg exch neg translate 
    clip                        
    rotate                      
    4 dict begin
      pathbbox  /&top exch def
                /&right exch def
                /&bottom exch def
                &right sub /&width exch def
      newpath
      currentlinewidth mul round dup               
      &bottom exch Jrnd exch &top             
      4 -1 roll currentlinewidth mul setlinewidth  
      { &right exch moveto &width 0 rlineto stroke } for    
    end
  grestore
  newpath
} bind def
 gsave /Times-Roman findfont 9.000000 scalefont setfont
0.000000 0.000000 translate
0.700000 setlinewidth  gsave newpath 0.000000 0.000000 moveto 576.000000 0.000000 lineto stroke
/Helvetica-Bold findfont 18.000000 scalefont setfont
gsave 38.400002 -8.000000 translate 0.000000 rotate
0 -10.800000 translate (0 Byte) dup stringwidth pop 2 div neg 0 moveto
show
grestore
gsave 153.600006 -8.000000 translate 0.000000 rotate
0 -10.800000 translate ( 100 Byte) dup stringwidth pop 2 div neg 0 moveto
show
grestore
gsave 288.000000 -8.000000 translate 0.000000 rotate
0 -10.800000 translate (1 KByte) dup stringwidth pop 2 div neg 0 moveto
show
grestore
gsave 403.200012 -8.000000 translate 0.000000 rotate
0 -10.800000 translate (10 KByte) dup stringwidth pop 2 div neg 0 moveto
show
grestore
gsave 518.400024 -8.000000 translate 0.000000 rotate
0 -10.800000 translate (100 KByte) dup stringwidth pop 2 div neg 0 moveto
show
grestore
gsave 288.000000 -26.799999 translate 0.000000 rotate
0 -10.800000 translate (HTTP page size) dup stringwidth pop 2 div neg 0 moveto
show
grestore
 grestore 
0.700000 setlinewidth  gsave newpath 0.000000 0.000000 moveto 0.000000 360.000000 lineto stroke
newpath 0.000000 0.000000 moveto -5.000000 0.000000 lineto stroke
newpath 0.000000 44.444447 moveto -2.000000 44.444447 lineto stroke
newpath 0.000000 88.888893 moveto -5.000000 88.888893 lineto stroke
newpath 0.000000 133.333344 moveto -2.000000 133.333344 lineto stroke
newpath 0.000000 177.777786 moveto -5.000000 177.777786 lineto stroke
newpath 0.000000 222.222229 moveto -2.000000 222.222229 lineto stroke
newpath 0.000000 266.666687 moveto -5.000000 266.666687 lineto stroke
newpath 0.000000 311.111115 moveto -2.000000 311.111115 lineto stroke
newpath 0.000000 355.555573 moveto -5.000000 355.555573 lineto stroke
/Helvetica-Bold findfont 15.000000 scalefont setfont
gsave -8.000000 0.000000 translate 0.000000 rotate
0 -4.500000 translate (0) dup stringwidth pop neg 0 moveto
show
grestore
gsave -8.000000 88.888893 translate 0.000000 rotate
0 -4.500000 translate (2000) dup stringwidth pop neg 0 moveto
show
grestore
gsave -8.000000 177.777786 translate 0.000000 rotate
0 -4.500000 translate (4000) dup stringwidth pop neg 0 moveto
show
grestore
gsave -8.000000 266.666687 translate 0.000000 rotate
0 -4.500000 translate (6000) dup stringwidth pop neg 0 moveto
show
grestore
gsave -8.000000 355.555573 translate 0.000000 rotate
0 -4.500000 translate (8000) dup stringwidth pop neg 0 moveto
show
grestore
/Helvetica-Bold findfont 18.000000 scalefont setfont
gsave -44.799999 180.000000 translate 90.000000 rotate
0 0.000000 translate (Throughput \(requests/second\)) dup stringwidth pop 2 div neg 0 moveto
show
grestore
 grestore 
 gsave 
 gsave  gsave  19.200001 27.777779 translate 0.000000 rotate
 newpath 9.600000 0.000000 moveto  -9.600000 0.000000 lineto
  -9.600000 -27.777779 lineto
  9.600000 -27.777779 lineto
closepath gsave 0.000000 setgray  fill grestore
stroke
 grestore  gsave  134.400009 25.911112 translate 0.000000 rotate
 newpath 9.600000 0.000000 moveto  -9.600000 0.000000 lineto
  -9.600000 -25.911112 lineto
  9.600000 -25.911112 lineto
closepath gsave 0.000000 setgray  fill grestore
stroke
 grestore  gsave  249.600006 24.444445 translate 0.000000 rotate
 newpath 9.600000 0.000000 moveto  -9.600000 0.000000 lineto
  -9.600000 -24.444445 lineto
  9.600000 -24.444445 lineto
closepath gsave 0.000000 setgray  fill grestore
stroke
 grestore  gsave  364.800018 15.866667 translate 0.000000 rotate
 newpath 9.600000 0.000000 moveto  -9.600000 0.000000 lineto
  -9.600000 -15.866667 lineto
  9.600000 -15.866667 lineto
closepath gsave 0.000000 setgray  fill grestore
stroke
 grestore  gsave  480.000031 3.897778 translate 0.000000 rotate
 newpath 9.600000 0.000000 moveto  -9.600000 0.000000 lineto
  -9.600000 -3.897778 lineto
  9.600000 -3.897778 lineto
closepath gsave 0.000000 setgray  fill grestore
stroke
 grestore  grestore 
 gsave  gsave  38.400002 44.444447 translate 0.000000 rotate
 newpath 9.600000 0.000000 moveto  -9.600000 0.000000 lineto
  -9.600000 -44.444447 lineto
  9.600000 -44.444447 lineto
closepath gsave 0.500000 setgray  fill grestore
stroke
 grestore  gsave  153.600006 49.377777 translate 0.000000 rotate
 newpath 9.600000 0.000000 moveto  -9.600000 0.000000 lineto
  -9.600000 -49.377777 lineto
  9.600000 -49.377777 lineto
closepath gsave 0.500000 setgray  fill grestore
stroke
 grestore  gsave  268.800018 47.111111 translate 0.000000 rotate
 newpath 9.600000 0.000000 moveto  -9.600000 0.000000 lineto
  -9.600000 -47.111111 lineto
  9.600000 -47.111111 lineto
closepath gsave 0.500000 setgray  fill grestore
stroke
 grestore  gsave  384.000000 24.711111 translate 0.000000 rotate
 newpath 9.600000 0.000000 moveto  -9.600000 0.000000 lineto
  -9.600000 -24.711111 lineto
  9.600000 -24.711111 lineto
closepath gsave 0.500000 setgray  fill grestore
stroke
 grestore  gsave  499.200012 4.337778 translate 0.000000 rotate
 newpath 9.600000 0.000000 moveto  -9.600000 0.000000 lineto
  -9.600000 -4.337778 lineto
  9.600000 -4.337778 lineto
closepath gsave 0.500000 setgray  fill grestore
stroke
 grestore  grestore 
 gsave  gsave  57.600002 55.555557 translate 0.000000 rotate
 newpath 9.600000 0.000000 moveto  -9.600000 0.000000 lineto
  -9.600000 -55.555557 lineto
  9.600000 -55.555557 lineto
closepath gsave 1.000000 setgray  fill grestore
stroke
 grestore  gsave  172.800003 49.377777 translate 0.000000 rotate
 newpath 9.600000 0.000000 moveto  -9.600000 0.000000 lineto
  -9.600000 -49.377777 lineto
  9.600000 -49.377777 lineto
closepath gsave 1.000000 setgray  fill grestore
stroke
 grestore  gsave  288.000000 49.377777 translate 0.000000 rotate
 newpath 9.600000 0.000000 moveto  -9.600000 0.000000 lineto
  -9.600000 -49.377777 lineto
  9.600000 -49.377777 lineto
closepath gsave 1.000000 setgray  fill grestore
stroke
 grestore  gsave  403.200012 25.866667 translate 0.000000 rotate
 newpath 9.600000 0.000000 moveto  -9.600000 0.000000 lineto
  -9.600000 -25.866667 lineto
  9.600000 -25.866667 lineto
closepath gsave 1.000000 setgray  fill grestore
stroke
 grestore  gsave  518.400024 4.000000 translate 0.000000 rotate
 newpath 9.600000 0.000000 moveto  -9.600000 0.000000 lineto
  -9.600000 -4.000000 lineto
  9.600000 -4.000000 lineto
closepath gsave 1.000000 setgray  fill grestore
stroke
 grestore  grestore 
 gsave  gsave  76.800003 112.444450 translate 0.000000 rotate
 newpath 9.600000 0.000000 moveto  -9.600000 0.000000 lineto
  -9.600000 -112.444450 lineto
  9.600000 -112.444450 lineto
closepath gsave 0.400000 setgray  fill grestore
stroke
 grestore  gsave  192.000000 95.688889 translate 0.000000 rotate
 newpath 9.600000 0.000000 moveto  -9.600000 0.000000 lineto
  -9.600000 -95.688889 lineto
  9.600000 -95.688889 lineto
closepath gsave 0.400000 setgray  fill grestore
stroke
 grestore  gsave  307.200012 87.155556 translate 0.000000 rotate
 newpath 9.600000 0.000000 moveto  -9.600000 0.000000 lineto
  -9.600000 -87.155556 lineto
  9.600000 -87.155556 lineto
closepath gsave 0.400000 setgray  fill grestore
stroke
 grestore  gsave  422.400024 50.400002 translate 0.000000 rotate
 newpath 9.600000 0.000000 moveto  -9.600000 0.000000 lineto
  -9.600000 -50.400002 lineto
  9.600000 -50.400002 lineto
closepath gsave 0.400000 setgray  fill grestore
stroke
 grestore  gsave  537.600037 7.155556 translate 0.000000 rotate
 newpath 9.600000 0.000000 moveto  -9.600000 0.000000 lineto
  -9.600000 -7.155556 lineto
  9.600000 -7.155556 lineto
closepath gsave 0.400000 setgray  fill grestore
stroke
 grestore  grestore 
 gsave  gsave  96.000000 348.888885 translate 0.000000 rotate
 newpath 9.600000 0.000000 moveto  -9.600000 0.000000 lineto
  -9.600000 -348.888885 lineto
  9.600000 -348.888885 lineto
closepath gsave 0.800000 setgray  fill grestore
stroke
 grestore  gsave  211.200012 355.644440 translate 0.000000 rotate
 newpath 9.600000 0.000000 moveto  -9.600000 0.000000 lineto
  -9.600000 -355.644440 lineto
  9.600000 -355.644440 lineto
closepath gsave 0.800000 setgray  fill grestore
stroke
 grestore  gsave  326.400024 299.288910 translate 0.000000 rotate
 newpath 9.600000 0.000000 moveto  -9.600000 0.000000 lineto
  -9.600000 -299.288910 lineto
  9.600000 -299.288910 lineto
closepath gsave 0.800000 setgray  fill grestore
stroke
 grestore  gsave  441.600006 101.466667 translate 0.000000 rotate
 newpath 9.600000 0.000000 moveto  -9.600000 0.000000 lineto
  -9.600000 -101.466667 lineto
  9.600000 -101.466667 lineto
closepath gsave 0.800000 setgray  fill grestore
stroke
 grestore  gsave  556.800049 12.711111 translate 0.000000 rotate
 newpath 9.600000 0.000000 moveto  -9.600000 0.000000 lineto
  -9.600000 -12.711111 lineto
  9.600000 -12.711111 lineto
closepath gsave 0.800000 setgray  fill grestore
stroke
 grestore  grestore 
 grestore 
 gsave 384.000000 311.111115 translate 0.000000 rotate
 gsave  gsave  0.000000 -5.100000 translate 0.000000 rotate
 newpath -9.600000 -2.000000 moveto  9.600000 -2.000000 lineto
  9.600000 2.000000 lineto
  -9.600000 2.000000 lineto
closepath gsave 0.000000 setgray  fill grestore
stroke
 grestore  grestore 
/Helvetica-Bold findfont 17.000000 scalefont setfont
gsave 13.600000 0.000000 translate 0.000000 rotate
0 -10.200000 translate (NCSA/BSD) dup stringwidth pop pop 0 0 moveto
show
grestore
 gsave  gsave  0.000000 -25.500000 translate 0.000000 rotate
 newpath -9.600000 -2.000000 moveto  9.600000 -2.000000 lineto
  9.600000 2.000000 lineto
  -9.600000 2.000000 lineto
closepath gsave 0.500000 setgray  fill grestore
stroke
 grestore  grestore 
gsave 13.600000 -20.400000 translate 0.000000 rotate
0 -10.200000 translate (Harvest/BSD) dup stringwidth pop pop 0 0 moveto
show
grestore
 gsave  gsave  0.000000 -45.900002 translate 0.000000 rotate
 newpath -9.600000 -2.000000 moveto  9.600000 -2.000000 lineto
  9.600000 2.000000 lineto
  -9.600000 2.000000 lineto
closepath gsave 1.000000 setgray  fill grestore
stroke
 grestore  grestore 
gsave 13.600000 -40.799999 translate 0.000000 rotate
0 -10.200000 translate (Socket/BSD) dup stringwidth pop pop 0 0 moveto
show
grestore
 gsave  gsave  0.000000 -66.300003 translate 0.000000 rotate
 newpath -9.600000 -2.000000 moveto  9.600000 -2.000000 lineto
  9.600000 2.000000 lineto
  -9.600000 2.000000 lineto
closepath gsave 0.400000 setgray  fill grestore
stroke
 grestore  grestore 
gsave 13.600000 -61.200001 translate 0.000000 rotate
0 -10.200000 translate (Socket/Xok) dup stringwidth pop pop 0 0 moveto
show
grestore
 gsave  gsave  0.000000 -86.699997 translate 0.000000 rotate
 newpath -9.600000 -2.000000 moveto  9.600000 -2.000000 lineto
  9.600000 2.000000 lineto
  -9.600000 2.000000 lineto
closepath gsave 0.800000 setgray  fill grestore
stroke
 grestore  grestore 
gsave 13.600000 -81.599998 translate 0.000000 rotate
0 -10.200000 translate (Cheetah) dup stringwidth pop pop 0 0 moveto
show
grestore
 grestore 
0.000000 0.000000 translate
 grestore 
%%EndDocument
 @endspecial -152 1152 a Fq(Figure)30 b(3:)g(HTTP)f(document)j
(throughput)g(as)e(a)g(function)h(of)f(the)g(doc\255)-152
1235 y(ument)e(size)g(for)f(se)n(v)o(eral)h(HTTP/1.0)f(serv)o(ers.)g
Fl(NCSA/BSD)f Fq(represents)-152 1318 y(the)18 b(NCSA/1.4.2)f(serv)o
(er)g(running)i(on)f(OpenBSD.)f Fl(Har)o(v)o(est/BSD)h
Fq(repre\255)-152 1401 y(sents)k(the)f(Harv)o(est)g(proxy)h(cache)g
(running)g(on)f(OpenBSD.)g Fl(Sock)o(et/BSD)-152 1484
y Fq(represents)39 b(our)g(HTTP)d(serv)o(er)j(using)f(TCP)f(sock)o(ets)
i(on)g(OpenBSD.)-152 1567 y Fl(Sock)o(et/Xok)34 b Fq(represents)i(our)f
(HTTP)f(serv)o(er)h(using)g(the)g(TCP)f(sock)o(et)-152
1650 y(interf)o(ace)g(b)o(uilt)e(on)h(our)g(e)o(xtensible)h(TCP/IP)d
(implementation)i(on)h(the)-152 1733 y(Xok)17 b(e)o(xok)o(ernel.)g
Fl(Cheetah/Xok)e Fq(represents)i(the)f(Cheetah)g(HTTP)f(serv)o(er)m(,)
-152 1816 y(which)k(e)o(xploits)f(the)g(TCP)f(and)i(\002le)f(system)g
(implementations)h(for)f(speed.)-152 2061 y(perform)h(signi\002cantly)f
(better)g(than)h(the)f(OpenBSD)g(implementations)h(of)-152
2144 y(the)c(same)h(interf)o(aces)f(\(by)g(80\226100\045\).)i(The)e
(impro)o(v)o(ement)h(comes)f(mainly)-152 2227 y(from)i(simple)h
(\(though)g(generally)g(v)n(aluable\))g(e)o(xtensions,)g(such)f(as)h
(pack)o(et)-152 2310 y(mer)o(ging,)i(application\255le)n(v)o(el)g
(caching)h(of)f(pointers)g(to)f(\002le)g(cache)h(blocks,)-152
2393 y(and)g(protocol)g(control)f(block)h(reuse.)-40
2476 y(Third,)d(and)g(most)h(importantly)-5 b(,)17 b(Cheetah)g
(signi\002cantly)h(outperforms)-152 2559 y(the)12 b(serv)o(ers)g(that)g
(use)g(traditional)g(interf)o(aces.)g(By)g(e)o(xploiting)g(Xok')l(s)g
(e)o(x)q(ten\255)-152 2642 y(sibility)-5 b(,)23 b(Cheetah)i(gains)f(a)f
(four)h(times)g(performance)h(impro)o(v)o(ement)g(for)-152
2725 y(small)14 b(documents)h(\(1)f(KByte)g(and)g(smaller\),)f(making)i
(it)e(eight)h(times)g(f)o(aster)-152 2808 y(than)k(the)f(best)g
(performance)i(we)e(could)h(achie)n(v)o(e)g(on)g(OpenBSD.)e(Further)o
(\255)-152 2891 y(more,)27 b(the)g(lar)o(ge)g(document)h(performance)h
(for)e(Cheetah)g(is)g(limited)f(by)-152 2974 y(the)17
b(a)o(v)n(ailable)f(netw)o(ork)h(bandwidth)h(\(three)e(100Mbit/s)h
(Ethernets\))g(rather)-152 3057 y(than)24 b(by)g(the)f(serv)o(er)g
(hardw)o(are.)h(While)f(the)g(sock)o(et\255based)i(implementa\255)-152
3140 y(tion)i(is)f(limited)g(to)g(only)h(16.5)g(MByte/s)f(with)g
(100\045)i(CPU)d(utilization,)-152 3223 y(Cheetah)18
b(deli)n(v)o(ers)f(o)o(v)o(er)g(29.3)h(MByte/s)f(with)g(the)g(CPU)f
(idle)h(o)o(v)o(er)g(30\045)h(of)-152 3306 y(the)k(time.)e(The)i(e)o
(xtensibility)f(of)g(ExOS')l(s)g(def)o(ault)h(unpri)n(vile)o(ged)h
(TCP/IP)-152 3389 y(and)g(\002le)f(system)g(implementations)i(made)e
(it)g(possible)h(to)f(achie)n(v)o(e)h(these)-152 3472
y(performance)15 b(impro)o(v)o(ements)f(incrementally)h(and)f(with)f
(lo)n(w)g(comple)o(xity)-5 b(.)-40 3555 y(The)19 b(optimizations)g
(performed)h(by)f(Cheetah)g(are)g(architecture)g(inde\255)-152
3638 y(pendent.)g(In)f(Ae)o(gis,)g(Cheetah)g(obtained)i(similar)d
(performance)i(impro)o(v)o(e\255)-152 3721 y(ments)h(o)o(v)o(er)f
(Ultrix)f(web)h(serv)o(ers)g([24)q(].)-152 3918 y Fr(8)91
b(Global)23 b(P)n(erf)n(ormance)-152 4070 y Fq(Xok/ExOS')l(s)j
(decentralization)h(of)f(resource)i(management)f(allo)n(ws)g(the)-152
4153 y(performance)i(of)e(indi)n(vidual)h(applications)g(to)f(be)h
(impro)o(v)o(ed,)f(b)o(ut)g(Xok/)-152 4236 y(ExOS)19
b(must)g(also)g(guarantee)h(good)g(global)g(performance)g(when)f
(running)-152 4319 y(multiple)g(applications)h(concurrently)-5
b(.)21 b(The)e(e)o(xperiments)h(in)f(this)g(section)-152
4402 y(measure)25 b(the)g(situation)g(where)f(the)h(e)o(xok)o(ernel)h
(architecture)e(seems)h(po\255)-152 4485 y(tentially)16
b(weak:)g(under)h(substantial)f(load)g(where)g(sel\002sh)g
(applications)h(are)-152 4568 y(consuming)28 b(lar)o(ge)e(resources)h
(and)g(utilizing)f(I/O)f(de)n(vices)i(hea)o(vily)-5 b(.)27
b(The)-152 4651 y(results)e(indicate)g(that)g(an)g(e)o(xok)o(ernel)i
(can)e(successfully)h(reconcile)g(local)-152 4734 y(control)20
b(with)e(global)i(performance.)-40 4817 y(Global)25 b(performance)h
(has)f(not)g(been)h(e)o(xtensi)n(v)o(ely)f(studied.)g(W)-6
b(e)24 b(use)-152 4900 y(the)c(total)f(time)g(to)g(complete)h(a)g(set)f
(of)g(concurrent)i(tasks)f(as)f(a)g(measure)i(of)-152
4983 y(system)f(throughput,)g(and)g(the)f(minimum)g(and)h(the)f
(maximum)h(latenc)o(y)g(of)-152 5066 y(indi)n(vidual)c(applications)f
(as)f(a)g(measure)h(of)f(interacti)n(v)o(e)h(performance.)g(F)o(or)-152
5149 y(simplicity)e(we)g(compare)i(Xok/ExOS')l(s)d(performance)j(under)
f(high)g(load)g(to)-152 5232 y(that)22 b(of)f(FreeBSD;)g(in)g(these)h
(e)o(xperiments,)g(FreeBSD)f(al)o(w)o(ays)h(performs)-152
5315 y(better)27 b(than)h(OpenBSD,)e(because)i(of)f(OpenBSD')l(s)g
(small,)f(non\255uni\002ed)-152 5398 y(b)o(uf)n(fer)h(cache.)f(While)g
(this)g(methodology)i(does)f(not)g(guarantee)g(that)f(an)2153
1072 y @beginspecial -49 @llx -38 @lly 577 @urx 361 @ury
2160 @rwi @setspecial
%%BeginDocument: global-perf.ps
1 setlinecap 1 setlinejoin
0.700 setlinewidth
0.00 setgray

/Jrnd { exch cvi exch cvi dup 3 1 roll idiv mul } def
/JDEdict 8 dict def
JDEdict /mtrx matrix put
/JDE {
  JDEdict begin
  /yrad exch def
  /xrad exch def
  /savematrix mtrx currentmatrix def
  xrad yrad scale
  0 0 1 0 360 arc
  savematrix setmatrix
  end
} def
/JSTR {
  gsave 1 eq { gsave 1 setgray fill grestore } if
    exch neg exch neg translate 
    clip                        
    rotate                      
    4 dict begin
      pathbbox  /&top exch def
                /&right exch def
                /&bottom exch def
                &right sub /&width exch def
      newpath
      currentlinewidth mul round dup               
      &bottom exch Jrnd exch &top             
      4 -1 roll currentlinewidth mul setlinewidth  
      { &right exch moveto &width 0 rlineto stroke } for    
    end
  grestore
  newpath
} bind def
 gsave /Times-Roman findfont 9.000000 scalefont setfont
0.000000 0.000000 translate
0.700000 setlinewidth  gsave newpath 0.000000 0.000000 moveto 576.000000 0.000000 lineto stroke
/Helvetica-Bold findfont 18.000000 scalefont setfont
gsave 57.600002 -8.000000 translate 0.000000 rotate
0 -10.800000 translate (7/1) dup stringwidth pop 2 div neg 0 moveto
show
grestore
gsave 172.800003 -8.000000 translate 0.000000 rotate
0 -10.800000 translate (14/2) dup stringwidth pop 2 div neg 0 moveto
show
grestore
gsave 288.000000 -8.000000 translate 0.000000 rotate
0 -10.800000 translate (21/3) dup stringwidth pop 2 div neg 0 moveto
show
grestore
gsave 403.200012 -8.000000 translate 0.000000 rotate
0 -10.800000 translate (28/4) dup stringwidth pop 2 div neg 0 moveto
show
grestore
gsave 518.400024 -8.000000 translate 0.000000 rotate
0 -10.800000 translate (35/5) dup stringwidth pop 2 div neg 0 moveto
show
grestore
gsave 288.000000 -26.799999 translate 0.000000 rotate
0 -10.800000 translate (Xok/ExOS and FreeBSD) dup stringwidth pop 2 div neg 0 moveto
show
grestore
 grestore 
0.700000 setlinewidth  gsave newpath 0.000000 0.000000 moveto 0.000000 360.000000 lineto stroke
newpath 0.000000 0.000002 moveto -5.000000 0.000002 lineto stroke
newpath 0.000000 31.893091 moveto -2.000000 31.893091 lineto stroke
newpath 0.000000 50.549355 moveto -2.000000 50.549355 lineto stroke
newpath 0.000000 63.786179 moveto -2.000000 63.786179 lineto stroke
newpath 0.000000 74.053459 moveto -2.000000 74.053459 lineto stroke
newpath 0.000000 82.442444 moveto -2.000000 82.442444 lineto stroke
newpath 0.000000 89.535225 moveto -2.000000 89.535225 lineto stroke
newpath 0.000000 95.679268 moveto -2.000000 95.679268 lineto stroke
newpath 0.000000 101.098701 moveto -2.000000 101.098701 lineto stroke
newpath 0.000000 105.946548 moveto -5.000000 105.946548 lineto stroke
newpath 0.000000 137.839630 moveto -2.000000 137.839630 lineto stroke
newpath 0.000000 156.495895 moveto -2.000000 156.495895 lineto stroke
newpath 0.000000 169.732727 moveto -2.000000 169.732727 lineto stroke
newpath 0.000000 180.000000 moveto -2.000000 180.000000 lineto stroke
newpath 0.000000 188.388992 moveto -2.000000 188.388992 lineto stroke
newpath 0.000000 195.481766 moveto -2.000000 195.481766 lineto stroke
newpath 0.000000 201.625809 moveto -2.000000 201.625809 lineto stroke
newpath 0.000000 207.045242 moveto -2.000000 207.045242 lineto stroke
newpath 0.000000 211.893097 moveto -5.000000 211.893097 lineto stroke
newpath 0.000000 243.786179 moveto -2.000000 243.786179 lineto stroke
newpath 0.000000 262.442444 moveto -2.000000 262.442444 lineto stroke
newpath 0.000000 275.679260 moveto -2.000000 275.679260 lineto stroke
newpath 0.000000 285.946564 moveto -2.000000 285.946564 lineto stroke
newpath 0.000000 294.335541 moveto -2.000000 294.335541 lineto stroke
newpath 0.000000 301.428314 moveto -2.000000 301.428314 lineto stroke
newpath 0.000000 307.572357 moveto -2.000000 307.572357 lineto stroke
newpath 0.000000 312.991791 moveto -2.000000 312.991791 lineto stroke
newpath 0.000000 317.839630 moveto -5.000000 317.839630 lineto stroke
newpath 0.000000 349.732727 moveto -2.000000 349.732727 lineto stroke
/Helvetica-Bold findfont 15.000000 scalefont setfont
gsave -8.000000 0.000002 translate 0.000000 rotate
0 -4.500000 translate (0) dup stringwidth pop neg 0 moveto
show
grestore
gsave -8.000000 105.946548 translate 0.000000 rotate
0 -4.500000 translate (1) dup stringwidth pop neg 0 moveto
show
grestore
gsave -8.000000 211.893097 translate 0.000000 rotate
0 -4.500000 translate (10) dup stringwidth pop neg 0 moveto
show
grestore
gsave -8.000000 317.839630 translate 0.000000 rotate
0 -4.500000 translate (100) dup stringwidth pop neg 0 moveto
show
grestore
/Helvetica-Bold findfont 18.000000 scalefont setfont
gsave -37.599998 180.000000 translate 90.000000 rotate
0 0.000000 translate (Runtime \(seconds\)) dup stringwidth pop 2 div neg 0 moveto
show
grestore
 grestore 
 gsave 
 gsave  gsave  38.400002 263.951172 translate 0.000000 rotate
 newpath 14.400001 0.000000 moveto  -14.400001 0.000000 lineto
  -14.400001 -263.951172 lineto
  14.400001 -263.951172 lineto
closepath gsave 1.000000 setgray  fill grestore
stroke
 grestore  gsave  76.800003 263.951172 translate 0.000000 rotate
 newpath 14.400001 0.000000 moveto  -14.400001 0.000000 lineto
  -14.400001 -263.951172 lineto
  14.400001 -263.951172 lineto
closepath gsave 1.000000 setgray  fill grestore
stroke
 grestore  gsave  153.600006 285.016998 translate 0.000000 rotate
 newpath 14.400001 0.000000 moveto  -14.400001 0.000000 lineto
  -14.400001 -285.016998 lineto
  14.400001 -285.016998 lineto
closepath gsave 1.000000 setgray  fill grestore
stroke
 grestore  gsave  192.000000 285.016998 translate 0.000000 rotate
 newpath 14.400001 0.000000 moveto  -14.400001 0.000000 lineto
  -14.400001 -285.016998 lineto
  14.400001 -285.016998 lineto
closepath gsave 1.000000 setgray  fill grestore
stroke
 grestore  gsave  268.800018 310.899994 translate 0.000000 rotate
 newpath 14.400001 0.000000 moveto  -14.400001 0.000000 lineto
  -14.400001 -310.899994 lineto
  14.400001 -310.899994 lineto
closepath gsave 1.000000 setgray  fill grestore
stroke
 grestore  gsave  307.200012 309.817291 translate 0.000000 rotate
 newpath 14.400001 0.000000 moveto  -14.400001 0.000000 lineto
  -14.400001 -309.817291 lineto
  14.400001 -309.817291 lineto
closepath gsave 1.000000 setgray  fill grestore
stroke
 grestore  gsave  384.000000 323.054108 translate 0.000000 rotate
 newpath 14.400001 0.000000 moveto  -14.400001 0.000000 lineto
  -14.400001 -323.054108 lineto
  14.400001 -323.054108 lineto
closepath gsave 1.000000 setgray  fill grestore
stroke
 grestore  gsave  422.400024 320.084564 translate 0.000000 rotate
 newpath 14.400001 0.000000 moveto  -14.400001 0.000000 lineto
  -14.400001 -320.084564 lineto
  14.400001 -320.084564 lineto
closepath gsave 1.000000 setgray  fill grestore
stroke
 grestore  gsave  499.200012 332.324707 translate 0.000000 rotate
 newpath 14.400001 0.000000 moveto  -14.400001 0.000000 lineto
  -14.400001 -332.324707 lineto
  14.400001 -332.324707 lineto
closepath gsave 1.000000 setgray  fill grestore
stroke
 grestore  gsave  537.600037 329.556244 translate 0.000000 rotate
 newpath 14.400001 0.000000 moveto  -14.400001 0.000000 lineto
  -14.400001 -329.556244 lineto
  14.400001 -329.556244 lineto
closepath gsave 1.000000 setgray  fill grestore
stroke
 grestore  grestore 
 gsave  gsave  38.400002 216.278503 translate 0.000000 rotate
 newpath 14.400001 0.000000 moveto  -14.400001 0.000000 lineto
  -14.400001 -216.278503 lineto
  14.400001 -216.278503 lineto
closepath gsave 0.700000 setgray  fill grestore
stroke
 grestore  gsave  76.800003 216.278503 translate 0.000000 rotate
 newpath 14.400001 0.000000 moveto  -14.400001 0.000000 lineto
  -14.400001 -216.278503 lineto
  14.400001 -216.278503 lineto
closepath gsave 0.700000 setgray  fill grestore
stroke
 grestore  gsave  153.600006 238.938339 translate 0.000000 rotate
 newpath 14.400001 0.000000 moveto  -14.400001 0.000000 lineto
  -14.400001 -238.938339 lineto
  14.400001 -238.938339 lineto
closepath gsave 0.700000 setgray  fill grestore
stroke
 grestore  gsave  192.000000 248.171600 translate 0.000000 rotate
 newpath 14.400001 0.000000 moveto  -14.400001 0.000000 lineto
  -14.400001 -248.171600 lineto
  14.400001 -248.171600 lineto
closepath gsave 0.700000 setgray  fill grestore
stroke
 grestore  gsave  268.800018 255.858093 translate 0.000000 rotate
 newpath 14.400001 0.000000 moveto  -14.400001 0.000000 lineto
  -14.400001 -255.858093 lineto
  14.400001 -255.858093 lineto
closepath gsave 0.700000 setgray  fill grestore
stroke
 grestore  gsave  307.200012 262.442444 translate 0.000000 rotate
 newpath 14.400001 0.000000 moveto  -14.400001 0.000000 lineto
  -14.400001 -262.442444 lineto
  14.400001 -262.442444 lineto
closepath gsave 0.700000 setgray  fill grestore
stroke
 grestore  gsave  384.000000 269.535217 translate 0.000000 rotate
 newpath 14.400001 0.000000 moveto  -14.400001 0.000000 lineto
  -14.400001 -269.535217 lineto
  14.400001 -269.535217 lineto
closepath gsave 0.700000 setgray  fill grestore
stroke
 grestore  gsave  422.400024 280.064697 translate 0.000000 rotate
 newpath 14.400001 0.000000 moveto  -14.400001 0.000000 lineto
  -14.400001 -280.064697 lineto
  14.400001 -280.064697 lineto
closepath gsave 0.700000 setgray  fill grestore
stroke
 grestore  gsave  499.200012 281.098694 translate 0.000000 rotate
 newpath 14.400001 0.000000 moveto  -14.400001 0.000000 lineto
  -14.400001 -281.098694 lineto
  14.400001 -281.098694 lineto
closepath gsave 0.700000 setgray  fill grestore
stroke
 grestore  gsave  537.600037 286.857727 translate 0.000000 rotate
 newpath 14.400001 0.000000 moveto  -14.400001 0.000000 lineto
  -14.400001 -286.857727 lineto
  14.400001 -286.857727 lineto
closepath gsave 0.700000 setgray  fill grestore
stroke
 grestore  grestore 
 gsave  gsave  38.400002 118.018448 translate 0.000000 rotate
 newpath 14.400001 0.000000 moveto  -14.400001 0.000000 lineto
  -14.400001 -118.018448 lineto
  14.400001 -118.018448 lineto
closepath gsave 0.000000 setgray  fill grestore
stroke
 grestore  gsave  76.800003 149.911545 translate 0.000000 rotate
 newpath 14.400001 0.000000 moveto  -14.400001 0.000000 lineto
  -14.400001 -149.911545 lineto
  14.400001 -149.911545 lineto
closepath gsave 0.000000 setgray  fill grestore
stroke
 grestore  gsave  153.600006 140.084564 translate 0.000000 rotate
 newpath 14.400001 0.000000 moveto  -14.400001 0.000000 lineto
  -14.400001 -140.084564 lineto
  14.400001 -140.084564 lineto
closepath gsave 0.000000 setgray  fill grestore
stroke
 grestore  gsave  192.000000 166.145554 translate 0.000000 rotate
 newpath 14.400001 0.000000 moveto  -14.400001 0.000000 lineto
  -14.400001 -166.145554 lineto
  14.400001 -166.145554 lineto
closepath gsave 0.000000 setgray  fill grestore
stroke
 grestore  gsave  268.800018 148.106918 translate 0.000000 rotate
 newpath 14.400001 0.000000 moveto  -14.400001 0.000000 lineto
  -14.400001 -148.106918 lineto
  14.400001 -148.106918 lineto
closepath gsave 0.000000 setgray  fill grestore
stroke
 grestore  gsave  307.200012 177.153000 translate 0.000000 rotate
 newpath 14.400001 0.000000 moveto  -14.400001 0.000000 lineto
  -14.400001 -177.153000 lineto
  14.400001 -177.153000 lineto
closepath gsave 0.000000 setgray  fill grestore
stroke
 grestore  gsave  384.000000 160.881302 translate 0.000000 rotate
 newpath 14.400001 0.000000 moveto  -14.400001 0.000000 lineto
  -14.400001 -160.881302 lineto
  14.400001 -160.881302 lineto
closepath gsave 0.000000 setgray  fill grestore
stroke
 grestore  gsave  422.400024 162.254913 translate 0.000000 rotate
 newpath 14.400001 0.000000 moveto  -14.400001 0.000000 lineto
  -14.400001 -162.254913 lineto
  14.400001 -162.254913 lineto
closepath gsave 0.000000 setgray  fill grestore
stroke
 grestore  gsave  499.200012 160.881302 translate 0.000000 rotate
 newpath 14.400001 0.000000 moveto  -14.400001 0.000000 lineto
  -14.400001 -160.881302 lineto
  14.400001 -160.881302 lineto
closepath gsave 0.000000 setgray  fill grestore
stroke
 grestore  gsave  537.600037 196.777969 translate 0.000000 rotate
 newpath 14.400001 0.000000 moveto  -14.400001 0.000000 lineto
  -14.400001 -196.777969 lineto
  14.400001 -196.777969 lineto
closepath gsave 0.000000 setgray  fill grestore
stroke
 grestore  grestore 
 grestore 
 gsave 153.600006 356.163452 translate 0.000000 rotate
 gsave  gsave  0.000000 -5.100000 translate 0.000000 rotate
 newpath -14.400001 -2.000000 moveto  14.400001 -2.000000 lineto
  14.400001 2.000000 lineto
  -14.400001 2.000000 lineto
closepath gsave 1.000000 setgray  fill grestore
stroke
 grestore  grestore 
/Helvetica-Bold findfont 17.000000 scalefont setfont
gsave 18.400002 0.000000 translate 0.000000 rotate
0 -10.200000 translate (Total) dup stringwidth pop pop 0 0 moveto
show
grestore
 gsave  gsave  0.000000 -25.500000 translate 0.000000 rotate
 newpath -14.400001 -2.000000 moveto  14.400001 -2.000000 lineto
  14.400001 2.000000 lineto
  -14.400001 2.000000 lineto
closepath gsave 0.700000 setgray  fill grestore
stroke
 grestore  grestore 
gsave 18.400002 -20.400000 translate 0.000000 rotate
0 -10.200000 translate (Max) dup stringwidth pop pop 0 0 moveto
show
grestore
 gsave  gsave  0.000000 -45.900002 translate 0.000000 rotate
 newpath -14.400001 -2.000000 moveto  14.400001 -2.000000 lineto
  14.400001 2.000000 lineto
  -14.400001 2.000000 lineto
closepath gsave 0.000000 setgray  fill grestore
stroke
 grestore  grestore 
gsave 18.400002 -40.799999 translate 0.000000 rotate
0 -10.200000 translate (Min) dup stringwidth pop pop 0 0 moveto
show
grestore
 grestore 
0.000000 0.000000 translate
 grestore 
%%EndDocument
 @endspecial 2040 1164 a(Figure)32 b(4:)h(Measured)h(global)f
(performance)g(of)g(Xok/ExOS)f(\(the)g(\002rst)2040 1247
y(bar\))17 b(and)h(FreeBSD)f(\(the)g(second)h(bar\),)f(using)h(the)g
(\002rst)e(application)i(pool.)2040 1330 y(T)m(imes)12
b(are)g(in)g(seconds)g(and)g(on)g(a)g(log)g(scale.)g
Fp(n)q(umber)q(/number)h Fq(refers)f(to)g(the)2040 1413
y(the)17 b(total)f(number)i(of)f(applications)h(run)f(by)h(the)e
(script)h(and)h(the)f(maximum)2040 1496 y(number)22 b(of)e(jobs)h(run)f
(concurrently)-5 b(.)22 b Fl(T)-7 b(otal)20 b Fq(is)g(the)h(total)f
(running)h(time)f(of)2040 1580 y(each)27 b(e)o(xperiment,)f
Fl(Max)g Fq(is)g(the)g(longest)g(runtime)g(of)g(an)o(y)h(process)g(in)e
(a)2040 1663 y(gi)n(v)o(en)20 b(run)f(\(gi)n(ving)h(the)f(w)o(orst)g
(latenc)o(y\).)g Fl(Min)e Fq(is)i(the)g(minimum.)2040
1911 y(e)o(xok)o(ernel)28 b(can)g(compare)f(to)g(an)o(y)g(centralized)g
(system,)g(it)f(does)i(of)n(fer)e(a)2040 1994 y(useful)19
b(relati)n(v)o(e)g(metric.)2152 2077 y(The)29 b(space)h(of)e(possible)i
(combinations)g(of)f(applications)h(to)f(run)g(is)2040
2160 y(lar)o(ge.)23 b(The)h(e)o(xperiments)g(use)g(randomization)h(to)f
(ensure)g(we)f(get)h(a)g(rea\255)2040 2243 y(sonable)19
b(sample)f(of)g(this)f(space.)h(The)g(inputs)g(are)g(a)g(set)f(of)h
(applications)g(to)2040 2326 y(pick)k(from,)e(the)h(total)g(number)h
(to)f(run,)g(and)h(the)f(maximum)h(number)g(that)2040
2409 y(can)g(be)g(running)h(concurrently)-5 b(.)22 b(Each)g(e)o
(xperiment)g(maintains)g(the)g(num\255)2040 2492 y(ber)c(of)g
(concurrent)i(processes)f(at)f(the)g(speci\002ed)g(maximum.)h(The)f
(outputs)2040 2575 y(are)25 b(the)f(total)g(running)i(time,)e(gi)n
(ving)i(throughput,)g(and)f(the)f(time)h(to)f(run)2040
2658 y(each)j(application.)f(Poor)g(interacti)n(v)o(e)g(performance)h
(will)e(sho)n(w)i(up)f(as)g(a)2040 2742 y(high)20 b(minimum)f(latenc)o
(y)-5 b(.)2152 2825 y(The)25 b(\002rst)f(application)i(pool)g(includes)
g(a)f(mix)g(of)g(I/O\255intensi)n(v)o(e)g(and)2040 2908
y(CPU\255intensi)n(v)o(e)20 b(programs:)g(pack)h(archi)n(v)o(e)f(\(pax)
g(\255w\),)f(search)i(for)e(a)h(w)o(ord)2040 2991 y(in)e(a)g(lar)o(ge)g
(\002le)f(\(grep\),)i(compute)g(a)f(checksum)i(man)o(y)e(times)g(o)o(v)
o(er)h(a)f(small)2040 3074 y(set)f(of)h(\002les)e(\(cksum\),)i(solv)o
(e)g(a)f(tra)o(v)o(eling)g(salesman)h(problem)g(\(tsp\),)f(solv)o(e)
2040 3157 y(iterati)n(v)o(ely)j(a)f(lar)o(ge)h(discrete)g(Laplace)g
(equation)h(using)g(successi)n(v)o(e)g(o)o(v)o(er)o(\255)2040
3240 y(relaxation)d(\(sor\),)f(count)i(w)o(ords)f(\(wc\),)f(compile)h
(\(gcc\),)f(compress)i(\(gzip\),)2040 3323 y(and)25 b(uncompress)h
(\(gunzip\).)f(F)o(or)f(this)g(e)o(xperiment,)h(we)g(chose)g
(applica\255)2040 3406 y(tions)d(on)g(which)f(both)h(Xok/ExOS)f(and)i
(FreeBSD)d(run)i(roughly)g(equi)n(v)n(a\255)2040 3489
y(lently)-5 b(.)20 b(Each)g(application)h(runs)f(for)g(at)g(least)g(se)
n(v)o(eral)g(seconds)i(and)e(is)g(run)2040 3572 y(in)g(a)g(separate)g
(directory)h(from)f(the)g(others)g(\(to)f(a)o(v)o(oid)h(cooperati)n(v)o
(e)h(b)o(uf)n(fer)2040 3655 y(cache)i(reuse\).)f(The)g
(pseudo\255random)i(number)f(generators)g(are)f(identical)2040
3738 y(and)27 b(start)e(with)h(the)g(same)h(seed,)f(thus)g(producing)i
(identical)e(schedules.)2040 3821 y(The)20 b(applications)h(we)g(chose)
g(compete)g(for)f(the)g(CPU,)g(memory)-5 b(,)20 b(and)h(the)2040
3904 y(disk.)2152 3987 y(Figure)i(4)h(sho)n(ws)g(on)f(a)h(log)f(scale)g
(the)h(results)f(for)g(\002v)o(e)g(dif)n(ferent)g(e)o(x\255)2040
4070 y(periments:)32 b(se)n(v)o(en)g(jobs)g(with)g(a)f(maximum)i
(concurrenc)o(y)g(of)f(one)g(job)2040 4153 y(through)f(35)e(jobs)h
(with)f(a)g(maximum)h(concurrenc)o(y)i(of)d(\002v)o(e)g(jobs.)g(The)
2040 4236 y(results)j(sho)n(w)g(that)g(an)g(e)o(xok)o(ernel)h(system)f
(can)g(achie)n(v)o(e)h(performance)2040 4319 y(roughly)e(comparable)h
(to)e(UNIX,)f(despite)i(being)g(mostly)f(untuned)i(for)2040
4402 y(global)20 b(performance.)2152 4485 y(W)m(ith)13
b(a)g(second)i(application)f(pool,)g(we)g(e)o(xamine)g(global)g
(performance)2040 4568 y(when)19 b(specialized)g(applications)g
(\(emulated)f(by)h(applications)g(that)f(bene\255)2040
4651 y(\002t)d(from)h(C\255FFS')l(s)e(performance)k(adv)n(antages\))g
(compete)f(with)e(each)i(other)2040 4734 y(and)30 b(non\255specialized)
i(applications.)e(This)f(pool)h(includes)h(tsp)e(and)h(sor)2040
4817 y(from)18 b(abo)o(v)o(e,)g(unpack)g(archi)n(v)o(e)h(\(pax)e
(\255r\))g(from)h(Section)f(6,)g(recursi)n(v)o(e)h(cop)o(y)2040
4900 y(\(cp)f(\255r\))g(from)f(Section)h(6,)g(and)h(comparison)g(\(dif)
n(f\))e(of)h(tw)o(o)g(identical)g(5)g(MB)2040 4983 y(\002les.)f(The)g
(pax)i(and)f(cp)g(applications)h(represent)f(the)g(specialized)g
(applica\255)2040 5066 y(tions.)2152 5149 y(Figure)22
b(5)g(sho)n(ws)h(on)g(a)f(log)g(scale)h(the)f(results)g(for)g(\002v)o
(e)g(e)o(xperiments:)2040 5232 y(se)n(v)o(en)16 b(jobs)g(with)f(a)g
(maximum)h(concurrenc)o(y)i(of)d(one)h(job)g(through)g(35)g(jobs)2040
5315 y(with)d(a)h(maximum)g(concurrenc)o(y)i(of)d(5)h(jobs.)f(The)h
(results)f(sho)n(w)h(that)g(global)2040 5398 y(performance)24
b(on)f(an)g(e)o(xok)o(ernel)h(system)f(does)h(not)f(de)o(grade)g(e)n(v)
o(en)h(when)1903 5647 y(11)p eop
%%Page: 12 12
12 11 bop -39 1072 a @beginspecial -49 @llx -38 @lly
577 @urx 361 @ury 2160 @rwi @setspecial
%%BeginDocument: global-perf2.ps
1 setlinecap 1 setlinejoin
0.700 setlinewidth
0.00 setgray

/Jrnd { exch cvi exch cvi dup 3 1 roll idiv mul } def
/JDEdict 8 dict def
JDEdict /mtrx matrix put
/JDE {
  JDEdict begin
  /yrad exch def
  /xrad exch def
  /savematrix mtrx currentmatrix def
  xrad yrad scale
  0 0 1 0 360 arc
  savematrix setmatrix
  end
} def
/JSTR {
  gsave 1 eq { gsave 1 setgray fill grestore } if
    exch neg exch neg translate 
    clip                        
    rotate                      
    4 dict begin
      pathbbox  /&top exch def
                /&right exch def
                /&bottom exch def
                &right sub /&width exch def
      newpath
      currentlinewidth mul round dup               
      &bottom exch Jrnd exch &top             
      4 -1 roll currentlinewidth mul setlinewidth  
      { &right exch moveto &width 0 rlineto stroke } for    
    end
  grestore
  newpath
} bind def
 gsave /Times-Roman findfont 9.000000 scalefont setfont
0.000000 0.000000 translate
0.700000 setlinewidth  gsave newpath 0.000000 0.000000 moveto 576.000000 0.000000 lineto stroke
/Helvetica-Bold findfont 18.000000 scalefont setfont
gsave 57.600002 -8.000000 translate 0.000000 rotate
0 -10.800000 translate (7/1) dup stringwidth pop 2 div neg 0 moveto
show
grestore
gsave 172.800003 -8.000000 translate 0.000000 rotate
0 -10.800000 translate (14/2) dup stringwidth pop 2 div neg 0 moveto
show
grestore
gsave 288.000000 -8.000000 translate 0.000000 rotate
0 -10.800000 translate (21/3) dup stringwidth pop 2 div neg 0 moveto
show
grestore
gsave 403.200012 -8.000000 translate 0.000000 rotate
0 -10.800000 translate (28/4) dup stringwidth pop 2 div neg 0 moveto
show
grestore
gsave 518.400024 -8.000000 translate 0.000000 rotate
0 -10.800000 translate (35/5) dup stringwidth pop 2 div neg 0 moveto
show
grestore
gsave 288.000000 -26.799999 translate 0.000000 rotate
0 -10.800000 translate (Xok/ExOS and FreeBSD) dup stringwidth pop 2 div neg 0 moveto
show
grestore
 grestore 
0.700000 setlinewidth  gsave newpath 0.000000 0.000000 moveto 0.000000 360.000000 lineto stroke
newpath 0.000000 0.000002 moveto -5.000000 0.000002 lineto stroke
newpath 0.000000 27.966217 moveto -2.000000 27.966217 lineto stroke
newpath 0.000000 44.325405 moveto -2.000000 44.325405 lineto stroke
newpath 0.000000 55.932430 moveto -2.000000 55.932430 lineto stroke
newpath 0.000000 64.935539 moveto -2.000000 64.935539 lineto stroke
newpath 0.000000 72.291618 moveto -2.000000 72.291618 lineto stroke
newpath 0.000000 78.511093 moveto -2.000000 78.511093 lineto stroke
newpath 0.000000 83.898651 moveto -2.000000 83.898651 lineto stroke
newpath 0.000000 88.650810 moveto -2.000000 88.650810 lineto stroke
newpath 0.000000 92.901756 moveto -5.000000 92.901756 lineto stroke
newpath 0.000000 120.867973 moveto -2.000000 120.867973 lineto stroke
newpath 0.000000 137.227158 moveto -2.000000 137.227158 lineto stroke
newpath 0.000000 148.834183 moveto -2.000000 148.834183 lineto stroke
newpath 0.000000 157.837296 moveto -2.000000 157.837296 lineto stroke
newpath 0.000000 165.193375 moveto -2.000000 165.193375 lineto stroke
newpath 0.000000 171.412842 moveto -2.000000 171.412842 lineto stroke
newpath 0.000000 176.800400 moveto -2.000000 176.800400 lineto stroke
newpath 0.000000 181.552567 moveto -2.000000 181.552567 lineto stroke
newpath 0.000000 185.803513 moveto -5.000000 185.803513 lineto stroke
newpath 0.000000 213.769730 moveto -2.000000 213.769730 lineto stroke
newpath 0.000000 230.128906 moveto -2.000000 230.128906 lineto stroke
newpath 0.000000 241.735947 moveto -2.000000 241.735947 lineto stroke
newpath 0.000000 250.739044 moveto -2.000000 250.739044 lineto stroke
newpath 0.000000 258.095123 moveto -2.000000 258.095123 lineto stroke
newpath 0.000000 264.314606 moveto -2.000000 264.314606 lineto stroke
newpath 0.000000 269.702148 moveto -2.000000 269.702148 lineto stroke
newpath 0.000000 274.454315 moveto -2.000000 274.454315 lineto stroke
newpath 0.000000 278.705261 moveto -5.000000 278.705261 lineto stroke
newpath 0.000000 306.671478 moveto -2.000000 306.671478 lineto stroke
newpath 0.000000 323.030670 moveto -2.000000 323.030670 lineto stroke
newpath 0.000000 334.637695 moveto -2.000000 334.637695 lineto stroke
newpath 0.000000 343.640808 moveto -2.000000 343.640808 lineto stroke
newpath 0.000000 350.996887 moveto -2.000000 350.996887 lineto stroke
newpath 0.000000 357.216370 moveto -2.000000 357.216370 lineto stroke
/Helvetica-Bold findfont 15.000000 scalefont setfont
gsave -8.000000 0.000002 translate 0.000000 rotate
0 -4.500000 translate (0) dup stringwidth pop neg 0 moveto
show
grestore
gsave -8.000000 92.901756 translate 0.000000 rotate
0 -4.500000 translate (1) dup stringwidth pop neg 0 moveto
show
grestore
gsave -8.000000 185.803513 translate 0.000000 rotate
0 -4.500000 translate (10) dup stringwidth pop neg 0 moveto
show
grestore
gsave -8.000000 278.705261 translate 0.000000 rotate
0 -4.500000 translate (100) dup stringwidth pop neg 0 moveto
show
grestore
/Helvetica-Bold findfont 18.000000 scalefont setfont
gsave -37.599998 180.000000 translate 90.000000 rotate
0 0.000000 translate (Runtime \(seconds\)) dup stringwidth pop 2 div neg 0 moveto
show
grestore
 grestore 
 gsave 
 gsave  gsave  38.400002 224.355270 translate 0.000000 rotate
 newpath 14.400001 0.000000 moveto  -14.400001 0.000000 lineto
  -14.400001 -224.355270 lineto
  14.400001 -224.355270 lineto
closepath gsave 1.000000 setgray  fill grestore
stroke
 grestore  gsave  76.800003 258.762024 translate 0.000000 rotate
 newpath 14.400001 0.000000 moveto  -14.400001 0.000000 lineto
  -14.400001 -258.762024 lineto
  14.400001 -258.762024 lineto
closepath gsave 1.000000 setgray  fill grestore
stroke
 grestore  gsave  153.600006 249.923935 translate 0.000000 rotate
 newpath 14.400001 0.000000 moveto  -14.400001 0.000000 lineto
  -14.400001 -249.923935 lineto
  14.400001 -249.923935 lineto
closepath gsave 1.000000 setgray  fill grestore
stroke
 grestore  gsave  192.000000 303.743500 translate 0.000000 rotate
 newpath 14.400001 0.000000 moveto  -14.400001 0.000000 lineto
  -14.400001 -303.743500 lineto
  14.400001 -303.743500 lineto
closepath gsave 1.000000 setgray  fill grestore
stroke
 grestore  gsave  268.800018 268.680664 translate 0.000000 rotate
 newpath 14.400001 0.000000 moveto  -14.400001 0.000000 lineto
  -14.400001 -268.680664 lineto
  14.400001 -268.680664 lineto
closepath gsave 1.000000 setgray  fill grestore
stroke
 grestore  gsave  307.200012 327.119904 translate 0.000000 rotate
 newpath 14.400001 0.000000 moveto  -14.400001 0.000000 lineto
  -14.400001 -327.119904 lineto
  14.400001 -327.119904 lineto
closepath gsave 1.000000 setgray  fill grestore
stroke
 grestore  gsave  384.000000 287.708374 translate 0.000000 rotate
 newpath 14.400001 0.000000 moveto  -14.400001 0.000000 lineto
  -14.400001 -287.708374 lineto
  14.400001 -287.708374 lineto
closepath gsave 1.000000 setgray  fill grestore
stroke
 grestore  gsave  422.400024 343.882172 translate 0.000000 rotate
 newpath 14.400001 0.000000 moveto  -14.400001 0.000000 lineto
  -14.400001 -343.882172 lineto
  14.400001 -343.882172 lineto
closepath gsave 1.000000 setgray  fill grestore
stroke
 grestore  gsave  499.200012 296.904694 translate 0.000000 rotate
 newpath 14.400001 0.000000 moveto  -14.400001 0.000000 lineto
  -14.400001 -296.904694 lineto
  14.400001 -296.904694 lineto
closepath gsave 1.000000 setgray  fill grestore
stroke
 grestore  gsave  537.600037 354.412140 translate 0.000000 rotate
 newpath 14.400001 0.000000 moveto  -14.400001 0.000000 lineto
  -14.400001 -354.412140 lineto
  14.400001 -354.412140 lineto
closepath gsave 1.000000 setgray  fill grestore
stroke
 grestore  grestore 
 gsave  gsave  38.400002 193.159592 translate 0.000000 rotate
 newpath 14.400001 0.000000 moveto  -14.400001 0.000000 lineto
  -14.400001 -193.159592 lineto
  14.400001 -193.159592 lineto
closepath gsave 0.700000 setgray  fill grestore
stroke
 grestore  gsave  76.800003 209.518768 translate 0.000000 rotate
 newpath 14.400001 0.000000 moveto  -14.400001 0.000000 lineto
  -14.400001 -209.518768 lineto
  14.400001 -209.518768 lineto
closepath gsave 0.700000 setgray  fill grestore
stroke
 grestore  gsave  153.600006 204.766617 translate 0.000000 rotate
 newpath 14.400001 0.000000 moveto  -14.400001 0.000000 lineto
  -14.400001 -204.766617 lineto
  14.400001 -204.766617 lineto
closepath gsave 0.700000 setgray  fill grestore
stroke
 grestore  gsave  192.000000 253.844177 translate 0.000000 rotate
 newpath 14.400001 0.000000 moveto  -14.400001 0.000000 lineto
  -14.400001 -253.844177 lineto
  14.400001 -253.844177 lineto
closepath gsave 0.700000 setgray  fill grestore
stroke
 grestore  gsave  268.800018 219.408661 translate 0.000000 rotate
 newpath 14.400001 0.000000 moveto  -14.400001 0.000000 lineto
  -14.400001 -219.408661 lineto
  14.400001 -219.408661 lineto
closepath gsave 0.700000 setgray  fill grestore
stroke
 grestore  gsave  307.200012 273.086487 translate 0.000000 rotate
 newpath 14.400001 0.000000 moveto  -14.400001 0.000000 lineto
  -14.400001 -273.086487 lineto
  14.400001 -273.086487 lineto
closepath gsave 0.700000 setgray  fill grestore
stroke
 grestore  gsave  384.000000 235.178833 translate 0.000000 rotate
 newpath 14.400001 0.000000 moveto  -14.400001 0.000000 lineto
  -14.400001 -235.178833 lineto
  14.400001 -235.178833 lineto
closepath gsave 0.700000 setgray  fill grestore
stroke
 grestore  gsave  422.400024 288.029877 translate 0.000000 rotate
 newpath 14.400001 0.000000 moveto  -14.400001 0.000000 lineto
  -14.400001 -288.029877 lineto
  14.400001 -288.029877 lineto
closepath gsave 0.700000 setgray  fill grestore
stroke
 grestore  gsave  499.200012 242.732208 translate 0.000000 rotate
 newpath 14.400001 0.000000 moveto  -14.400001 0.000000 lineto
  -14.400001 -242.732208 lineto
  14.400001 -242.732208 lineto
closepath gsave 0.700000 setgray  fill grestore
stroke
 grestore  gsave  537.600037 298.909912 translate 0.000000 rotate
 newpath 14.400001 0.000000 moveto  -14.400001 0.000000 lineto
  -14.400001 -298.909912 lineto
  14.400001 -298.909912 lineto
closepath gsave 0.700000 setgray  fill grestore
stroke
 grestore  grestore 
 gsave  gsave  38.400002 55.932430 translate 0.000000 rotate
 newpath 14.400001 0.000000 moveto  -14.400001 0.000000 lineto
  -14.400001 -55.932430 lineto
  14.400001 -55.932430 lineto
closepath gsave 0.000000 setgray  fill grestore
stroke
 grestore  gsave  76.800003 27.966217 translate 0.000000 rotate
 newpath 14.400001 0.000000 moveto  -14.400001 0.000000 lineto
  -14.400001 -27.966217 lineto
  14.400001 -27.966217 lineto
closepath gsave 0.000000 setgray  fill grestore
stroke
 grestore  gsave  153.600006 55.932430 translate 0.000000 rotate
 newpath 14.400001 0.000000 moveto  -14.400001 0.000000 lineto
  -14.400001 -55.932430 lineto
  14.400001 -55.932430 lineto
closepath gsave 0.000000 setgray  fill grestore
stroke
 grestore  gsave  192.000000 55.932430 translate 0.000000 rotate
 newpath 14.400001 0.000000 moveto  -14.400001 0.000000 lineto
  -14.400001 -55.932430 lineto
  14.400001 -55.932430 lineto
closepath gsave 0.000000 setgray  fill grestore
stroke
 grestore  gsave  268.800018 55.932430 translate 0.000000 rotate
 newpath 14.400001 0.000000 moveto  -14.400001 0.000000 lineto
  -14.400001 -55.932430 lineto
  14.400001 -55.932430 lineto
closepath gsave 0.000000 setgray  fill grestore
stroke
 grestore  gsave  307.200012 88.650803 translate 0.000000 rotate
 newpath 14.400001 0.000000 moveto  -14.400001 0.000000 lineto
  -14.400001 -88.650803 lineto
  14.400001 -88.650803 lineto
closepath gsave 0.000000 setgray  fill grestore
stroke
 grestore  gsave  384.000000 100.257835 translate 0.000000 rotate
 newpath 14.400001 0.000000 moveto  -14.400001 0.000000 lineto
  -14.400001 -100.257835 lineto
  14.400001 -100.257835 lineto
closepath gsave 0.000000 setgray  fill grestore
stroke
 grestore  gsave  422.400024 106.477310 translate 0.000000 rotate
 newpath 14.400001 0.000000 moveto  -14.400001 0.000000 lineto
  -14.400001 -106.477310 lineto
  14.400001 -106.477310 lineto
closepath gsave 0.000000 setgray  fill grestore
stroke
 grestore  gsave  499.200012 96.747208 translate 0.000000 rotate
 newpath 14.400001 0.000000 moveto  -14.400001 0.000000 lineto
  -14.400001 -96.747208 lineto
  14.400001 -96.747208 lineto
closepath gsave 0.000000 setgray  fill grestore
stroke
 grestore  gsave  537.600037 72.291618 translate 0.000000 rotate
 newpath 14.400001 0.000000 moveto  -14.400001 0.000000 lineto
  -14.400001 -72.291618 lineto
  14.400001 -72.291618 lineto
closepath gsave 0.000000 setgray  fill grestore
stroke
 grestore  grestore 
 grestore 
 gsave 76.800003 345.991760 translate 0.000000 rotate
 gsave  gsave  0.000000 -5.100000 translate 0.000000 rotate
 newpath -14.400001 -2.000000 moveto  14.400001 -2.000000 lineto
  14.400001 2.000000 lineto
  -14.400001 2.000000 lineto
closepath gsave 1.000000 setgray  fill grestore
stroke
 grestore  grestore 
/Helvetica-Bold findfont 17.000000 scalefont setfont
gsave 18.400002 0.000000 translate 0.000000 rotate
0 -10.200000 translate (Total) dup stringwidth pop pop 0 0 moveto
show
grestore
 gsave  gsave  0.000000 -25.500000 translate 0.000000 rotate
 newpath -14.400001 -2.000000 moveto  14.400001 -2.000000 lineto
  14.400001 2.000000 lineto
  -14.400001 2.000000 lineto
closepath gsave 0.700000 setgray  fill grestore
stroke
 grestore  grestore 
gsave 18.400002 -20.400000 translate 0.000000 rotate
0 -10.200000 translate (Max) dup stringwidth pop pop 0 0 moveto
show
grestore
 gsave  gsave  0.000000 -45.900002 translate 0.000000 rotate
 newpath -14.400001 -2.000000 moveto  14.400001 -2.000000 lineto
  14.400001 2.000000 lineto
  -14.400001 2.000000 lineto
closepath gsave 0.000000 setgray  fill grestore
stroke
 grestore  grestore 
gsave 18.400002 -40.799999 translate 0.000000 rotate
0 -10.200000 translate (Min) dup stringwidth pop pop 0 0 moveto
show
grestore
 grestore 
0.000000 0.000000 translate
 grestore 
%%EndDocument
 @endspecial -152 1164 a Fq(Figure)16 b(5:)f(Measured)i(global)f
(performance)h(of)e(Xok/ExOS)h(\(the)f(\002rst)g(bar\))-152
1247 y(and)23 b(FreeBSD)f(\(the)g(second)i(bar\),)e(using)h(the)f
(second)i(application)f(pool.)-152 1330 y(Methodology)f(and)d
(presentation)h(are)f(as)g(described)h(for)f(Figure)g(4.)-152
1579 y(some)26 b(applications)h(use)f(resources)g(aggressi)n(v)o(ely)-5
b(.)27 b(In)f(f)o(act,)f(the)h(relati)n(v)o(e)-152 1662
y(performance)15 b(dif)n(ference)f(between)f(FreeBSD)f(and)i(Xok/ExOS)f
(increases)-152 1745 y(with)19 b(job)g(concurrenc)o(y)-5
b(.)-40 1828 y(The)25 b(central)f(challenge)h(in)g(an)f(e)o(xok)o
(ernel)i(system)f(is)f(not)g Fp(enfor)m(cing)-152 1911
y Fq(a)c(global)f(system)h(polic)o(y)g(b)o(ut,)f(rather)m(,)g
Fp(deriving)h Fq(the)f(information)h(needed)-152 1994
y(to)26 b(decide)g(what)f(enforcement)i(in)m(v)o(olv)o(es)e(and)i
(doing)f(so)f(in)h(such)g(a)f(w)o(ay)-152 2077 y(that)32
b(application)h(\003e)o(xibility)e(is)h(minimally)f(curtailed.)h(Since)
g(an)g(e)o(xo\255)-152 2160 y(k)o(ernel)19 b(controls)g(resource)g
(allocation)g(and)g(re)n(v)o(ocation,)f(it)g(has)h(the)f(po)n(wer)-152
2243 y(to)k(enforce)g(global)f(policies.)h(Quota\255based)g(schemes,)g
(for)g(instance,)f(can)-152 2326 y(be)28 b(tri)n(vially)e(enforced)j
(using)e(only)h(allocation)g(denial)f(and)h(re)n(v)o(ocation.)-152
2409 y(F)o(ortunately)-5 b(,)30 b(the)g(crudeness)h(of)f(successful)h
(global)g(optimizations)f(al\255)-152 2492 y(lo)n(ws)c(global)h
(schemes)f(to)g(be)g(readily)g(implemented)h(by)f(an)g(e)o(xok)o
(ernel.)-152 2575 y(F)o(or)31 b(e)o(xample,)g(Xok)g(currently)g(tracks)
g(global)g(LR)m(U)f(information)i(that)-152 2658 y(applications)20
b(can)g(use)f(when)g(deallocating)h(resources.)-40 2742
y(W)-6 b(e)25 b(belie)n(v)o(e)h(that)f(an)g(e)o(xok)o(ernel)i(can)f
(pro)o(vide)g(global)f(performance)-152 2825 y Fp(superior)e
Fq(to)f(current)h(systems.)f(First,)f(ef)n(fecti)n(v)o(e)h(local)g
(optimization)h(can)-152 2908 y(mean)28 b(there)g(are)f(more)g
(resources)i(for)e(the)g(entire)g(system.)h(Second,)f(an)-152
2991 y(e)o(xok)o(ernel)c(gi)n(v)o(es)e(application)h(writers)e
(machinery)h(to)g(orchestrate)g(inter)o(\255)-152 3074
y(application)11 b(resource)g(management,)g(allo)n(wing)g(them)g(to)g
(p)q(erform)g(d)q(omain\255)-152 3157 y(speci\002c)31
b(global)h(optimizations)g(not)f(possible)h(on)g(current)f(centralized)
-152 3240 y(systems)i(\(e.g.,)e(the)h(UNIX)f(\223mak)o(e\224)i(program)
g(could)g(be)f(modi\002ed)h(to)-152 3323 y(orchestrate)d(the)e
(complete)i(b)o(uild)e(process\).)i(Third,)e(an)h(e)o(xok)o(ernel)h
(can)-152 3406 y(unify)d(the)f(man)o(y)h(space\255partitioned)g(caches)
g(in)f(current)h(systems)f(\(e.g.,)-152 3489 y(the)d(b)o(uf)n(fer)g
(cache,)h(netw)o(ork)f(b)o(uf)n(fers,)g(etc.\).)f(F)o(ourth,)h(since)g
(applications)-152 3572 y(can)i(kno)n(w)f(when)h(resources)g(are)e
(scarce,)h(the)o(y)h(can)f(mak)o(e)h(better)e(use)i(of)-152
3655 y(resources)j(when)g(layering)g(abstractions.)g(F)o(or)e(e)o
(xample,)i(a)f(web)g(serv)o(er)-152 3738 y(that)18 b(caches)i
(documents)f(in)g(virtual)f(memory)h(could)g(stop)f(caching)i(docu\255)
-152 3821 y(ments)f(when)g(its)f(cache)i(does)f(not)g(\002t)f(in)g
(main)h(memory)-5 b(.)19 b(Future)g(research)-152 3904
y(will)f(pursue)i(these)f(issues.)-152 4101 y Fr(9)91
b(Experience)-152 4253 y Fq(Ov)o(er)25 b(the)h(past)f(three)g(years,)g
(we)g(ha)o(v)o(e)g(b)o(uilt)g(three)g(e)o(xok)o(ernel)i(systems.)-152
4336 y(W)-6 b(e)27 b(distill)f(our)h(e)o(xperience)h(by)f(discussing)h
(the)f(clear)g(adv)n(antages,)i(the)-152 4419 y(costs,)19
b(and)h(lessons)f(learned)h(from)f(b)o(uilding)g(e)o(xok)o(ernel)h
(systems.)-152 4608 y Fr(9.1)91 b(Clear)22 b(adv)o(antages)-152
4725 y Fl(Exposing)16 b(k)o(er)o(nel)f(data)g(structur)o(es.)g
Fq(Allo)n(wing)h(libOSes)f(to)h(map)g(k)o(ernel)-152
4808 y(and)i(hardw)o(are)g(data)g(structures)f(into)g(their)g(address)h
(spaces)g(is)f(a)g(po)n(werful)-152 4891 y(e)o(xtensibility)g
(mechanism.)g(\(Of)f(course,)h(these)g(structures)g(must)f(not)h
(con\255)-152 4974 y(tain)e(sensiti)n(v)o(e)g(information)g(to)g(which)
g(the)g(application)h(lacks)f(pri)n(vile)o(ges.\))-152
5057 y(The)h(bene\002ts)g(of)g(mapping)h(data)f(structures)g(are)f(tw)o
(o\255fold.)h(First,)e(e)o(xposed)-152 5140 y(data)j(structures)g(can)g
(be)f(accessed)i(without)f(system)f(call)g(o)o(v)o(erhead.)i(More)-152
5223 y(importantly)-5 b(,)26 b(ho)n(we)n(v)o(er)m(,)f(mapping)h(the)f
(data)h(structures)f(directly)g(allo)n(ws)-152 5306 y(libOSes)16
b(to)f(mak)o(e)i(use)f(of)g(information)h(the)f(e)o(xok)o(ernel)h(did)f
(not)g(anticipate)-152 5389 y(e)o(xporting.)2152 -69
y(Because)e(e)o(xposed)h(data)f(structures)g(do)f(not)h(constitute)g(a)
f(well\255de\002ned)2040 14 y(API,)25 b(softw)o(are)h(that)f(directly)h
(relies)f(on)i(them)f(\(e.g.,)f(the)g(hardw)o(are)i(ab\255)2040
97 y(straction)22 b(layer)f(in)g(a)h(libOS\))e(may)i(need)g(to)g(be)f
(recompiled)i(or)e(modi\002ed)2040 180 y(if)j(the)g(k)o(ernel)g
(changes.)i(This)d(can)i(be)f(seen)h(as)f(a)g(disadv)n(antage.)h(On)f
(the)2040 263 y(other)15 b(hand,)h(code)g(af)n(fected)f(by)g(changes)i
(in)e(e)o(xposed)h(data)f(structures)g(will)2040 346
y(typically)j(reside)f(in)g(dynamically\255link)o(ed)j(libOSes,)c(so)h
(that)h(applications)2040 429 y(need)25 b(not)f(concern)h(themselv)o
(es)g(with)e(these)i(changes.)g(Moreo)o(v)o(er)m(,)f(most)2040
512 y(impro)o(v)o(ements)29 b(that)f(w)o(ould)i(require)e(k)o(ernel)h
(modi\002cation)g(on)g(a)f(tradi\255)2040 596 y(tional)e(operating)i
(systems)f(need)g(only)g(ef)n(fect)f(libOSes)g(on)h(e)o(xok)o(ernels.)
2040 679 y(This)17 b(is)f(one)i(of)f(the)g(main)g(adv)n(antages)i(of)e
(the)g(e)o(xok)o(ernel,)h(as)g(libOSes)e(can)2040 762
y(be)24 b(modi\002ed)g(and)g(deb)o(ugged)i(considerably)f(more)f
(easily)g(than)g(k)o(ernels.)2040 845 y(Finally)-5 b(,)15
b(we)g(e)o(xpect)i(most)e(changes)i(to)e(the)h(e)o(xok)o(ernel)h
(proper)f(to)g(be)g(along)2040 928 y(the)22 b(lines)g(of)g(ne)n(w)g(de)
n(vice)g(dri)n(v)o(ers)h(or)e(hardw)o(are\255oriented)j(functionality)
-5 b(,)2040 1011 y(which)19 b(e)o(xpose)h(ne)n(w)g(structures)f(rather)
g(than)g(modify)h(e)o(xisting)f(ones.)2152 1094 y(In)k(the)g(end,)h
(some)f(aggressi)n(v)o(e)i(applications)e(may)h(not)f(w)o(ork)h(across)
2040 1177 y(all)f(v)o(ersions)g(of)g(the)h(e)o(xok)o(ernel,)g(e)n(v)o
(en)g(if)e(the)o(y)i(are)f(dynamically)h(link)o(ed.)2040
1260 y(This)j(problem)i(is)e(nothing)i(ne)n(w)-5 b(,)27
b(ho)n(we)n(v)o(er)l(.)i(A)e(number)i(of)e(UNIX)g(pro\255)2040
1343 y(grams)32 b(such)f(as)h(top,)f(gated,)g(lsof,)f(and)i(netstat)f
(already)h(mak)o(e)g(use)f(of)2040 1426 y(pri)n(v)n(ate)f(k)o(ernel)h
(data)f(structures)g(through)h(the)e(k)o(ernel)i(memory)f(de)n(vice)
2040 1509 y Fd(/dev/kmem)p Fq(.)14 b(Administrators)h(ha)o(v)o(e)h
(simply)g(learned)g(to)g(reinstall)f(these)2040 1592
y(programs)20 b(whene)n(v)o(er)g(major)f(k)o(ernel)h(data)f(structures)
g(change.)2152 1675 y(The)f(use)h(of)f(\223w)o(ak)o(eup)j
(predicates\224)e(has)f(forcefully)h(dri)n(v)o(en)g(home)g(the)2040
1758 y(adv)n(antages)i(of)e(e)o(xposing)h(k)o(ernel)f(data)h
(structures.)e(Frequently)-5 b(,)19 b(we)g(ha)o(v)o(e)2040
1841 y(required)29 b(unusual)h(information)f(about)g(the)f(system.)h
(In)f(all)g(cases,)h(this)2040 1924 y(information)20
b(w)o(as)f(already)g(pro)o(vided)h(by)g(the)f(k)o(ernel)h(data)f
(structures.)2152 2007 y Fl(The)31 b(CPU)h(interface.)f
Fq(The)h(combination)h(of)f(time)g(slices,)f(initia\255)2040
2090 y(tion/termination)d(upcalls,)g(and)g(directed)g(yields)f(has)h
(pro)o(v)o(en)h(its)e(v)n(alue)2040 2173 y(repeatedly)-5
b(.)18 b(\(Subsequent)h(to)e(our)h(w)o(ork,)f(others)h(ha)o(v)o(e)g
(found)g(these)g(prim\255)2040 2256 y(iti)n(v)o(es)27
b(useful)h([14)q(].\))f(W)-6 b(e)27 b(ha)o(v)o(e)h(used)g(the)g
(primiti)n(v)o(es)g(for)f(inter)o(\255process)2040 2339
y(communication)h(optimization)f(\(e.g.,)f(tw)o(o)h(applications)g
(communicat\255)2040 2422 y(ing)16 b(through)h(a)f(shared)h(message)g
(queue)g(can)f(yield)h(to)e(each)i(other\),)f(global)2040
2505 y(gang\255scheduling,)21 b(and)f(rob)o(ust)f(critical)f(sections)h
(\(see)g(belo)n(w\).)2152 2588 y Fl(Libraries)11 b(ar)o(e)g(simpler)g
(than)g(k)o(er)o(nels.)g Fq(The)g(\223edit,)g(compile,)g(deb)o(ug\224)
2040 2671 y(c)o(ycle)20 b(of)f(applications)h(is)f(considerably)i(f)o
(aster)f(than)g(the)f(\223edit,)g(compile,)2040 2754
y(reboot,)k(deb)o(ug\224)h(c)o(ycle)f(of)f(k)o(ernels.)h(A)g(practical)
f(bene\002t)h(of)g(placing)g(OS)2040 2837 y(functionality)18
b(in)e(libraries)h(is)f(that)h(the)f(\223reboot\224)i(is)f(replaced)g
(by)h(\223relink.)-5 b(\224)2040 2920 y(Accumulated)18
b(o)o(v)o(er)f(man)o(y)h(iterations,)e(this)h(replacement)h(reduces)g
(de)n(v)o(el\255)2040 3003 y(opment)23 b(time)f(substantially)-5
b(.)22 b(Additionally)-5 b(,)23 b(the)f(f)o(act)g(that)g(the)h(library)
f(is)2040 3086 y(isolated)i(from)g(the)f(rest)g(of)h(the)g(system)g
(allo)n(ws)f(easy)h(deb)o(ugging)i(of)d(ba\255)2040 3169
y(sic)e(abstractions.)g(Untrusted)h(user)o(\255le)n(v)o(el)f(serv)o
(ers)g(in)g(microk)o(ernel\255based)2040 3252 y(systems)e(also)g(ha)o
(v)o(e)h(this)e(bene\002t.)2040 3441 y Fr(9.2)91 b(Costs)2040
3558 y Fq(Exok)o(ernels)15 b(are)f(not)g(a)f(panacea.)i(This)f
(subsection)g(lists)f(some)i(of)e(the)h(costs)2040 3641
y(we)19 b(ha)o(v)o(e)g(encountered.)2152 3724 y Fl(Exok)o(er)o(nel)f
(interface)g(design)g(is)g(not)f(simple.)g Fq(The)i(goal)f(of)g(an)h(e)
o(xo\255)2040 3807 y(k)o(ernel)30 b(system)e(is)h(for)f(pri)n(vile)o
(ged)i(softw)o(are)f(to)f(e)o(xport)h(interf)o(aces)h(that)2040
3890 y(let)d(unpri)n(vile)o(ged)i(applications)g(manage)g(their)e(o)n
(wn)h(resources.)g(At)f(the)2040 3973 y(same)c(time,)g(these)g(interf)o
(aces)g(must)g(of)n(fer)g(rich)g(enough)i(protection)f(that)2040
4056 y(libOSes)d(can)h(assure)g(themselv)o(es)h(of)e(in)m(v)n(ariants)i
(on)f(high\255le)n(v)o(el)g(abstrac\255)2040 4139 y(tions.)27
b(It)g(generally)h(tak)o(es)g(se)n(v)o(eral)f(iterations)h(to)f(obtain)
h(a)f(satisf)o(actory)2040 4222 y(interf)o(ace,)e(as)f(the)h(designer)h
(struggles)f(to)f(increase)h(po)n(wer)h(and)f(remo)o(v)o(e)2040
4305 y(unnecessary)f(functionality)f(while)f(still)f(pro)o(viding)j
(the)e(necessary)h(le)n(v)o(el)2040 4388 y(of)28 b(protection.)h(Most)g
(of)f(our)h(major)f(e)o(xok)o(ernel)i(interf)o(aces)f(ha)o(v)o(e)f
(gone)2040 4471 y(through)20 b(multiple)f(designs)h(o)o(v)o(er)f(se)n
(v)o(eral)g(years.)2152 4554 y Fl(Inf)n(ormation)24 b(loss.)g
Fq(V)-8 b(aluable)24 b(information)h(can)g(be)f(lost)g(by)h(imple\255)
2040 4637 y(menting)17 b(OS)e(abstractions)i(at)e(application)i(le)n(v)
o(el.)f(F)o(or)f(instance,)h(if)g(virtual)2040 4720 y(memory)31
b(and)g(the)g(\002le)e(system)i(are)f(completely)h(at)g(application)g
(le)n(v)o(el,)2040 4803 y(the)e(e)o(xok)o(ernel)i(may)e(be)h(unable)g
(to)f(distinguish)h(pages)g(used)g(to)f(cache)2040 4886
y(disk)f(blocks)h(and)f(pages)h(used)f(for)g(virtual)f(memory)-5
b(.)29 b(Glaze,)e(the)h(Fugu)2040 4969 y(e)o(xok)o(ernel,)17
b(has)e(the)h(additional)f(complication)i(that)e(it)f(cannot)j
(distinguish)2040 5052 y(such)f(uses)f(from)g(the)g(physical)h(pages)g
(used)f(for)g(b)o(uf)n(fering)h(messages)f([29)q(].)2040
5135 y(Frequently\255used)21 b(information)f(can)f(often)h(be)g(deri)n
(v)o(ed)g(with)f(little)f(ef)n(fort.)2040 5218 y(F)o(or)29
b(e)o(xample,)g(if)g(page)h(tables)f(are)g(managed)i(by)e(the)h
(application,)f(the)2040 5302 y(e)o(xok)o(ernel)23 b(can)e(approximate)
i(LR)m(U)d(page)i(ordering)g(by)g(tracking)f(the)h(in\255)2040
5385 y(sertion)c(of)f(translations)h(into)g(the)f(TLB.)f(Ho)n(we)n(v)o
(er)m(,)i(at)f(the)h(v)o(ery)g(least,)f(this)1903 5647
y(12)p eop
%%Page: 13 13
13 12 bop -152 -69 a Fq(inference)20 b(requires)f(thought.)-40
14 y Fl(Self\255paging)i(libOSes.)e Fq(Self\255paging)j(is)f(dif)n
(\002cult)f(\(only)i(a)f(fe)n(w)g(com\255)-152 97 y(mercial)i
(operating)g(systems)g(page)h(their)e(k)o(ernel\).)h(Self\255paging)g
(libOSes)-152 180 y(are)i(e)n(v)o(en)g(more)g(dif)n(\002cult)f(because)
i(paging)g(can)f(be)g(caused)g(by)g(e)o(xternal)-152
263 y(entities)h(\(e.g.,)f(the)h(k)o(ernel)g(touching)h(a)f
(paged\255out)h(b)o(uf)n(fer)f(that)g(a)f(libOS)-152
346 y(pro)o(vided\).)18 b(Careful)f(planning)i(is)e(necessary)h(to)f
(ensure)h(that)f(libOSes)g(can)-152 429 y(quickly)23
b(select)f(and)g(return)g(a)f(page)i(to)f(the)f(e)o(xok)o(ernel,)i(and)
g(that)e(there)h(is)-152 512 y(a)d(f)o(acility)f(to)g(sw)o(ap)h(in)g
(processes)g(without)g(kno)n(wledge)h(of)e(their)h(internals)-152
596 y(\(otherwise)g(virtual)g(memory)h(customization)g(will)e(be)h
(infeasible\).)-152 784 y Fr(9.3)91 b(Lessons)-152 901
y Fl(Pr)o(o)o(vide)14 b(space)h(f)n(or)g(application)e(data)h(in)g(k)o
(er)o(nel)f(structur)o(es.)g Fq(LibOSes)-152 984 y(are)f(often)g
(easier)g(to)g(de)n(v)o(elop)g(if)g(the)o(y)g(can)g(store)g(sh)q(ared)h
(state)f(in)g(kernel)g(d)q(ata)-152 1067 y(structures.)k(In)f
(particular)m(,)h(this)f(ability)g(can)h(simplify)f(the)h(task)g(of)f
(locating)-152 1150 y(shared)i(state)e(and)i(often)f(a)o(v)o(oids)f(a)o
(wkw)o(ard)i(\(and)f(comple)o(x\))h(replication)f(of)-152
1233 y(inde)o(xing)24 b(structures)e(at)g(the)g(application)h(le)n(v)o
(el.)f(F)o(or)g(e)o(xample,)g(Xok)h(lets)-152 1316 y(libOSes)18
b(use)h(the)g(softw)o(are\255only)g(bits)g(of)f(page)i(tables,)e
(greatly)h(simplify\255)-152 1399 y(ing)g(the)g(implementation)h(of)f
(cop)o(y)h(on)g(write.)-40 1483 y Fl(F)n(ast)c(applications)f(do)g(not)
g(r)o(equir)o(e)g(good)h(micr)o(obenchmark)f(per)m(\255)-152
1566 y(f)n(ormance.)27 b Fq(The)g(main)g(bene\002t)f(of)h(an)g(e)o(xok)
o(ernel)h(is)e(not)g(that)h(it)f(mak)o(es)-152 1649 y(primiti)n(v)o(e)c
(operations)h(ef)n(\002cient,)e(b)o(ut)h(that)g(it)f(gi)n(v)o(es)h
(applications)h(control)-152 1732 y(o)o(v)o(er)h(e)o(xpensi)n(v)o(e)h
(operations)g(such)f(as)g(I/O.)e(It)h(is)g(this)h(control)g(that)f(gi)n
(v)o(es)-152 1815 y(order)18 b(of)g(magnitude)g(performance)h(impro)o
(v)o(ements)g(to)e(applications,)h(not)-152 1898 y(f)o(ast)k(system)f
(calls.)g(W)-6 b(e)21 b(hea)o(vily)g(tuned)i(Ae)o(gis)e(to)g(achie)n(v)
o(e)h(e)o(xcellent)g(mi\255)-152 1981 y(crobenchmark)g(performance.)f
(Xok,)f(on)g(the)g(other)g(hand,)g(is)g(completely)-152
2064 y(untuned.)g(Ne)n(v)o(ertheless,)g(applications)g(perform)f(well.)
-40 2147 y Fl(Inexpensi)o(v)o(e)24 b(critical)f(sections)g(ar)o(e)h
(useful)e(f)n(or)i(LibOSes.)e Fq(In)h(tra\255)-152 2230
y(ditional)c(OSes,)f(ine)o(xpensi)n(v)o(e)i(critical)e(sections)h(can)h
(be)e(implemented)i(by)-152 2313 y(disabling)f(interrupts)f([3].)f
(ExOS)g(implements)h(such)g(critical)f(sections)h(by)-152
2396 y(disabling)23 b(softw)o(are)g(interrupts)f(\(e.g.,)g(time)g
(slice)g(termination)h(upcalls\).)-152 2479 y(Using)i(critical)e
(sections)i(instead)f(of)h(locks)f(remo)o(v)o(es)h(the)f(need)h(to)f
(com\255)-152 2562 y(municate)c(to)f(manage)h(a)f(lock,)g(to)g(trust)g
(softw)o(are)g(to)g(acquire)h(and)f(release)-152 2645
y(locks)28 b(correctly)-5 b(,)27 b(and)h(to)f(use)h(comple)o(x)g
(algorithms)g(to)f(reclaim)g(a)g(lock)-152 2728 y(when)17
b(a)f(process)h(dies)f(while)g(still)f(holding)j(it.)d(This)g(approach)
j(has)f(pro)o(v)o(en)-152 2811 y(to)j(be)g(similarly)g(useful)g(on)h
(the)f(Fugu)g(multiprocessor;)h(it)e(is)g(the)h(basis)h(of)-152
2894 y(Fugu')l(s)e(f)o(ast)g(message)h(passing.)-40 2977
y Fl(User)m(\255le)o(v)o(el)15 b(page)f(tables)f(ar)o(e)g(complex.)h
Fq(If)f(page)i(tables)f(are)f(migrated)-152 3060 y(to)21
b(user)g(le)n(v)o(el)h(\(as)e(on)i(Ae)o(gis\),)e(a)h(concerted)i(ef)n
(fort)d(must)i(be)f(made)h(to)e(en\255)-152 3143 y(sure)e(that)f(the)g
(user')l(s)g(TLB)f(re\002ll)g(handler)i(can)f(run)g(in)g(unusual)i
(situations.)-152 3226 y(The)28 b(reason)h(is)e(not)h(performance,)h(b)
o(ut)e(that)h(the)f(naming)i(conte)o(xt)f(pro\255)-152
3309 y(vided)17 b(by)g(virtual)f(memory)g(mappings)i(is)d(a)h
(requirement)h(for)f(most)g(useful)-152 3392 y(operations.)21
b(F)o(or)e(e)o(xample,)i(in)e(the)h(case)h(of)f(do)n(wnloaded)i(code)e
(run)h(in)e(an)-152 3475 y(interrupt)27 b(handler)m(,)g(if)e(the)i(k)o
(ernel)g(is)f(not)g(willing)g(to)h(allo)n(w)f(application)-152
3558 y(code)f(to)f(service)h(TLB)e(misses)h(then)g(there)g(are)g(man)o
(y)h(situations)f(where)-152 3641 y(the)j(code)g(will)e(be)i(unable)g
(to)f(mak)o(e)i(progress.)f(User)o(\255le)n(v)o(el)e(page)j(tables)-152
3724 y(made)18 b(the)g(implementation)g(of)g(libOSes)f(trick)o(y)g(on)h
(Ae)o(gis;)f(since)h(the)g(x86)-152 3807 y(has)i(hardw)o(are)f(page)h
(tables,)f(this)g(issue)g(disappeared)h(on)g(Xok/ExOS.)-40
3890 y Fl(Do)o(wnloaded)25 b(interrupt)f(handlers)h(ar)o(e)g(of)h
(questionable)e(utility)-152 3973 y(on)33 b(exok)o(er)o(nels.)h
Fq(Ae)o(gis)f(used)h(do)n(wnloaded)h(code)f(e)o(xtensi)n(v)o(ely)h(in)e
(in\255)-152 4056 y(terrupt)e(servicing)g([44)q(].)f(The)g(tw)o(o)h
(main)g(bene\002ts)f(are)h(elimination)g(of)-152 4139
y(k)o(ernel)19 b(crossings)g(and)f(f)o(ast)g(upcalls)g(to)g
(unscheduled)i(processes,)f(thereby)-152 4222 y(reducing)27
b(processing)f(latenc)o(y)g(\(e.g.,)e(of)h(send\255response)j(style)d
(netw)o(ork)-152 4305 y(messages\).)16 b(On)g(current)f(generation)i
(chips,)e(ho)n(we)n(v)o(er)m(,)i(the)e(latenc)o(y)h(of)f(I/O)-152
4388 y(de)n(vices)i(is)f(lar)o(ge)g(compared)h(to)f(the)g(o)o(v)o
(erhead)i(of)e(k)o(ernel)h(crossings,)f(mak\255)-152
4471 y(ing)22 b(the)g(\002rst)e(bene\002t)i(ne)o(gligible.)g(The)f
(second)i(does)f(not)g(require)g(do)n(wn\255)-152 4554
y(loading)f(code,)e(only)h(an)g(upcall)g(mechanism.)g(In)f(practice,)g
(it)g(is)g(the)g(latter)-152 4637 y(ability)k(that)g(gi)n(v)o(es)g(us)g
(speed.)h(Do)n(wnloading)g(interrupt)f(handlers)h(seems)-152
4720 y(more)19 b(useful)g(on)g(commercial)g(operating)h(systems)f(with)
f(e)o(xtremely)h(high)-152 4803 y(o)o(v)o(erhead)h(for)e(k)o(ernel)g
(crossing)h(than)g(on)f(e)o(xok)o(ernel)i(systems.)e(It)f(is)h(easier)
-152 4886 y(to)d(do)n(wnload)i(interrupt)e(handlers)g(into)g(an)g(e)o
(xisting)h(commercial)f(OS)f(than)-152 4969 y(to)19 b(turn)g(the)g
(commercial)h(OS)e(into)h(an)g(e)o(xok)o(ernel)h(system.)-40
5052 y Fl(Do)o(wnloaded)f(code)g(is)f(po)o(werful.)g
Fq(Do)n(wnloaded)j(code)e(lets)g(the)g(k)o(er)o(\255)-152
5135 y(nel)h(lea)o(v)o(e)e(decisions)i(to)f(untrusted)h(softw)o(are.)f
(W)-6 b(e)19 b(ha)o(v)o(e)g(found)i(this)d(dele\255)-152
5218 y(gation)i(in)m(v)n(aluable)h(in)f(man)o(y)h(places.)f(The)g(main)
g(bene\002t)g(of)f(do)n(wnloaded)-152 5302 y(code)12
b(is)g Fp(not)g Fq(e)o(x)o(ecution)g(speed,)g(b)o(ut)g(rather)g(trust)g
(and)g(consequ)q(ently)g(p)q(o)n(wer:)-152 5385 y(The)25
b(k)o(ernel)g(can)h(in)m(v)o(ok)o(e)f(do)n(wnloaded)i(code)f(in)e
(cases)i(where)f(it)f(cannot)2040 -69 y(trust)e(application)h(code.)g
(F)o(or)e(e)o(xample,)i(pack)o(et)g(\002lters)e(are)h(do)n(wnloaded)
2040 14 y(code)30 b(fragments)f(used)h(by)f(applications)h(to)f(claim)g
(incoming)h(netw)o(ork)2040 97 y(pack)o(ets.)18 b(Because)g(the)o(y)g
(are)f(in)g(the)g(k)o(ernel,)h(the)f(k)o(ernel)h(can)g(inspect)f(them)
2040 180 y(and)i(v)o(erify)f(that)h(the)o(y)f(do)h(not)f(steal)g(pack)o
(ets)i(intended)f(for)f(other)h(applica\255)2040 263
y(tions.)24 b(The)g(alternati)n(v)o(e,)g(asking)h(each)g(application)g
(if)e(it)h(claims)g(a)g(gi)n(v)o(en)2040 346 y(pack)o(et,)17
b(is)e(clearly)h(unw)o(orkable;)h(the)f(k)o(ernel)g(w)o(ould)g(not)g
(kno)n(w)h(ho)n(w)f(deci\255)2040 429 y(sions)g(were)f(made)h(and)g
(could)g(not)f(guarantee)i(their)e(correctness.)h(Another)2040
512 y(e)o(xample)i(is)f(the)g(use)h(of)f(do)n(wnloaded)i(code)f(for)g
(metadata)f(interpretation:)2040 596 y(since)j(the)g(k)o(ernel)g(can)g
(ensure)g(that)g(UDFs)f(are)g(deterministic)h(and)g(do)g(not)2040
679 y(change,)h(it)e(can)h(trust)f(their)h(output)g(without)g(ha)o
(ving)g(to)g(understand)h(what)2040 762 y(the)o(y)e(do.)2040
959 y Fr(10)91 b(Conclusion)2040 1111 y Fq(This)26 b(paper)h(e)n(v)n
(aluates)g(the)f(e)o(xok)o(ernel)i(architecture)f(proposed)g(in)f([11)q
(].)2040 1194 y(It)33 b(sho)n(ws)h(ho)n(w)g(we)f(b)o(uilt)g(an)g(e)o
(xok)o(ernel)i(system)f(that)f(separates)h(pro\255)2040
1277 y(tection)26 b(from)f(management)i(to)e(gi)n(v)o(e)h(untrusted)h
(softw)o(are)e(control)h(o)o(v)o(er)2040 1360 y(resource)21
b(management.)g(Our)f(e)o(xok)o(ernel)h(system)f(gi)n(v)o(es)h
(signi\002cant)f(per)o(\255)2040 1443 y(formance)15 b(adv)n(antages)g
(to)f(aggressi)n(v)o(ely\255specialized)i(applications)f(while)2040
1526 y(maintaining)23 b(competiti)n(v)o(e)g(performance)g(on)g
(unmodi\002ed)h(UNIX)d(appli\255)2040 1609 y(cations,)15
b(e)n(v)o(en)h(under)g(hea)o(vily)f(multitask)o(ed)g(w)o(orkloads.)h
(Exok)o(ernels)g(also)2040 1692 y(simplify)k(the)g(job)h(of)f
(operating)h(system)g(de)n(v)o(elopment)h(by)e(allo)n(wing)h(one)2040
1775 y(library)26 b(operating)h(system)g(to)f(be)g(de)n(v)o(eloped)i
(and)f(deb)o(ugged)h(from)e(an\255)2040 1858 y(other)f(one)h(running)g
(on)f(the)g(same)g(machine.)g(The)g(adv)n(antages)h(of)f(rapid)2040
1941 y(operating)18 b(system)e(de)n(v)o(elopment)j(e)o(xtend)e(be)o
(yond)h(specialized)f(niche)g(ap\255)2040 2024 y(plications.)23
b(Thus,)f(while)g(some)h(questions)h(about)f(the)g(full)f(implications)
2040 2107 y(of)h(the)g(e)o(xok)o(ernel)h(architecture)g(remain)f(to)g
(be)g(answered,)g(it)g(is)f(a)h(viable)2040 2190 y(approach)e(that)d
(of)n(fers)h(man)o(y)h(adv)n(antages)h(o)o(v)o(er)e(con)m(v)o(entional)
i(systems.)2040 2421 y Fr(Ackno)o(wledgments)2040 2581
y Fq(Ov)o(er)f(the)h(last)e(three)i(years)f(man)o(y)h(people)g(ha)o(v)o
(e)g(contrib)o(uted)g(to)f(the)g(e)o(xo\255)2040 2664
y(k)o(ernel)i(project.)f(In)g(particular)m(,)g(we)h(thank)g(Deborah)g
(W)-6 b(allach)21 b(and)h(Doug)2040 2747 y(W)-5 b(yatt)18
b(for)g(their)h(man)o(y)g(contrib)o(utions.)g(W)-6 b(e)18
b(also)h(thank)h(Josh)f(Cates,)f(Erik)2040 2830 y(Nygren,)33
b(Constantine)g(Sapuntzakis,)g(Y)-8 b(onah)33 b(Schmeidler)m(,)f(and)h
(Elliot)2040 2913 y(W)-6 b(aingold)29 b(for)f(porting)h(dri)n(v)o(ers)g
(and)g(applications)g(to)f(Xok/ExOS.)g(W)-6 b(e)2040
2996 y(thank)29 b(Eddie)g(K)m(ohler)g(for)f(his)g(help)h(with)f
(writing)g(this)g(paper)l(.)h(Finally)-5 b(,)2040 3079
y(we)23 b(thank)i(Josh)f(Cates,)f(John)h(Chapin,)g(Matt)f(Frank,)h
(John)g(Guttag,)f(An\255)2040 3162 y(thon)o(y)28 b(Joseph,)f(Hank)g(Le)
n(vy)h(\(our)e(shepherd\),)i(Erik)e(Nygren,)h(Max)h(Po\255)2040
3245 y(letto,)18 b(Deborah)h(W)-6 b(allach,)18 b(Da)o(vid)g(W)-6
b(etherall,)18 b(Emmett)g(W)m(itchel,)f(and)i(the)2040
3328 y(anon)o(ymous)24 b(referees)e(for)g(their)f(careful)h(reading)h
(of)f(earlier)f(v)o(ersions)h(of)2040 3411 y(this)d(paper)g(and)h
(their)f(v)n(aluable)h(feedback.)2040 3629 y Fr(Refer)n(ences)2073
3772 y Ff([1])38 b(T)-5 b(.)28 b(Anderson.)55 b(The)29
b(case)g(for)g(application\255speci\002c)35 b(operating)c(systems.)2188
3847 y(In)21 b Fc(Thir)n(d)f(W)-6 b(orkshop)22 b(on)f(W)-6
b(orkstation)23 b(Oper)o(ating)f(Systems)p Ff(,)f(pages)h(92\22694,)
2188 3922 y(1992.)2073 4030 y([2])38 b(J.)28 b(Barrera.)56
b(In)m(v)o(ocation)31 b(chaining:)h(manipulating)g(light\255weight)f
(objects)2188 4105 y(across)22 b(hea)o(vy\255weight)i(boundaries.)37
b(In)21 b Fc(Pr)m(oc.)g(of)h(4th)f(IEEE)f(W)-6 b(orkshop)22
b(on)2188 4179 y(W)-6 b(orkstation)19 b(Oper)o(ating)g(Systems)p
Ff(,)e(pages)h(191\226193,)g(October)h(1993.)2073 4287
y([3])38 b(B.N.)28 b(Bershad,)h(D.D.)f(Redell,)i(and)f(J.R.)e(Ellis.)55
b(F)o(ast)29 b(mutual)h(e)o(xclusion)2188 4362 y(for)f(uniprocessors.)
57 b(In)29 b Fc(Pr)m(oc.)f(of)h(the)h(Conf)o(.)f(on)g(Ar)n(c)o
(hitectur)o(al)i(Support)2188 4437 y(for)16 b(Pr)m(o)o(gr)o(amming)h
(Langua)o(g)o(es)h(and)e(Oper)o(ating)i(Systems)p Ff(,)f(pages)g
(223\226237,)2188 4511 y(October)i(1992.)2073 4619 y([4])38
b(B.N.)33 b(Bershad,)h(S.)f(Sa)o(v)n(age,)h(P)-7 b(.)32
b(P)o(ardyak,)j(E.G.)d(Sirer)m(,)i(M.)f(Fiuczynski,)2188
4694 y(D.)27 b(Beck)o(er)m(,)j(S.)e(Eggers,)f(and)i(C.)f(Chambers.)54
b(Extensibility)l(,)30 b(safety)g(and)2188 4769 y(performance)f(in)f
(the)f(SPIN)g(operating)i(system.)51 b(In)27 b Fc(Pr)m(oceedings)h(of)f
(the)2188 4843 y(F)m(ifteenth)h(A)n(CM)e(Symposium)h(on)e(Oper)o(ating)
j(Systems)e(Principles)p Ff(,)h(pages)2188 4918 y(267\226284,)18
b(December)g(1995.)2073 5026 y([5])38 b(E.)11 b(Bugnion,)i(S.)e(De)n
(vine,)i(and)g(M.)e(Rosenblum.)17 b(Disco:)c(running)g(commodity)2188
5101 y(operating)20 b(systems)e(on)g(scalable)j(multiprocessors.)28
b(In)18 b Fc(Pr)m(oceedings)h(of)f(the)2188 5176 y(Sixteenth)i(A)n(CM)d
(Symposium)h(on)f(Oper)o(ating)i(Systems)f(Principles)p
Ff(,)g(1997.)2073 5283 y([6])38 b(P)-7 b(.)27 b(Cao,)h(E.W)-6
b(.)26 b(Felten,)j(and)g(K.)e(Li.)52 b(Implementation)32
b(and)c(performance)2188 5358 y(of)h(application\255controll)q(ed)34
b(\002le)29 b(caching.)57 b(In)29 b Fc(Pr)m(oceedings)h(of)f(the)g(F)m
(ir)o(st)1903 5647 y Fq(13)p eop
%%Page: 14 14
14 13 bop -4 -69 a Fc(Symposium)19 b(on)f(Oper)o(ating)h(Systems)g
(Design)f(and)g(Implementation)p Ff(,)j(pages)-4 6 y(165\226178,)d(No)o
(v)o(ember)g(1994.)-118 114 y([7])37 b(A.)14 b(Chankhunthod,)i(P)-7
b(.B.)13 b(Danzig,)i(C.)f(Neerdaels,)i(M.F)-5 b(.)12
b(Schw)o(artz,)k(and)f(K.J.)-4 189 y(W)-5 b(orrell.)24
b(A)17 b(hierarchical)j(Internet)f(object)f(cache.)25
b(In)17 b Fc(Pr)m(oceedings)h(of)f(1996)-4 263 y(USENIX)g(T)-6
b(ec)o(hnical)19 b(Confer)n(ence)p Ff(,)g(pages)f(153\226163,)g
(January)g(1996.)-118 371 y([8])37 b(D.)13 b(Cheriton)j(and)e(K.)f
(Duda.)18 b(A)13 b(caching)j(model)e(of)g(operating)i(system)e(k)o
(ernel)-4 446 y(functionality)l(.)47 b(In)24 b Fc(Pr)m(oceedings)i(of)e
(the)h(F)m(ir)o(st)f(Symposium)i(on)e(Oper)o(ating)-4
521 y(Systems)14 b(Design)f(and)g(Implementation)p Ff(,)i(pages)f
(179\226193,)f(No)o(v)o(ember)g(1994.)-118 629 y([9])37
b(J.B.)13 b(Dennis)i(and)f(E.C.)f(V)-7 b(an)14 b(Horn.)19
b(Programming)14 b(semantics)i(for)e(multipro\255)-4
703 y(grammed)j(computations.)26 b Fc(Communications)19
b(of)e(the)g(A)n(CM)p Ff(,)f(9\(3\):143\226155,)-4 778
y(March)i(1966.)-152 886 y([10])38 b(D.R.)19 b(Engler)g(and)h(M.F)-5
b(.)18 b(Kaashoek.)31 b(DPF:)19 b(f)o(ast,)h(\003e)o(xible)h(message)f
(demul\255)-4 961 y(tiple)o(xing)29 b(using)d(dynamic)g(code)h
(generation.)49 b(In)25 b Fc(A)n(CM)h(Communication)-4
1036 y(Ar)n(c)o(hitectur)n(es,)21 b(Pr)m(otocols,)g(and)f(Applications)
j(\(SIGCOMM\))e(1996)p Ff(,)f(pages)-4 1110 y(53\22659,)e(August)f
(1996.)-152 1218 y([11])38 b(D.R.)10 b(Engler)m(,)g(M.F)-5
b(.)10 b(Kaashoek,)g(and)g(J.)g(O'T)-5 b(oole)10 b(Jr)l(.)15
b(Exok)o(ernel:)10 b(an)g(operating)-4 1293 y(system)18
b(architecture)k(for)c(application\255speci\002c)23 b(resource)d
(management.)28 b(In)-4 1368 y Fc(Pr)m(oceedings)22 b(of)e(the)h(F)m
(ifteenth)h(A)n(CM)e(Symposium)h(on)f(Oper)o(ating)i(Systems)-4
1442 y(Principles)p Ff(,)d(pages)e(251\226266,)h(December)h(1995.)-152
1550 y([12])38 b(B.)17 b(F)o(ord,)h(M.)f(Hibler)m(,)h(J.)f(Lepreau,)i
(P)-7 b(.)16 b(T)m(ullman,)i(G.)f(Back,)h(and)g(S.)f(Cla)o(wson.)-4
1625 y(Microk)o(ernels)23 b(meet)d(recursi)n(v)o(e)i(virtual)f
(machines.)32 b(In)19 b Fc(Pr)m(oceedings)i(of)f(the)-4
1700 y(Second)14 b(Symposium)f(on)e(Oper)o(ating)j(Systems)f(Design)f
(and)g(Implementation)p Ff(,)-4 1774 y(pages)18 b(137\226152,)g
(October)g(1996.)-152 1882 y([13])38 b(B.)26 b(F)o(ord,)f(K.)g(V)-7
b(an)25 b(Maren,)i(J.)d(Lepreau,)j(S.)e(Cla)o(wson,)h(B.)f(Robinson,)i
(and)-4 1957 y(Jef)n(f)i(T)m(urner)l(.)54 b(The)28 b(FLUX)f(OS)h
(toolkit:)j(Reusable)f(components)g(for)e(OS)-4 2032
y(implementation.)17 b(In)10 b Fc(Pr)m(oc.)g(of)g(Sixth)g(W)-6
b(orkshop)10 b(on)g(Hot)g(T)-6 b(opic)q(s)10 b(in)h(Oper)o(a)q(tin)q(g)
-4 2107 y(Systems)p Ff(,)18 b(pages)g(14\22619,)f(May)g(1997.)-152
2214 y([14])38 b(B.)13 b(F)o(ord)g(and)h(S.R.)e(Susarla.)18
b(CPU)13 b(inheritance)k(scheduling.)j(In)13 b Fc(Pr)m(oceedings)-4
2289 y(of)24 b(the)g(Second)h(Symposium)g(on)e(Oper)o(ating)i(Systems)g
(Design)f(and)f(Imple\255)-4 2364 y(mentation)p Ff(,)c(pages)f
(91\226106,)g(October)g(1996.)-152 2472 y([15])38 b(G.)17
b(Ganger)h(and)f(M.F)-5 b(.)16 b(Kaashoek.)25 b(Embedded)18
b(inodes)g(and)g(e)o(xplicit)i(group\255)-4 2547 y(ing:)h(Exploiting)h
(disk)d(bandwidth)j(for)e(small)g(\002les.)31 b(In)20
b Fc(Pr)m(oceedings)h(of)f(the)-4 2621 y(1997)e(USENIX)e(T)-6
b(ec)o(hnical)20 b(Confer)n(ence)p Ff(,)f(pages)e(1\22618,)g(1997.)-152
2729 y([16])38 b(G.)18 b(Ganger)h(and)g(Y)-9 b(.)18 b(P)o(att.)29
b(Metadata)21 b(update)g(performance)f(in)f(\002le)g(systems.)-4
2804 y(In)g Fc(Pr)m(oceedings)h(of)e(the)i(F)m(ir)o(st)e(Symposium)i
(on)e(Oper)o(ating)i(Systems)g(Design)-4 2879 y(and)e(Implementation)p
Ff(,)i(pages)e(49\22660,)f(No)o(v)o(ember)h(1994.)-152
2987 y([17])38 b(R.P)-7 b(.)18 b(Goldber)o(g.)30 b(Surv)o(e)o(y)19
b(of)g(virtual)i(machine)f(research.)30 b Fc(IEEE)18
b(Computer)p Ff(,)-4 3061 y(pages)g(34\22645,)f(June)h(1974.)-152
3169 y([18])38 b(D.)17 b(Golub,)h(R.)g(Dean,)g(A.)f(F)o(orin,)h(and)h
(R.)e(Rashid.)27 b(UNIX)18 b(as)g(an)g(application)-4
3244 y(program.)39 b(In)23 b Fc(USENIX)e(1990)i(Summer)g(Confer)n(ence)
p Ff(,)h(pages)f(87\22695,)g(June)-4 3319 y(1990.)-152
3427 y([19])38 b(P)-7 b(.)16 b(Brinch)i(Hansen.)24 b(The)16
b(nucleus)i(of)f(a)g(multiprogramming)i(system.)k Fc(Com\255)-4
3501 y(munications)d(of)d(the)h(A)n(CM)p Ff(,)e(13\(4\):238\226241,)j
(April)f(1970.)-152 3609 y([20])38 b(H.)23 b(Hartig,)i(M.)e(Hohmuth,)h
(J.)f(Liedtk)o(e,)j(and)e(S.)f(Sch)1294 3608 y(\250)1288
3609 y(onber)o(g.)44 b(The)24 b(perfor)o(\255)-4 3684
y(mance)j(of)f Fb(\026)p Ff(\255k)o(ernel\255based)j(systems.)48
b(In)25 b Fc(Pr)m(oceedings)j(of)e(the)g(Sixteenth)-4
3759 y(A)n(CM)17 b(Symposium)h(on)f(Oper)o(ating)i(Systems)f
(Principles)p Ff(,)g(1997.)-152 3867 y([21])38 b(J.H.)15
b(Hartman,)h(A.B.)f(Montz,)i(D.)e(Mosber)o(ger)m(,)i(S.W)-6
b(.)15 b(O'Malle)o(y)l(,)i(L.L.)d(Peter)o(\255)-4 3941
y(son,)g(and)g(T)-5 b(.A.)13 b(Proebsting.)20 b(Scout:)c(A)d
(communication\255oriented)20 b(operating)-4 4016 y(system.)34
b(T)-5 b(echnical)24 b(Report)e(TR)e(94\25520,)h(Uni)n(v)o(ersity)i(of)
e(Arizona,)h(T)m(ucson,)-4 4091 y(AZ,)16 b(June)h(1994.)-152
4199 y([22])38 b(K.)30 b(Harty)h(and)g(D.)e(Cheriton.)61
b(Application\255controlle)q(d)36 b(physical)c(mem\255)-4
4273 y(ory)c(using)g(e)o(xternal)h(page\255cache)i(management.)53
b(In)27 b Fc(F)m(ifth)h(International)-4 4348 y(Confer)n(ence)18
b(on)d(Ar)n(c)o(hitectur)n(e)i(Support)f(for)f(Pr)m(o)o(gr)o(amming)g
(Langua)o(g)o(es)i(and)-4 4423 y(Oper)o(ating)i(Systems)p
Ff(,)e(pages)h(187\226199,)g(October)h(1992.)-152 4531
y([23])38 b(D.)10 b(Hitz.)15 b(An)10 b(NFS)g(\002le)g(serv)o(er)g
(appliance)q(.)19 b(T)-5 b(echnical)10 b(Report)g(3001,)g(Ne)q(tw)o(o)q
(rk)-4 4605 y(Applicance)20 b(Corporation,)g(March)e(1995.)-152
4713 y([24])38 b(M.F)-5 b(.)22 b(Kaashoek,)i(D.R.)f(Engler)m(,)g(D.H.)f
(W)-5 b(allach,)25 b(and)e(G.)g(Ganger)l(.)41 b(Serv)o(er)-4
4788 y(operating)23 b(systems.)31 b(In)19 b Fc(SIGOPS)h(Eur)m(opean)g
(W)-6 b(orkshop)p Ff(,)20 b(pages)h(141\226148,)-4 4863
y(September)e(1996.)-152 4971 y([25])38 b(B.W)-6 b(.)18
b(Lampson.)30 b(On)19 b(reliable)j(and)e(e)o(xtendable)i(operating)g
(systems.)30 b Fc(State)-4 5045 y(of)18 b(the)f(Art)g(Report,)g
(Infotec)o(h)p Ff(,)i(1,)d(1971.)-152 5153 y([26])38
b(B.W)-6 b(.)26 b(Lampson)h(and)h(R.F)-5 b(.)26 b(Sproull.)53
b(An)27 b(open)h(operating)i(system)d(for)g(a)-4 5228
y(single\255user)19 b(machine.)25 b Fc(Pr)m(oceedings)18
b(of)f(the)g(Se)o(venth)i(A)n(CM)e(Symposium)g(on)-4
5303 y(Oper)o(ating)i(Systems)f(Principles)p Ff(,)g(pages)g(98\226105,)
f(December)i(1979.)2040 -69 y([27])38 b(C.H.)15 b(Lee,)g(M.C.)g(Chen,)h
(and)g(R.C.)f(Chang.)22 b(HiPEC:)16 b(high)g(performance)i(e)o(x\255)
2188 6 y(ternal)e(virtual)g(memory)f(caching.)21 b(In)14
b Fc(Pr)m(oceedings)i(of)f(the)g(F)m(ir)o(st)f(Symposium)2188
81 y(on)25 b(Oper)o(ating)i(Systems)g(Design)f(and)f(Implementation)p
Ff(,)j(pages)f(153\226164,)2188 156 y(1994.)2040 263
y([28])38 b(J.)29 b(Liedtk)o(e.)61 b(On)30 b(micro\255k)o(ernel)k
(construction.)62 b(In)30 b Fc(Pr)m(oceedings)i(of)e(the)2188
338 y(F)m(ifteenth)e(A)n(CM)e(Symposium)h(on)e(Oper)o(ating)j(Systems)e
(Principles)p Ff(,)h(pages)2188 413 y(237\226250,)18
b(December)g(1995.)2040 521 y([29])38 b(K.)14 b(Mack)o(enzie,)k(J.)c(K)
o(ubiato)n(wicz,)k(M.)c(Frank,)h(W)-6 b(.)14 b(Lee,)g(V)-9
b(.)15 b(Lee,)f(A.)g(Agarw)o(al,)2188 596 y(and)i(M.F)-5
b(.)14 b(Kaashoek.)22 b(UDM:)15 b(user)h(direct)h(messaging)f(for)g
(general\255purpose)2188 670 y(multiprocessing.)27 b(T)-5
b(echnical)20 b(Memo)d(MIT/LCS/TM\255556,)g(March)h(1996.)2040
778 y([30])38 b(C.)30 b(Maeda)h(and)f(B.N.)f(Bershad.)60
b(Protocol)32 b(service)f(decomposition)i(for)2188 853
y(high\255performance)18 b(netw)o(orking.)23 b(In)15
b Fc(Pr)m(oceedings)h(of)f(the)h(F)-7 b(ourteenth)16
b(A)n(CM)2188 928 y(Symposium)i(on)f(Oper)o(ating)i(Systems)f
(Principles)p Ff(,)g(pages)g(244\226255,)g(1993.)2040
1036 y([31])38 b(D.)22 b(Mazi)2414 1035 y(\036)2410 1036
y(eres)j(and)e(M.F)-5 b(.)21 b(Kaashoek.)40 b(Secure)24
b(applications)i(need)e(\003e)o(xibile)2188 1110 y(operating)11
b(systems.)17 b(In)11 b Fc(Pr)m(oc)g(of)g(6th)g(W)-6
b(orkshop)11 b(on)g(Hot)g(T)-6 b(opics)11 b(in)h(Oper)o(at)q(ing)2188
1185 y(Systems)p Ff(,)18 b(pages)f(56\22661,)h(May)f(1997.)2040
1293 y([32])38 b(NCSA,)26 b(Uni)n(v)o(ersity)j(of)d(Illinois,)i
(Urbana\255Champaign.)53 b(NCSA)26 b(HTTPd.)2188 1368
y(http://hoohoo.ncsa.uiuc.edu/)q(ind)q(e)o(x.ht)q(ml.)2040
1476 y([33])38 b(J.K.)13 b(Ousterhout.)21 b(Why)14 b(aren')o(t)i
(operating)g(systems)f(getting)h(f)o(aster)g(as)e(f)o(ast)h(as)2188
1550 y(hardw)o(are?)30 b(In)18 b Fc(Pr)m(oceedings)i(of)f(the)g(Summer)
f(1990)h(USENIX)e(Confer)n(ence)p Ff(,)2188 1625 y(pages)h(247\226256,)
g(June)f(1990.)2040 1733 y([34])38 b(V)-9 b(.)44 b(P)o(ai,)g(P)-7
b(.)44 b(Druschel,)h(and)g(W)-6 b(.)43 b(Zw)o(aenepoel.)99
b(I/O\255lite:)47 b(a)d(uni\002ed)2188 1808 y(I/O)37
b(b)o(uf)n(fering)h(and)f(caching)h(system.)76 b(T)-5
b(echnical)39 b(Report)f Fa(http://)2188 1882 y
(www.cs.rice.edu/\230vivek/IO\255lite.html)p Ff(,)11
b(Rice)g(Uni)n(v)o(ersity)l(,)2188 1957 y(1997.)2040
2065 y([35])38 b(R.H.)13 b(P)o(atterson,)i(G.A.)d(Gibson,)i(E.)e
(Ginting,)j(D.)d(Stodolsk)o(y)l(,)i(and)h(J.)d(Zelenka.)2188
2140 y(Informed)26 b(prefetching)j(and)d(caching.)48
b(In)26 b Fc(Pr)m(oceedings)h(of)f(the)g(F)m(ifteenth)2188
2214 y(A)n(CM)17 b(Symposium)h(on)f(Oper)o(ating)h(Systems)g
(Principles)p Ff(,)g(pages)g(79\22695,)f(De\255)2188
2289 y(cember)h(1995.)2040 2397 y([36])38 b(D.)16 b(Probert,)i(J.L.)d
(Bruno,)i(and)g(M.)f(Karzaorman.)25 b(SP)-6 b(A)m(CE:)17
b(a)g(ne)n(w)g(approach)2188 2472 y(to)g(operating)i(system)e
(abstraction.)26 b(In)17 b Fc(International)i(W)-6 b(orkshop)18
b(on)f(Object)2188 2547 y(Orientation)j(in)d(Oper)o(ating)i(Systems)p
Ff(,)e(pages)h(133\226137,)g(October)g(1991.)2040 2654
y([37])38 b(D.D.)18 b(Redell,)k(Y)-9 b(.K.)18 b(Dalal,)j(T)-5
b(.R.)18 b(Horsle)o(y)l(,)i(H.C.)f(Lauer)m(,)h(W)-6 b(.C.)18
b(L)l(ynch,)i(P)-7 b(.R.)2188 2729 y(McJones,)21 b(H.G.)e(Murray)l(,)i
(and)g(S.C.)e(Purcell.)35 b(Pilot:)22 b(an)f(operating)i(system)2188
2804 y(for)d(a)g(personal)h(computer)l(.)33 b Fc(Communications)22
b(of)e(the)h(A)n(CM)p Ff(,)e(23\(2\):81\22692,)2188 2879
y(February)f(1980.)2040 2987 y([38])38 b(R.)13 b(Sandber)o(g,)h(D.)e
(Goldber)o(g,)i(S.)e(Kleiman,)i(D.)e(W)-5 b(alsh,)13
b(and)h(B.)e(L)l(yon.)17 b(Design)2188 3061 y(and)11
b(implementation)g(of)g(the)h(Sun)f(ne)q(twork)g(\002l)q(esyste)q(m.)20
b(In)11 b Fc(Pr)m(oc.)g(of)g(the)g(1985)2188 3136 y(Summer)17
b(USENIX)g(confer)n(ence)p Ff(,)i(pages)f(119\226130,)f(1985.)2040
3244 y([39])38 b(M.)20 b(Seltzer)m(,)j(Y)-9 b(.)21 b(Endo,)f(C.)h
(Small,)g(and)g(K.)f(Smith.)35 b(Dealing)23 b(with)e(disaster:)2188
3319 y(Survi)n(ving)14 b(misbeha)o(v)o(ed)g(k)o(ernel)g(e)o(xtensions.)
k(In)12 b Fc(Pr)m(oceedings)i(of)f(the)g(Second)2188
3393 y(Symposium)19 b(on)f(Oper)o(ating)h(Systems)f(Design)h(and)f
(Implementation)p Ff(,)i(pages)2188 3468 y(213\226228,)e(October)g
(1996.)2040 3576 y([40])38 b(C.A.)18 b(Thekkath,)h(H.M.)e(Le)n(vy)l(,)h
(and)h(E.D.)e(Lazo)n(wska.)29 b(Separating)21 b(data)f(and)2188
3651 y(control)15 b(transfer)f(in)f(distrib)o(uted)i(operating)g
(systems.)h(In)d Fc(Sixth)h(International)2188 3725 y(Confer)n(ence)j
(on)f(Ar)n(c)o(hitectur)n(e)g(Support)g(for)f(Pr)m(o)o(gr)o(amming)h
(Langua)o(g)o(es)h(and)2188 3800 y(Oper)o(ating)i(Systems)p
Ff(,)e(pages)h(2\22611,)f(San)g(Francisco,)i(CA,)d(October)j(1994.)2040
3908 y([41])38 b(T)-5 b(.)27 b(v)o(on)h(Eick)o(en,)h(A.)e(Basu,)h(V)-9
b(.)27 b(Buch,)i(and)f(W)-6 b(.)27 b(V)-9 b(ogels.)54
b(U\255Net:)29 b(a)f(user)o(\255)2188 3983 y(le)n(v)o(el)j(netw)o(ork)g
(interf)o(ace)i(for)c(parallel)j(and)e(distrib)o(uted)h(computing.)58
b(In)2188 4058 y Fc(Pr)m(oceedings)22 b(of)e(the)h(F)m(ifteenth)h(A)n
(CM)e(Symposium)h(on)f(Oper)o(ating)h(Systems)2188 4132
y(Principles)p Ff(,)d(pages)g(40\22653,)f(1995.)2040
4240 y([42])38 b(R.)16 b(W)-5 b(ahbe,)16 b(S.)f(Lucco,)h(T)-5
b(.)15 b(Anderson,)i(and)g(S.)e(Graham.)23 b(Ef)n(\002cient)17
b(softw)o(are\255)2188 4315 y(based)k(f)o(ault)g(isolation.)33
b(In)19 b Fc(Pr)m(oceedings)j(of)d(the)i(F)-7 b(ourteenth)21
b(A)n(CM)e(Sympo\255)2188 4390 y(sium)13 b(on)g(Oper)o(ating)i(Systems)
f(Principles)p Ff(,)h(pages)f(203\226216,)f(Ashe)n(ville,)j(NC,)2188
4464 y(December)j(1993.)2040 4572 y([43])38 b(C.A.)32
b(W)-5 b(aldspur)o(ger)35 b(and)f(W)-6 b(.E.)31 b(W)-5
b(eihl.)67 b(Lottery)35 b(scheduling:)h(Fle)o(xible)2188
4647 y(proportional\255share)22 b(resource)d(management.)28
b(In)18 b Fc(Pr)m(oceedings)i(of)e(the)g(F)m(ir)o(st)2188
4722 y(Symposium)h(on)f(Oper)o(ating)h(Systems)f(Design)h(and)f
(Implementation)p Ff(,)i(pages)2188 4796 y(1\22611,)d(No)o(v)o(ember)h
(1994.)2040 4904 y([44])38 b(D.A.)17 b(W)-5 b(allach,)20
b(D.R.)e(Engler)m(,)h(and)g(M.F)-5 b(.)17 b(Kaashoek.)30
b(ASHs:)18 b(Application\255)2188 4979 y(speci\002c)j(handlers)g(for)e
(high\255performance)k(messaging.)31 b(In)20 b Fc(A)n(CM)f(Commu\255)
2188 5054 y(nication)g(Ar)n(c)o(hitectur)n(es,)e(Pr)m(otocols,)g(and)f
(Applications)j(\(SIGCOMM)e('96\))p Ff(,)2188 5129 y(pages)h(40\22652,)
f(August)h(1996.)1903 5647 y Fq(14)p eop
%%Trailer
end
userdict /end-hook known{end-hook}if
%%EOF
